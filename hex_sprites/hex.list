ca65 V2.19 - Git 8e6c0c1
Main file   : hex.s
Current file: hex.s

000000r 1               ; 	080D
000000r 1  4C rr rr     jmp start ; 	3 bytes
000003r 1               ;	0810 	- 240 bytes available for stuff that doesn't need alignment
000003r 1  DE AD BE EF  .repeat 28
000007r 1  DE AD BE EF  
00000Br 1  DE AD BE EF  
000073r 1               	.byte $DE,$AD,$BE,$EF
000073r 1               .endrepeat
000073r 1               SCRATCH128:
000073r 1  DE AD BE EF  .repeat 32
000077r 1  DE AD BE EF  
00007Br 1  DE AD BE EF  
0000F3r 1               	.byte $DE,$AD,$BE,$EF
0000F3r 1               .endrepeat
0000F3r 1               
0000F3r 1               ACROSS_ROW_X_L: ; 0900  16 wide , 45* tilt ... this is added to go up row, sub for down row
0000F3r 1               ;     0    1    2    3    4    5    6    7    8    9    A    B    C    D    E    F
0000F3r 1  00 FE FB F4  .byte $0, $FE, $FB, $F4, $EC, $E1, $D3, $C3, $B1, $9C, $85, $6B, $4F, $31, $10, $ED, $C8, $A0, $76, $4A, $1C, $EB, $B9, $84, $4D, $14, $D9, $9D, $5E, $1D, $DA, $96, $50, $8, $BE, $73, $26, $D7, $87, $36, $E3, $8F, $39, $E2, $8A, $31, $D7, $7B, $1F, $C2, $63, $4, $A5, $44, $E3, $81, $1F, $BC, $59, $F5, $91, $2D, $C8, $64, $0, $9B, $37, $D2, $6E, $A, $A6, $43, $E0, $7E, $1C, $BB, $5A, $FB, $9C, $3D, $E0, $84, $28, $CE, $75, $1D, $C6, $70, $1C, $C9, $78, $28, $D9, $8C, $41, $F7, $AF, $69, $25, $E2, $A1, $62, $26, $EB, $B2, $7B, $46, $14, $E3, $B5, $89, $5F, $37, $12, $EF, $CE, $B0, $94, $7A, $63, $4E, $3C, $2C, $1E, $13, $B, $4, $1, $0, $1, $4, $B, $13, $1E, $2C, $3C, $4E, $63, $7A, $94, $B0, $CE, $EF, $12, $37, $5F, $89, $B5, $E3, $14, $46, $7B, $B2, $EB, $26, $62, $A1, $E2, $25, $69, $AF, $F7, $41, $8C, $D9, $28, $78, $C9, $1C, $70, $C6, $1D, $75, $CE, $28, $84, $E0, $3D, $9C, $FB, $5A, $BB, $1C, $7E, $E0, $43, $A6, $A, $6E, $D2, $37, $9B, $0, $64, $C8, $2D, $91, $F5, $59, $BC, $1F, $81, $E3, $44, $A5, $4, $63, $C2, $1F, $7B, $D7, $31, $8A, $E2, $39, $8F, $E3, $36, $87, $D7, $26, $73, $BE, $8, $50, $96, $DA, $1D, $5E, $9D, $D9, $14, $4D, $84, $B9, $EB, $1C, $4A, $76, $A0, $C8, $ED, $10, $31, $4F, $6B, $85, $9C, $B1, $C3, $D3, $E1, $EC, $F4, $FB, $FE
0000F7r 1  EC E1 D3 C3  
0000FBr 1  B1 9C 85 6B  
0001F3r 1               
0001F3r 1               ACROSS_ROW_X_H: ; 0A00
0001F3r 1               ;     0    1    2    3    4    5    6    7    8    9    A    B    C    D    E    F
0001F3r 1  10 0F 0F 0F  .byte $10, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $E, $E, $E, $E, $E, $E, $D, $D, $D, $D, $D, $C, $C, $C, $C, $B, $B, $B, $B, $A, $A, $A, $9, $9, $9, $8, $8, $8, $7, $7, $7, $6, $6, $6, $5, $5, $5, $4, $4, $3, $3, $3, $2, $2, $1, $1, $1, $0, $0, $0, $FF, $FF, $FE, $FE, $FE, $FD, $FD, $FC, $FC, $FC, $FB, $FB, $FA, $FA, $FA, $F9, $F9, $F9, $F8, $F8, $F8, $F7, $F7, $F7, $F6, $F6, $F6, $F5, $F5, $F5, $F4, $F4, $F4, $F4, $F3, $F3, $F3, $F3, $F2, $F2, $F2, $F2, $F2, $F1, $F1, $F1, $F1, $F1, $F1, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F1, $F1, $F1, $F1, $F1, $F1, $F2, $F2, $F2, $F2, $F2, $F3, $F3, $F3, $F3, $F4, $F4, $F4, $F4, $F5, $F5, $F5, $F6, $F6, $F6, $F7, $F7, $F7, $F8, $F8, $F8, $F9, $F9, $F9, $FA, $FA, $FA, $FB, $FB, $FC, $FC, $FC, $FD, $FD, $FE, $FE, $FE, $FF, $FF, $00, $0, $0, $1, $1, $1, $2, $2, $3, $3, $3, $4, $4, $5, $5, $5, $6, $6, $6, $7, $7, $7, $8, $8, $8, $9, $9, $9, $A, $A, $A, $B, $B, $B, $B, $C, $C, $C, $C, $D, $D, $D, $D, $D, $E, $E, $E, $E, $E, $E, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F
0001F7r 1  0F 0F 0F 0F  
0001FBr 1  0F 0F 0F 0F  
0002F3r 1               
0002F3r 1               ACROSS_ROW_Y_L: ; 0B00
0002F3r 1               ;     0    1    2    3    4    5    6    7    8    9    A    B    C    D    E    F
0002F3r 1  00 B8 71 2A  .byte $0,$B8,$71,$2A,$E4,$9D,$57,$10,$CA,$85,$40,$FB,$B7,$73,$30,$ED,$AB,$6A,$29,$E9,$AA,$6C,$2E,$F2,$B6,$7C,$42,$A,$D2,$9C,$66,$32,$0,$CE,$9D,$6E,$41,$14,$E9,$C0,$97,$71,$4B,$27,$5,$E4,$C5,$A8,$8C,$71,$58,$41,$2C,$18,$6,$F6,$E7,$DA,$CF,$C5,$BD,$B7,$B3,$B0,$AF,$B0,$B3,$B7,$BD,$C5,$CF,$DA,$E7,$F6,$6,$18,$2C,$41,$58,$71,$8C,$A8,$C5,$E4,$5,$27,$4B,$71,$97,$C0,$E9,$14,$41,$6E,$9D,$CE,$0,$32,$66,$9C,$D2,$A,$42,$7C,$B6,$F2,$2E,$6C,$AA,$E9,$29,$6A,$AB,$ED,$30,$73,$B7,$FB,$40,$85,$CA,$10,$57,$9D,$E4,$2A,$71,$B8,$0,$47,$8E,$D5,$1B,$62,$A8,$EF,$35,$7A,$BF,$4,$48,$8C,$CF,$12,$54,$95,$D6,$16,$55,$93,$D1,$D,$49,$83,$BD,$F5,$2D,$63,$99,$CD,$0,$31,$62,$91,$BE,$EB,$16,$3F,$68,$8E,$B4,$D8,$FA,$1B,$3A,$57,$73,$8E,$A7,$BE,$D3,$E7,$F9,$9,$18,$25,$30,$3A,$42,$48,$4C,$4F,$50,$4F,$4C,$48,$42,$3A,$30,$25,$18,$9,$F9,$E7,$D3,$BE,$A7,$8E,$73,$57,$3A,$1B,$FA,$D8,$B4,$8E,$68,$3F,$16,$EB,$BE,$91,$62,$31,$0,$CD,$99,$63,$2D,$F5,$BD,$83,$49,$D,$D1,$93,$55,$16,$D6,$95,$54,$12,$CF,$8C,$48,$4,$BF,$7A,$35,$EF,$A8,$62,$1B,$D5,$8E,$47
0002F7r 1  E4 9D 57 10  
0002FBr 1  CA 85 40 FB  
0003F3r 1               
0003F3r 1               ACROSS_ROW_Y_H: ; 0C00
0003F3r 1               ;     0    1    2    3    4    5    6    7    8    9    A    B    C    D    E    F
0003F3r 1  00 FF FF FF  .byte $0,$FF,$FF,$FF,$FE,$FE,$FE,$FE,$FD,$FD,$FD,$FC,$FC,$FC,$FC,$FB,$FB,$FB,$FB,$FA,$FA,$FA,$FA,$F9,$F9,$F9,$F9,$F9,$F8,$F8,$F8,$F8,$F8,$F7,$F7,$F7,$F7,$F7,$F6,$F6,$F6,$F6,$F6,$F6,$F6,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F6,$F6,$F6,$F6,$F6,$F6,$F6,$F7,$F7,$F7,$F7,$F7,$F8,$F8,$F8,$F8,$F8,$F9,$F9,$F9,$F9,$F9,$FA,$FA,$FA,$FA,$FB,$FB,$FB,$FB,$FC,$FC,$FC,$FC,$FD,$FD,$FD,$FE,$FE,$FE,$FE,$FF,$FF,$FF,$00,$0,$0,$0,$1,$1,$1,$1,$2,$2,$2,$3,$3,$3,$3,$4,$4,$4,$4,$5,$5,$5,$5,$6,$6,$6,$6,$6,$7,$7,$7,$7,$8,$8,$8,$8,$8,$8,$9,$9,$9,$9,$9,$9,$9,$A,$A,$A,$A,$A,$A,$A,$A,$A,$A,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$A,$A,$A,$A,$A,$A,$A,$A,$A,$A,$9,$9,$9,$9,$9,$9,$9,$8,$8,$8,$8,$8,$8,$7,$7,$7,$7,$6,$6,$6,$6,$6,$5,$5,$5,$5,$4,$4,$4,$4,$3,$3,$3,$3,$2,$2,$2,$1,$1,$1,$1,$0,$0,$0
0003F7r 1  FE FE FE FE  
0003FBr 1  FD FD FD FC  
0004F3r 1               
0004F3r 1               NEXT_ROW_X_L: ; 0D00 next row LEFT/up when added
0004F3r 1  00 A9 54 00  .byte $0, $A9, $54, $0, $AE, $5D, $D, $BF, $73, $28, $DF, $98, $52, $E, $CC, $8C, $4E, $12, $D7, $9F, $69, $35, $3, $D3, $A6, $7B, $51, $2B, $6, $E4, $C4, $A6, $8B, $72, $5C, $48, $36, $27, $1A, $10, $8, $3, $0, $0, $2, $6, $D, $17, $23, $31, $42, $55, $6A, $83, $9D, $BA, $D9, $FA, $1E, $44, $6D, $97, $C4, $F3, $24, $58, $8D, $C5, $FE, $3A, $77, $B7, $F8, $3B, $80, $C7, $10, $5A, $A6, $F3, $42, $93, $E4, $38, $8D, $E3, $3A, $92, $EC, $47, $A2, $FF, $5D, $BB, $1B, $7B, $DB, $3D, $9F, $1, $64, $C8, $2B, $8F, $F4, $58, $BC, $21, $86, $EA, $4E, $B2, $16, $7A, $DD, $3F, $A2, $3, $64, $C5, $24, $83, $E1, $3E, $9A, $F5, $4F, $A8, $0, $56, $AB, $FF, $51, $A2, $F2, $40, $8C, $D7, $20, $67, $AD, $F1, $33, $73, $B1, $ED, $28, $60, $96, $CA, $FC, $2C, $59, $84, $AE, $D4, $F9, $1B, $3B, $59, $74, $8D, $A3, $B7, $C9, $D8, $E5, $EF, $F7, $FC, $FF, $FF, $FD, $F9, $F2, $E8, $DC, $CE, $BD, $AA, $95, $7C, $62, $45, $26, $5, $E1, $BB, $92, $68, $3B, $C, $DB, $A7, $72, $3A, $1, $C5, $88, $48, $7, $C4, $7F, $38, $EF, $A5, $59, $C, $BD, $6C, $1B, $C7, $72, $1C, $C5, $6D, $13, $B8, $5D, $0, $A2, $44, $E4, $84, $24, $C2, $60, $FE, $9B, $37, $D4, $70, $B, $A7, $43, $DE, $79, $15, $B1, $4D, $E9, $85, $22, $C0, $5D, $FC, $9B, $3A, $DB, $7C, $1E, $C1, $65, $A, $B0, $57
0004F7r 1  AE 5D 0D BF  
0004FBr 1  73 28 DF 98  
0005F3r 1               
0005F3r 1               NEXT_ROW_X_H: ; 0E00
0005F3r 1  F8 F7 F7 F7  .byte $F8, $F7, $F7, $F7, $F6, $F6, $F6, $F5, $F5, $F5, $F4, $F4, $F4, $F4, $F3, $F3, $F3, $F3, $F2, $F2, $F2, $F2, $F2, $F1, $F1, $F1, $F1, $F1, $F1, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F0, $F1, $F1, $F1, $F1, $F1, $F1, $F2, $F2, $F2, $F2, $F2, $F3, $F3, $F3, $F3, $F4, $F4, $F4, $F5, $F5, $F5, $F5, $F6, $F6, $F6, $F7, $F7, $F7, $F8, $F8, $F8, $F9, $F9, $F9, $FA, $FA, $FB, $FB, $FB, $FC, $FC, $FD, $FD, $FD, $FE, $FE, $FE, $FF, $FF, $0, $0, $0, $1, $1, $2, $2, $2, $3, $3, $4, $4, $4, $5, $5, $5, $6, $6, $6, $7, $7, $8, $8, $8, $8, $9, $9, $9, $A, $A, $A, $B, $B, $B, $B, $C, $C, $C, $C, $D, $D, $D, $D, $D, $E, $E, $E, $E, $E, $E, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $F, $E, $E, $E, $E, $E, $E, $D, $D, $D, $D, $D, $C, $C, $C, $C, $B, $B, $B, $A, $A, $A, $A, $9, $9, $9, $8, $8, $8, $7, $7, $7, $6, $6, $6, $5, $5, $4, $4, $4, $3, $3, $2, $2, $2, $1, $1, $1, $0, $0, $FF, $FF, $FF, $FE, $FE, $FD, $FD, $FD, $FC, $FC, $FB, $FB, $FB, $FA, $FA, $FA, $F9, $F9, $F9, $F8, $F8
0005F7r 1  F6 F6 F6 F5  
0005FBr 1  F5 F5 F4 F4  
0006F3r 1               
0006F3r 1               NEXT_ROW_Y_L: ; 0F00
0006F3r 1  33 58 7D A5  .byte $33,$58,$7D,$A5,$CD,$F7,$23,$50,$7E,$AD,$DE,$10,$44,$78,$AE,$E4,$1C,$55,$8F,$CA,$6,$43,$81,$BF,$FE,$3F,$7F,$C1,$3,$46,$8A,$CD,$12,$57,$9C,$E2,$28,$6E,$B4,$FB,$42,$89,$D0,$17,$5E,$A5,$EC,$33,$7A,$C0,$6,$4C,$91,$D6,$1B,$5F,$A2,$E6,$28,$6A,$AB,$EB,$2B,$6A,$A8,$E5,$21,$5C,$97,$D0,$8,$3F,$75,$AA,$DE,$10,$41,$71,$A0,$CD,$F9,$24,$4D,$75,$9B,$C0,$E3,$5,$25,$44,$61,$7C,$96,$AE,$C5,$DA,$ED,$FF,$F,$1D,$29,$34,$3D,$44,$4A,$4D,$4F,$50,$4E,$4B,$46,$3F,$37,$2D,$21,$13,$4,$F3,$E0,$CC,$B6,$9E,$85,$6A,$4E,$30,$10,$EF,$CC,$A7,$82,$5A,$32,$8,$DC,$AF,$81,$52,$21,$EF,$BB,$87,$51,$1B,$E3,$AA,$70,$35,$F9,$BC,$7E,$40,$1,$C0,$80,$3E,$FC,$B9,$75,$32,$ED,$A8,$63,$1D,$D7,$91,$4B,$4,$BD,$76,$2F,$E8,$A1,$5A,$13,$CC,$85,$3F,$F9,$B3,$6E,$29,$E4,$A0,$5D,$19,$D7,$95,$54,$14,$D4,$95,$57,$1A,$DE,$A3,$68,$2F,$F7,$C0,$8A,$55,$21,$EF,$BE,$8E,$5F,$32,$6,$DB,$B2,$8A,$64,$3F,$1C,$FA,$DA,$BB,$9E,$83,$69,$51,$3A,$25,$12,$0,$F0,$E2,$D6,$CB,$C2,$BB,$B5,$B2,$B0,$AF,$B1,$B4,$B9,$C0,$C8,$D2,$DE,$EC,$FB,$C,$1F,$33,$49,$61,$7A,$95,$B1,$CF,$EF,$10
0006F7r 1  CD F7 23 50  
0006FBr 1  7E AD DE 10  
0007F3r 1               
0007F3r 1               NEXT_ROW_Y_H: ; 1000
0007F3r 1  F6 F6 F6 F6  .byte $F6,$F6,$F6,$F6,$F6,$F6,$F7,$F7,$F7,$F7,$F7,$F8,$F8,$F8,$F8,$F8,$F9,$F9,$F9,$F9,$FA,$FA,$FA,$FA,$FA,$FB,$FB,$FB,$FC,$FC,$FC,$FC,$FD,$FD,$FD,$FD,$FE,$FE,$FE,$FE,$FF,$FF,$FF,$0,$0,$0,$0,$1,$1,$1,$2,$2,$2,$2,$3,$3,$3,$3,$4,$4,$4,$4,$5,$5,$5,$5,$6,$6,$6,$6,$7,$7,$7,$7,$7,$8,$8,$8,$8,$8,$8,$9,$9,$9,$9,$9,$9,$A,$A,$A,$A,$A,$A,$A,$A,$A,$A,$A,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$B,$A,$A,$A,$A,$A,$A,$A,$A,$A,$A,$9,$9,$9,$9,$9,$9,$9,$8,$8,$8,$8,$8,$7,$7,$7,$7,$7,$6,$6,$6,$6,$5,$5,$5,$5,$5,$4,$4,$4,$3,$3,$3,$3,$2,$2,$2,$2,$1,$1,$1,$1,$0,$0,$0,$FF,$FF,$FF,$FF,$FE,$FE,$FE,$FD,$FD,$FD,$FD,$FC,$FC,$FC,$FC,$FB,$FB,$FB,$FB,$FA,$FA,$FA,$FA,$F9,$F9,$F9,$F9,$F8,$F8,$F8,$F8,$F8,$F7,$F7,$F7,$F7,$F7,$F7,$F6,$F6,$F6,$F6,$F6,$F6,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F4,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F5,$F6
0007F7r 1  F6 F6 F7 F7  
0007FBr 1  F7 F7 F7 F8  
0008F3r 1               
0008F3r 1               TUB_WORLD: ; 32*64 = 2K ... is 1100 to 1900-1
0008F3r 1               .include "tub_world_hieghts_01.inc"
0008F3r 2               ; 0 to 128 will be water level. >128 = distance along row to water (neg) , 128 = no water this row.
0008F3r 2               ; rows are stored within 64 byte rows
0008F3r 2               ; 	  0   1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63
0008F3r 2  FF FF FF FF  .byte $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 30
0008F7r 2  FF FF FF FF  
0008FBr 2  FF FF FF FF  
000933r 2  FF FF FF FF  .byte   $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$FF,$FF,$FF,$FF,$FF,$FF ; 29
000937r 2  FF FF FF FF  
00093Br 2  FF FF FF FF  
000973r 2  FF FF FF FF  .byte     $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$FF,$FF,$FF,$FF,$FF ; 28
000977r 2  FF FF FF FF  
00097Br 2  FF FF FF FF  
0009B3r 2  FF FF FF FF  .byte       $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$FF,$FF,$FF,$FF ; 27
0009B7r 2  FF FF FF FF  
0009BBr 2  FF FF FF FF  
0009F3r 2  FF FF FF FF  .byte         $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$FF,$FF,$FF ; 26
0009F7r 2  FF FF FF FF  
0009FBr 2  FF FF FF FF  
000A33r 2  FF FF FF FF  .byte           $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF ; 25
000A37r 2  FF FF FF FF  
000A3Br 2  FF FF FF FF  
000A73r 2  FF FF FF FF  .byte             $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF ; 24
000A77r 2  FF FF FF FF  
000A7Br 2  FF FF FF FF  
000AB3r 2  FF FF FF FF  .byte               $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF ; 23
000AB7r 2  FF FF FF FF  
000ABBr 2  FF FF FF 80  
000AF3r 2  FF FF FF FF  .byte                 $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF ; 22
000AF7r 2  FF FF FF FF  
000AFBr 2  FF FF 80 00  
000B33r 2  FF FF FF FF  .byte                   $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF; 21
000B37r 2  FF FF FF FF  
000B3Br 2  FF 80 00 00  
000B73r 2  FF FF FF FF  .byte                     $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF ; 20
000B77r 2  FF FF FF FF  
000B7Br 2  FF 80 00 00  
000BB3r 2  FF FF FF FF  .byte                       $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF ; 19
000BB7r 2  FF FF FF FF  
000BBBr 2  80 00 00 00  
000BF3r 2  FF FF FF FF  .byte                         $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF ; 18
000BF7r 2  FF FF FF FF  
000BFBr 2  80 00 00 00  
000C33r 2  FF FF FF FF  .byte                           $FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF ; 17
000C37r 2  FF FF FF 80  
000C3Br 2  00 00 00 00  
000C73r 2  FF FF FF FF  .byte                             $FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF ; 16
000C77r 2  FF FF FF 80  
000C7Br 2  00 00 00 00  
000CB3r 2  FF FF FF FF  .byte                               $FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF ; 15
000CB7r 2  FF FF 80 00  
000CBBr 2  00 00 00 00  
000CF3r 2  FF FF FF FF  .byte                                 $FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF ; 14
000CF7r 2  FF FF 80 00  
000CFBr 2  00 00 00 00  
000D33r 2  FF FF FF FF  .byte                                   $FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 13
000D37r 2  FF 80 00 00  
000D3Br 2  00 00 00 00  
000D73r 2  FF FF FF FF  .byte                                     $FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 12
000D77r 2  FF 80 00 00  
000D7Br 2  00 00 00 00  
000DB3r 2  FF FF FF FF  .byte                                       $FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 11
000DB7r 2  80 00 00 00  
000DBBr 2  00 00 00 00  
000DF3r 2  FF FF FF FF  .byte                                         $FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 10
000DF7r 2  80 00 00 00  
000DFBr 2  00 00 00 00  
000E33r 2  FF FF FF 80  .byte                                           $FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 9
000E37r 2  00 00 00 00  
000E3Br 2  00 00 00 00  
000E73r 2  FF FF FF 80  .byte                                             $FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 8
000E77r 2  00 00 00 00  
000E7Br 2  00 00 00 00  
000EB3r 2  FF FF FF 80  .byte                                               $FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 7
000EB7r 2  00 00 00 00  
000EBBr 2  00 00 00 00  
000EF3r 2  FF FF FF 80  .byte                                                 $FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 6
000EF7r 2  00 00 00 00  
000EFBr 2  00 00 00 00  
000F33r 2  FF FF FF 80  .byte                                                   $FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF  ; 5
000F37r 2  00 00 00 00  
000F3Br 2  00 00 00 00  
000F73r 2  FF FF FF 80  .byte                                                     $FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF  ; 4
000F77r 2  00 00 00 00  
000F7Br 2  00 00 00 00  
000FB3r 2  FF FF FF 80  .byte                                                       $FF,$FF,$FF,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF  ; 3
000FB7r 2  80 00 00 00  
000FBBr 2  00 00 00 00  
000FF3r 2  FF FF FF FF  .byte                                                         $FF,$FF,$FF,$FF,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF  ; 2
000FF7r 2  80 80 00 00  
000FFBr 2  00 00 00 00  
001033r 2  FF FF FF FF  .byte                                                           $FF,$FF,$FF,$FF,$FF,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 01
001037r 2  FF 80 80 00  
00103Br 2  00 00 00 00  
001073r 2  FF FF FF FF  .byte                                                             $FF,$FF,$FF,$FF,$FF,$FF,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF  ; 00 tub wall north
001077r 2  FF FF 80 80  
00107Br 2  80 80 80 80  
0010B3r 2  FF FF FF FF  .res 64,$FF
0010B7r 2  FF FF FF FF  
0010BBr 2  FF FF FF FF  
0010F3r 2               
0010F3r 2               
0010F3r 2               
0010F3r 1               
0010F3r 1               WATER_CALC_SCRATCH:
0010F3r 1               .include "tub_world_hieghts_01.inc"
0010F3r 2               ; 0 to 128 will be water level. >128 = distance along row to water (neg) , 128 = no water this row.
0010F3r 2               ; rows are stored within 64 byte rows
0010F3r 2               ; 	  0   1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63
0010F3r 2  FF FF FF FF  .byte $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 30
0010F7r 2  FF FF FF FF  
0010FBr 2  FF FF FF FF  
001133r 2  FF FF FF FF  .byte   $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$FF,$FF,$FF,$FF,$FF,$FF ; 29
001137r 2  FF FF FF FF  
00113Br 2  FF FF FF FF  
001173r 2  FF FF FF FF  .byte     $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$FF,$FF,$FF,$FF,$FF ; 28
001177r 2  FF FF FF FF  
00117Br 2  FF FF FF FF  
0011B3r 2  FF FF FF FF  .byte       $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$FF,$FF,$FF,$FF ; 27
0011B7r 2  FF FF FF FF  
0011BBr 2  FF FF FF FF  
0011F3r 2  FF FF FF FF  .byte         $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$FF,$FF,$FF ; 26
0011F7r 2  FF FF FF FF  
0011FBr 2  FF FF FF FF  
001233r 2  FF FF FF FF  .byte           $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF ; 25
001237r 2  FF FF FF FF  
00123Br 2  FF FF FF FF  
001273r 2  FF FF FF FF  .byte             $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF ; 24
001277r 2  FF FF FF FF  
00127Br 2  FF FF FF FF  
0012B3r 2  FF FF FF FF  .byte               $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF ; 23
0012B7r 2  FF FF FF FF  
0012BBr 2  FF FF FF 80  
0012F3r 2  FF FF FF FF  .byte                 $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF ; 22
0012F7r 2  FF FF FF FF  
0012FBr 2  FF FF 80 00  
001333r 2  FF FF FF FF  .byte                   $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF; 21
001337r 2  FF FF FF FF  
00133Br 2  FF 80 00 00  
001373r 2  FF FF FF FF  .byte                     $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF ; 20
001377r 2  FF FF FF FF  
00137Br 2  FF 80 00 00  
0013B3r 2  FF FF FF FF  .byte                       $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF ; 19
0013B7r 2  FF FF FF FF  
0013BBr 2  80 00 00 00  
0013F3r 2  FF FF FF FF  .byte                         $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF ; 18
0013F7r 2  FF FF FF FF  
0013FBr 2  80 00 00 00  
001433r 2  FF FF FF FF  .byte                           $FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF ; 17
001437r 2  FF FF FF 80  
00143Br 2  00 00 00 00  
001473r 2  FF FF FF FF  .byte                             $FF,$FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF ; 16
001477r 2  FF FF FF 80  
00147Br 2  00 00 00 00  
0014B3r 2  FF FF FF FF  .byte                               $FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF ; 15
0014B7r 2  FF FF 80 00  
0014BBr 2  00 00 00 00  
0014F3r 2  FF FF FF FF  .byte                                 $FF,$FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF ; 14
0014F7r 2  FF FF 80 00  
0014FBr 2  00 00 00 00  
001533r 2  FF FF FF FF  .byte                                   $FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 13
001537r 2  FF 80 00 00  
00153Br 2  00 00 00 00  
001573r 2  FF FF FF FF  .byte                                     $FF,$FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 12
001577r 2  FF 80 00 00  
00157Br 2  00 00 00 00  
0015B3r 2  FF FF FF FF  .byte                                       $FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 11
0015B7r 2  80 00 00 00  
0015BBr 2  00 00 00 00  
0015F3r 2  FF FF FF FF  .byte                                         $FF,$FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 10
0015F7r 2  80 00 00 00  
0015FBr 2  00 00 00 00  
001633r 2  FF FF FF 80  .byte                                           $FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 9
001637r 2  00 00 00 00  
00163Br 2  00 00 00 00  
001673r 2  FF FF FF 80  .byte                                             $FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 8
001677r 2  00 00 00 00  
00167Br 2  00 00 00 00  
0016B3r 2  FF FF FF 80  .byte                                               $FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 7
0016B7r 2  00 00 00 00  
0016BBr 2  00 00 00 00  
0016F3r 2  FF FF FF 80  .byte                                                 $FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 6
0016F7r 2  00 00 00 00  
0016FBr 2  00 00 00 00  
001733r 2  FF FF FF 80  .byte                                                   $FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF  ; 5
001737r 2  00 00 00 00  
00173Br 2  00 00 00 00  
001773r 2  FF FF FF 80  .byte                                                     $FF,$FF,$FF,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF  ; 4
001777r 2  00 00 00 00  
00177Br 2  00 00 00 00  
0017B3r 2  FF FF FF 80  .byte                                                       $FF,$FF,$FF,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF  ; 3
0017B7r 2  80 00 00 00  
0017BBr 2  00 00 00 00  
0017F3r 2  FF FF FF FF  .byte                                                         $FF,$FF,$FF,$FF,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF  ; 2
0017F7r 2  80 80 00 00  
0017FBr 2  00 00 00 00  
001833r 2  FF FF FF FF  .byte                                                           $FF,$FF,$FF,$FF,$FF,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF ; 01
001837r 2  FF 80 80 00  
00183Br 2  00 00 00 00  
001873r 2  FF FF FF FF  .byte                                                             $FF,$FF,$FF,$FF,$FF,$FF,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF  ; 00 tub wall north
001877r 2  FF FF 80 80  
00187Br 2  80 80 80 80  
0018B3r 2  FF FF FF FF  .res 64,$FF
0018B7r 2  FF FF FF FF  
0018BBr 2  FF FF FF FF  
0018F3r 2               
0018F3r 2               
0018F3r 2               
0018F3r 1               
0018F3r 1               ; 1900
0018F3r 1               
0018F3r 1               OBJECT_LIST_Z_START_POINTERS: ; 1900
0018F3r 1  00 00 00 00  .res 256,0
0018F7r 1  00 00 00 00  
0018FBr 1  00 00 00 00  
0019F3r 1               OBJECT_LIST_BYTE0_ADDRLOW: ; 1A00 addr low
0019F3r 1  00 00 00 00  .res 256,0
0019F7r 1  00 00 00 00  
0019FBr 1  00 00 00 00  
001AF3r 1               OBJECT_LIST_BYTE1_MODE: ; 1B00 mode/addr bank
001AF3r 1  00 00 00 00  .res 256,0
001AF7r 1  00 00 00 00  
001AFBr 1  00 00 00 00  
001BF3r 1               OBJECT_LIST_BYTE2_X: ; 1C00 X position onscreen ( assumed positive for now)
001BF3r 1  00 00 00 00  .res 256,0
001BF7r 1  00 00 00 00  
001BFBr 1  00 00 00 00  
001CF3r 1               OBJECT_LIST_BYTE3_Y: ; 1D00 y position onscreen
001CF3r 1  00 00 00 00  .res 256,0
001CF7r 1  00 00 00 00  
001CFBr 1  00 00 00 00  
001DF3r 1               OBJECT_LIST_BYTE4_ZFLIPS: ; 1E00 collision / z / flips
001DF3r 1  00 00 00 00  .res 256,0
001DF7r 1  00 00 00 00  
001DFBr 1  00 00 00 00  
001EF3r 1               OBJECT_LIST_BYTE5_SIZE: ; 1F00 size / pal offset
001EF3r 1  00 00 00 00  .res 256,0
001EF7r 1  00 00 00 00  
001EFBr 1  00 00 00 00  
001FF3r 1               OBJECT_LIST_BYTE6_NEXT: ; 2000 NEXT
001FF3r 1  00 00 00 00  .res 256,0
001FF7r 1  00 00 00 00  
001FFBr 1  00 00 00 00  
0020F3r 1               
0020F3r 1               
0020F3r 1               
0020F3r 1               WORLD_TO_CELL_XH: ; 2100
0020F3r 1  00 00 01 02  .byte 0,0,1,2,3,4,5,6,6,7,8,9,10,11,12,12,13,14,15,16,17,18,19,19,20,21,22,23,24,25,25,26,27,28,29,30,31,32,32,33,34,35,36,37,38,38,39,40,41,42,43,44,45,45,46,47,48,49,50,51,51,52,53,54,55,56,57,58,58,59,60,61,62,63,64,64,65,66,67,68,69,70,71,71,72,73,74,75,76,77,77,78,79,80,81,82,83,84,84,85,86,87,88,89,90,90,91,92,93,94,95,96,96,97,98,99,100,101,102,103,103,104,105,106,107,108,109,109,110,111,112,113,114,115,116,116,117,118,119,120,121,122,122,123,124,125,126,127,128,129,129,130,131,132,133,134,135,135,136,137,138,139,140,141,142,142,143,144,145,146,147,148,148,149,150,151,152,153,154,155,155,156,157,158,159,160,161,161,162,163,164,165,166,167,168,168,169,170,171,172,173,174,174,175,176,177,178,179,180,180,181,182,183,184,185,186,187,187,188,189,190,191,192,193,193,194,195,196,197,198,199,200,200,201,202,203,204,205,206,206,207,208,209,210,211,212,213,213,214,215,216,217,218,219,219,220
0020F7r 1  03 04 05 06  
0020FBr 1  06 07 08 09  
0021F3r 1               ;.byte 0,0,1,2,3,4,5,6,6,7,8,9,10,11,12,12,13,14,15,16,17,18,19,19,20,21,22,23,24,25,25,26,27,28,29,30,31,32,32,33,34,35,36,37,38,38,39,40,41,42,43,44,45,45,46,47,48,49,50,51,51,52,53,54,55,56,57,58,58,59,60,61,62,63,64,64,65,66,67,68,69,70,71,71,72,73,74,75,76,77,77,78,79,80,81,82,83,84,84,85,86,87,88,89,90,90,91,92,93,94,95,96,96,97,98,99,100,101,102,103,103,104,105,106,107,108,109,109
0021F3r 1               ;.res 128,128
0021F3r 1               WORLD_TO_CELL_XL:
0021F3r 1  00 DD BB 99  .byte 0,221,187,153,118,84,50,15,237,203,169,134,100,66,31,253,219,184,150,116,82,47,13,235,200,166,132,97,63,29,251,216,182,148,113,79,45,10,232,198,164,129,95,61,26,248,214,180,145,111,77,42,8,230,195,161,127,93,58,24,246,211,177,143,108,74,40,6,227,193,159,124,90,56,21,243,209,175,140,106,72,37,3,225,191,156,122,88,53,19,241,206,172,138,104,69,35,1,222,188,154,119,85,51,17,238,204,170,135,101,67,32,254,220,186,151,117,83,48,14,236,202,167,133,99,64,30,252,217,183,149,115,80,46,12,233,199,165,130,96,62,28,249,215,181,146,112,78,43,9,231,197,162,128,94,59,25,247,212,178,144,110,75,41,7,228,194,160,126,91,57,23,244,210,176,141,107,73,39,4,226,192,157,123,89,54,20,242,208,173,139,105,70,36,2,223,189,155,121,86,52,18,239,205,171,137,102,68,34,255,221,187,152,118,84,50,15,237,203,168,134,100,65,31,253,219,184,150,116,81,47,13,234,200,166,132,97,63,29,250,216,182,148,113,79,45,10,232,198,163,129,95,61,26,248,214
0021F7r 1  76 54 32 0F  
0021FBr 1  ED CB A9 86  
0022F3r 1               ;.byte 0,221,187,153,118,84,50,15,237,203,169,134,100,66,31,253,219,184,150,116,82,47,13,235,200,166,132,97,63,29,251,216,182,148,113,79,45,10,232,198,164,129,95,61,26,248,214,180,145,111,77,42,8,230,195,161,127,93,58,24,246,211,177,143,108,74,40,6,227,193,159,124,90,56,21,243,209,175,140,106,72,37,3,225,191,156,122,88,53,19,241,206,172,138,104,69,35,1,222,188,154,119,85,51,17,238,204,170,135,101,67,32,254,220,186,151,117,83,48,14,236,202,167,133,99,64,30,252
0022F3r 1               ;.res 128,0
0022F3r 1               CELL_TO_WORLD_XH: ; 2200
0022F3r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,8,9,10,11,12,13,15,16,17,18,19,20,21,23,24,25,26,27,28,30,31,32,33,34,35,36,38,39,40,41,42,43,45,46,47,48,49,50,51,53,54,55,56,57,58,60,61,62,63,64,65,66,68,69,70,71,72,73,75,76,77,78,79,80,81,83,84,85,86,87,88,90,91,92,93,94,95,96,98,99,100,101,102,103,105,106,107,108,109,110,112,113,114,115,116,117,118,120,121,122,123,124,125,127,128,129,130,131,132,133,135,136,137,138,139,140,142,143,144,145,146
0022F7r 1  04 05 06 08  
0022FBr 1  09 0A 0B 0C  
002373r 1               CELL_TO_WORLD_XL: ; 2280
002373r 1  00 27 4F 76  .byte 0,39,79,118,158,198,237,21,60,100,140,179,219,2,42,82,121,161,200,240,24,63,103,142,182,222,5,45,84,124,164,203,243,26,66,106,145,185,224,8,48,87,127,166,206,246,29,69,108,148,188,227,11,50,90,130,169,209,248,32,72,111,151,191,230,14,53,93,133,172,212,251,35,75,114,154,193,233,17,56,96,135,175,215,254,38,77,117,157,196,236,19,59,99,138,178,217,1,41,80,120,159,199,239,22,62,101,141,181,220,4,43,83,123,162,202,241,25,65,104,144,184,223,7,46,86,126,165
002377r 1  9E C6 ED 15  
00237Br 1  3C 64 8C B3  
0023F3r 1               
0023F3r 1               CELL_LOW_TO_WORLD_XH: ; 2300
0023F3r 1  00 00 00 00  .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
0023F7r 1  00 00 00 00  
0023FBr 1  00 00 00 00  
0024F3r 1               CELL_LOW_TO_WORLD_XL: ; 2400
0024F3r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,8,9,10,11,12,13,15,16,17,18,19,20,21,23,24,25,26,27,28,30,31,32,33,34,35,36,38,39,40,41,42,43,45,46,47,48,49,50,51,53,54,55,56,57,58,60,61,62,63,64,65,66,68,69,70,71,72,73,75,76,77,78,79,80,81,83,84,85,86,87,88,90,91,92,93,94,95,96,98,99,100,101,102,103,105,106,107,108,109,110,112,113,114,115,116,117,118,120,121,122,123,124,125,127,128,129,130,131,132,133,135,136,137,138,139,140,142,143,144,145,146,147,148,150,151,152,153,154,155,157,158,159,160,161,162,163,165,166,167,168,169,170,172,173,174,175,176,177,178,180,181,182,183,184,185,187,188,189,190,191,192,193,195,196,197,198,199,200,202,203,204,205,206,207,209,210,211,212,213,214,215,217,218,219,220,221,222,224,225,226,227,228,229,230,232,233,234,235,236,237,239,240,241,242,243,244,245,247,248,249,250,251,252,254,255,0,1,2,3,4,6,7,8,9,10,11,13,14,15,16,17,18,19,21,22,23,24,25,26,28,29,30,31,32,33,34,36,37,38
0024F7r 1  04 05 06 08  
0024FBr 1  09 0A 0B 0C  
0025F3r 1               
0025F3r 1               SPRITE_NUM_HIGH_NIBBLE: ; 2900
0025F3r 1  00 00 00 00  .res 16, 0
0025F7r 1  00 00 00 00  
0025FBr 1  00 00 00 00  
002603r 1  01 01 01 01  .res 16, 1
002607r 1  01 01 01 01  
00260Br 1  01 01 01 01  
002613r 1  02 02 02 02  .res 16, 2
002617r 1  02 02 02 02  
00261Br 1  02 02 02 02  
002623r 1  03 03 03 03  .res 16, 3
002627r 1  03 03 03 03  
00262Br 1  03 03 03 03  
002633r 1  04 04 04 04  .res 16, 4
002637r 1  04 04 04 04  
00263Br 1  04 04 04 04  
002643r 1  05 05 05 05  .res 16, 5
002647r 1  05 05 05 05  
00264Br 1  05 05 05 05  
002653r 1  06 06 06 06  .res 16, 6
002657r 1  06 06 06 06  
00265Br 1  06 06 06 06  
002663r 1  07 07 07 07  .res 16, 7
002667r 1  07 07 07 07  
00266Br 1  07 07 07 07  
002673r 1  08 08 08 08  .res 16, 8
002677r 1  08 08 08 08  
00267Br 1  08 08 08 08  
002683r 1  09 09 09 09  .res 16, 9
002687r 1  09 09 09 09  
00268Br 1  09 09 09 09  
002693r 1  0A 0A 0A 0A  .res 16, 10
002697r 1  0A 0A 0A 0A  
00269Br 1  0A 0A 0A 0A  
0026A3r 1  0B 0B 0B 0B  .res 16, 11
0026A7r 1  0B 0B 0B 0B  
0026ABr 1  0B 0B 0B 0B  
0026B3r 1  0C 0C 0C 0C  .res 16, 12
0026B7r 1  0C 0C 0C 0C  
0026BBr 1  0C 0C 0C 0C  
0026C3r 1  0D 0D 0D 0D  .res 16, 13
0026C7r 1  0D 0D 0D 0D  
0026CBr 1  0D 0D 0D 0D  
0026D3r 1  0E 0E 0E 0E  .res 16, 14
0026D7r 1  0E 0E 0E 0E  
0026DBr 1  0E 0E 0E 0E  
0026E3r 1  0F 0F 0F 0F  .res 16, 15
0026E7r 1  0F 0F 0F 0F  
0026EBr 1  0F 0F 0F 0F  
0026F3r 1               
0026F3r 1               SPRITE_NUM_LOW_NIBBLE: ; 2A00
0026F3r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
0026F7r 1  04 05 06 07  
0026FBr 1  08 09 0A 0B  
002703r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
002707r 1  04 05 06 07  
00270Br 1  08 09 0A 0B  
002713r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
002717r 1  04 05 06 07  
00271Br 1  08 09 0A 0B  
002723r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
002727r 1  04 05 06 07  
00272Br 1  08 09 0A 0B  
002733r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
002737r 1  04 05 06 07  
00273Br 1  08 09 0A 0B  
002743r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
002747r 1  04 05 06 07  
00274Br 1  08 09 0A 0B  
002753r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
002757r 1  04 05 06 07  
00275Br 1  08 09 0A 0B  
002763r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
002767r 1  04 05 06 07  
00276Br 1  08 09 0A 0B  
002773r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
002777r 1  04 05 06 07  
00277Br 1  08 09 0A 0B  
002783r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
002787r 1  04 05 06 07  
00278Br 1  08 09 0A 0B  
002793r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
002797r 1  04 05 06 07  
00279Br 1  08 09 0A 0B  
0027A3r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
0027A7r 1  04 05 06 07  
0027ABr 1  08 09 0A 0B  
0027B3r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
0027B7r 1  04 05 06 07  
0027BBr 1  08 09 0A 0B  
0027C3r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
0027C7r 1  04 05 06 07  
0027CBr 1  08 09 0A 0B  
0027D3r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
0027D7r 1  04 05 06 07  
0027DBr 1  08 09 0A 0B  
0027E3r 1  00 01 02 03  .byte 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
0027E7r 1  04 05 06 07  
0027EBr 1  08 09 0A 0B  
0027F3r 1               
0027F3r 1               LOW_NIBBLE_TO_HEX: ;
0027F3r 1  30 31 32 33  .repeat 16
0027F7r 1  34 35 36 37  
0027FBr 1  38 39 01 02  
0028F3r 1               ;      0   1   2   3   4   5   6   7   8   9   A   B   C   D   E   F
0028F3r 1               .byte  48, 49, 50, 51, 52, 53, 54, 55, 56, 57,  1,  2,  3,  4,  5,  6
0028F3r 1               .endrepeat
0028F3r 1               
0028F3r 1               HIGH_NIBBLE_TO_HEX: ;
0028F3r 1  30 30 30 30  .res 16,48
0028F7r 1  30 30 30 30  
0028FBr 1  30 30 30 30  
002903r 1  31 31 31 31  .res 16,49
002907r 1  31 31 31 31  
00290Br 1  31 31 31 31  
002913r 1  32 32 32 32  .res 16,50
002917r 1  32 32 32 32  
00291Br 1  32 32 32 32  
002923r 1  33 33 33 33  .res 16,51
002927r 1  33 33 33 33  
00292Br 1  33 33 33 33  
002933r 1  34 34 34 34  .res 16,52
002937r 1  34 34 34 34  
00293Br 1  34 34 34 34  
002943r 1  35 35 35 35  .res 16,53
002947r 1  35 35 35 35  
00294Br 1  35 35 35 35  
002953r 1  36 36 36 36  .res 16,54
002957r 1  36 36 36 36  
00295Br 1  36 36 36 36  
002963r 1  37 37 37 37  .res 16,55
002967r 1  37 37 37 37  
00296Br 1  37 37 37 37  
002973r 1  38 38 38 38  .res 16,56
002977r 1  38 38 38 38  
00297Br 1  38 38 38 38  
002983r 1  39 39 39 39  .res 16,57
002987r 1  39 39 39 39  
00298Br 1  39 39 39 39  
002993r 1  01 01 01 01  .res 16,1
002997r 1  01 01 01 01  
00299Br 1  01 01 01 01  
0029A3r 1  02 02 02 02  .res 16,2
0029A7r 1  02 02 02 02  
0029ABr 1  02 02 02 02  
0029B3r 1  03 03 03 03  .res 16,3
0029B7r 1  03 03 03 03  
0029BBr 1  03 03 03 03  
0029C3r 1  04 04 04 04  .res 16,4
0029C7r 1  04 04 04 04  
0029CBr 1  04 04 04 04  
0029D3r 1  05 05 05 05  .res 16,5
0029D7r 1  05 05 05 05  
0029DBr 1  05 05 05 05  
0029E3r 1  06 06 06 06  .res 16,6
0029E7r 1  06 06 06 06  
0029EBr 1  06 06 06 06  
0029F3r 1               
0029F3r 1               SCREEN_Y_TO_Z: ; 2B00 this is shifted to be within range so that 192 =0 and -16 is 255
0029F3r 1  EB EA E8 E7  .byte 235,234,232,231,230,229,227,226,225,224,223,221,220,219,218,216,215,214,213,211,210,209,208,207,205,204,203,202,200,199,198,197,195,194,193,192,191,189,188,187,186,184,183,182,181,179,178,177,176,175,173,172,171,170,168,167,166,165,163,162,161,160,159,157,156,155,154,152,151,150,149,147,146,145,144,143,141,140,139,138,136,135,134,133,131,130,129,128,127,125,124,123,122,120,119,118,117,115,114,113,112,111,109,108,107,106,104,103,102,101,99,98,97,96,95,93,92,91,90,88,87,86,85,83,82,81,80,79,77,76,75,74,72,71,70,69,67,66,65,64,63,61,60,59,58,56,55,54,53,51,50,49,48,47,45,44,43,42,40,39,38,37,35,34,33,32,31,29,28,27,26,24,23,22,21,19,18,17,16,15,13,12,11,10,8,7,6,5,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,253,252,251,250,248,247,246,245,243,242,241,240,239,237,236
0029F7r 1  E6 E5 E3 E2  
0029FBr 1  E1 E0 DF DD  
002AF3r 1               ;.byte 255,253,252,250,249,247,246,244,243,241,240,238,237,235,234,232,231,229,228,227,225,224,222,221,219,218,216,215,213,212,210,209,207,206,204,203,202,200,199,197,196,194,193,191,190,188,187,185,184,182,181,179,178,177,175,174,172,171,169,168,166,165,163,162,160,159,157,156,154,153,152,150,149,147,146,144,143,141,140,138,137,135,134,132,131,129,128,127,125,124,122,121,119,118,116,115,113,112,110,109,107,106,104,103,101,100,99,97,96,94,93,91,90,88,87,85,84,82,81,79,78,76,75,74,72,71,69,68,66,65,63,62,60,59,57,56,54,53,51,50,49,47,46,44,43,41,40,38,37,35,34,32,31,29,28,26,25,24,22,21,19,18,16,15,13,12,10,9,7,6,4,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255
002AF3r 1               ;.byte 255,253,251,250,248,247,245,243,242,240,239,237,235,234,232,231,229,227,226,224,223,221,220,218,216,215,213,212,210,208,207,205,204,202,200,199,197,196,194,192,191,189,188,186,185,183,181,180,178,177,175,173,172,170,169,167,165,164,162,161,159,158,156,154,153,151,150,148,146,145,143,142,140,138,137,135,134,132,130,129,127,126,124,123,121,119,118,116,115,113,111,110,108,107,105,103,102,100,99,97,95,94,92,91,89,88,86,84,83,81,80,78,76,75,73,72,70,68,67,65,64,62,61,59,57,56,54,53,51,49,48,46,45,43,41,40,38,37,35,33,32,30,29,27,26,24,22,21,19,18,16,14,13,11,10,8,6,5,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
002AF3r 1               
002AF3r 1               CONVERT_HEIGHTS_PIXELS: ; 2C00
002AF3r 1               ;.res 256,0
002AF3r 1               ;.byte 0,0,1,1,2,3,3,4,4,5,6,6,7,7,8,9,9,10,11,11,12,12,13,14,14,15,15,16,17,17,18,18,19,20,20,21,22,22,23,23,24,25,25,26,26,27,28,28,29,30,30,31,31,32,33,33,34,34,35,36,36,37,37,38,39,39,40,41,41,42,42,43,44,44,45,45,46,47,47,48,48,49,50,50,51,52,52,53,53,54,55,55,56,56,57,58,58,59,60,60,61,61,62,63,63,64,64,65,66,66,67,67,68,69,69,70,71,71,72,72,73,74,74,75,75,76,77,77,78,78,79,80,80,81,82,82,83,83,84,85,85,86,86,87,88,88,89,90,90,91,91,92,93,93,94,94,95,96,96,97,97,98,99,99,100,101,101,102,102,103,104,104,105,105,106,107,107,108,109,109,110,110,111,112,112,113,113,114,115,115,116,116,117,118,118,119,120,120,121,121,122,123,123,124,124,125,126,126,127,127,128,129,129,130,131,131,132,132,133,134,134,135,135,136,137,137,138,139,139,140,140,141,142,142,143,143,144,145,145,146,146,147,148,148,149,150,150,151,151,152,153,153,154,154,155,156
002AF3r 1  00 00 01 01  .byte 0,0,1,1,2,3,3,4,4,5,6,6,7,7,8,9,9,10,11,11,12,12,13,14,14,15,15,16,17,17,18,18,19,20,20,21,22,22,23,23,24,25,25,26,26,27,28,28,29,30,30,31,31,32,33,33,34,34,35,36,36,37,37,38,39,39,40,41,41,42,42,43,44,44,45,45,46,47,47,48,48,49,50,50,51,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,0,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52;,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52
002AF7r 1  02 03 03 04  
002AFBr 1  04 05 06 06  
002B73r 1  00 00 00 00  .res 128,0
002B77r 1  00 00 00 00  
002B7Br 1  00 00 00 00  
002BF3r 1               CONVERT_HEIGHTS_PIXELS_L:
002BF3r 1               ;.res 256,0
002BF3r 1  00 9C 39 D6  .byte 0,156,57,214,115,15,172,73,230,130,31,188,89,245,146,47,204,105,5,162,63,220,120,21,178,79,235,136,37,194,95,251,152,53,210,110,11,168,69,225,126,27,184,84,241,142,43,200,100,1,158,59,215,116,17,174,74,231,132,33,190,90,247,148,49,205,106,7,164,64,221,122,23,180,80,237,138,39,195,96,253,154,54,211,112,0,169,70,227,128,29,185,86,243,144,44,201,102,3,159,60,217,118,19,175,76,233,134,34,191,92,249,149,50,207,108,9,165,66,223,124,24,181,82,239,139,40,197,98,254,155,56,213,114,14,171,72,229,129,30,187,88,244,145,46,203,104,4,161,62,219,119,20,177,78,234,135,36,193,94,250,151,52,209,109,10,167,68,224,125,26,183,83,240,141,42,199,99,0,157,58,214,115,16,173,73,230,131,32,189,89,246,147,48,204,105,6,163,63,220,121,22,179,79,236,137,38,194,95,252,153,53,210,111,12,168,69,226,127,28,184,85,242,143,43,200,101,2,158,59,216,117,18,174,75,232,133,33,190,91,248,148,49,206,107,7,164,65,222,123,23,180,81,238,138,39
002BF7r 1  73 0F AC 49  
002BFBr 1  E6 82 1F BC  
002CF3r 1               
002CF3r 1               SUBCELL_X_COS_L:
002CF3r 1  00 FF FF FF  .byte $0,$FF,$FF,$FF,$FE,$FE,$FD,$FC,$FB,$F9,$F8,$F6,$F4,$F3,$F1,$EE,$EC,$EA,$E7,$E4,$E1,$DE,$DB,$D8,$D4,$D1,$CD,$C9,$C5,$C1,$BD,$B9,$B5,$B0,$AB,$A7,$A2,$9D,$98,$93,$8E,$88,$83,$7E,$78,$73,$6D,$67,$61,$5C,$56,$50,$4A,$44,$3E,$38,$31,$2B,$25,$1F,$19,$12,$C,$6,$0,$F9,$F3,$ED,$E6,$E0,$DA,$D4,$CE,$C7,$C1,$BB,$B5,$AF,$A9,$A3,$9E,$98,$92,$8C,$87,$81,$7C,$77,$71,$6C,$67,$62,$5D,$58,$54,$4F,$4A,$46,$42,$3E,$3A,$36,$32,$2E,$2B,$27,$24,$21,$1E,$1B,$18,$15,$13,$11,$E,$C,$B,$9,$7,$6,$4,$3,$2,$1,$1,$0,$0,$0,$0,$0,$0,$0,$1,$1,$2,$3,$4,$6,$7,$9,$B,$C,$E,$11,$13,$15,$18,$1B,$1E,$21,$24,$27,$2B,$2E,$32,$36,$3A,$3E,$42,$46,$4A,$4F,$54,$58,$5D,$62,$67,$6C,$71,$77,$7C,$81,$87,$8C,$92,$98,$9E,$A3,$A9,$AF,$B5,$BB,$C1,$C7,$CE,$D4,$DA,$E0,$E6,$ED,$F3,$F9,$0,$6,$C,$12,$19,$1F,$25,$2B,$31,$38,$3E,$44,$4A,$50,$56,$5C,$61,$67,$6D,$73,$78,$7E,$83,$88,$8E,$93,$98,$9D,$A2,$A7,$AB,$B0,$B5,$B9,$BD,$C1,$C5,$C9,$CD,$D1,$D4,$D8,$DB,$DE,$E1,$E4,$E7,$EA,$EC,$EE,$F1,$F3,$F4,$F6,$F8,$F9,$FB,$FC,$FD,$FE,$FE,$FF,$FF,$FF
002CF7r 1  FE FE FD FC  
002CFBr 1  FB F9 F8 F6  
002DF3r 1               SUBCELL_X_COS_H:
002DF3r 1  01 00 00 00  .byte $1,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$00,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0
002DF7r 1  00 00 00 00  
002DFBr 1  00 00 00 00  
002EF3r 1               SUBCELL_X_SIN_H:
002EF3r 1  00 00 00 00  .byte $0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF
002EF7r 1  00 00 00 00  
002EFBr 1  00 00 00 00  
002FF3r 1               SUBCELL_X_SIN_L:
002FF3r 1  00 05 0A 10  .byte $0,$5,$A,$10,$15,$1B,$20,$25,$2B,$30,$35,$3B,$40,$45,$4A,$4F,$54,$59,$5E,$63,$68,$6D,$71,$76,$7B,$7F,$84,$88,$8C,$90,$94,$98,$9C,$A0,$A4,$A7,$AB,$AE,$B2,$B5,$B8,$BB,$BE,$C0,$C3,$C6,$C8,$CA,$CC,$CE,$D0,$D2,$D4,$D5,$D7,$D8,$D9,$DA,$DB,$DC,$DC,$DD,$DD,$DD,$DD,$DD,$DD,$DD,$DC,$DC,$DB,$DA,$D9,$D8,$D7,$D5,$D4,$D2,$D0,$CE,$CC,$CA,$C8,$C6,$C3,$C0,$BE,$BB,$B8,$B5,$B2,$AE,$AB,$A7,$A4,$A0,$9C,$98,$94,$90,$8C,$88,$84,$7F,$7B,$76,$71,$6D,$68,$63,$5E,$59,$54,$4F,$4A,$45,$40,$3B,$35,$30,$2B,$25,$20,$1B,$15,$10,$A,$5,$0,$FA,$F5,$EF,$EA,$E4,$DF,$DA,$D4,$CF,$CA,$C4,$BF,$BA,$B5,$B0,$AB,$A6,$A1,$9C,$97,$92,$8E,$89,$84,$80,$7B,$77,$73,$6F,$6B,$67,$63,$5F,$5B,$58,$54,$51,$4D,$4A,$47,$44,$41,$3F,$3C,$39,$37,$35,$33,$31,$2F,$2D,$2B,$2A,$28,$27,$26,$25,$24,$23,$23,$22,$22,$22,$22,$22,$22,$22,$23,$23,$24,$25,$26,$27,$28,$2A,$2B,$2D,$2F,$31,$33,$35,$37,$39,$3C,$3F,$41,$44,$47,$4A,$4D,$51,$54,$58,$5B,$5F,$63,$67,$6B,$6F,$73,$77,$7B,$80,$84,$89,$8E,$92,$97,$9C,$A1,$A6,$AB,$B0,$B5,$BA,$BF,$C4,$CA,$CF,$D4,$DA,$DF,$E4,$EA,$EF,$F5,$FA
002FF7r 1  15 1B 20 25  
002FFBr 1  2B 30 35 3B  
0030F3r 1               SUBCELL_Y_COS_H:
0030F3r 1  00 00 00 00  .byte $0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$00,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0
0030F7r 1  00 00 00 00  
0030FBr 1  00 00 00 00  
0031F3r 1               SUBCELL_Y_COS_L:
0031F3r 1  9C 9C 9C 9C  .byte $9C,$9C,$9C,$9C,$9C,$9B,$9B,$9A,$99,$98,$98,$97,$96,$94,$93,$92,$90,$8F,$8D,$8C,$8A,$88,$86,$84,$82,$80,$7D,$7B,$79,$76,$74,$71,$6E,$6C,$69,$66,$63,$60,$5D,$5A,$57,$53,$50,$4D,$49,$46,$43,$3F,$3B,$38,$34,$31,$2D,$29,$26,$22,$1E,$1A,$17,$13,$F,$B,$7,$3,$0,$FC,$F8,$F4,$F0,$EC,$E8,$E5,$E1,$DD,$D9,$D6,$D2,$CE,$CB,$C7,$C4,$C0,$BC,$B9,$B6,$B2,$AF,$AC,$A8,$A5,$A2,$9F,$9C,$99,$96,$93,$91,$8E,$8B,$89,$86,$84,$82,$7F,$7D,$7B,$79,$77,$75,$73,$72,$70,$6F,$6D,$6C,$6B,$69,$68,$67,$67,$66,$65,$64,$64,$63,$63,$63,$63,$63,$63,$63,$63,$63,$64,$64,$65,$66,$67,$67,$68,$69,$6B,$6C,$6D,$6F,$70,$72,$73,$75,$77,$79,$7B,$7D,$7F,$82,$84,$86,$89,$8B,$8E,$91,$93,$96,$99,$9C,$9F,$A2,$A5,$A8,$AC,$AF,$B2,$B6,$B9,$BC,$C0,$C4,$C7,$CB,$CE,$D2,$D6,$D9,$DD,$E1,$E5,$E8,$EC,$F0,$F4,$F8,$FC,$0,$3,$7,$B,$F,$13,$17,$1A,$1E,$22,$26,$29,$2D,$31,$34,$38,$3B,$3F,$43,$46,$49,$4D,$50,$53,$57,$5A,$5D,$60,$63,$66,$69,$6C,$6E,$71,$74,$76,$79,$7B,$7D,$80,$82,$84,$86,$88,$8A,$8C,$8D,$8F,$90,$92,$93,$94,$96,$97,$98,$98,$99,$9A,$9B,$9B,$9C,$9C,$9C,$9C
0031F7r 1  9C 9B 9B 9A  
0031FBr 1  99 98 98 97  
0032F3r 1               SUBCELL_Y_SIN_H:
0032F3r 1  00 00 00 00  .byte $0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF
0032F7r 1  00 00 00 00  
0032FBr 1  00 00 00 00  
0033F3r 1               SUBCELL_Y_SIN_L:
0033F3r 1  00 04 08 0D  .byte $0,$4,$8,$D,$11,$16,$1A,$1E,$23,$27,$2B,$30,$34,$38,$3C,$41,$45,$49,$4D,$51,$55,$59,$5D,$60,$64,$68,$6B,$6F,$72,$76,$79,$7C,$7F,$83,$86,$89,$8B,$8E,$91,$93,$96,$98,$9B,$9D,$9F,$A1,$A3,$A5,$A7,$A8,$AA,$AB,$AD,$AE,$AF,$B0,$B1,$B2,$B3,$B3,$B4,$B4,$B4,$B4,$B5,$B4,$B4,$B4,$B4,$B3,$B3,$B2,$B1,$B0,$AF,$AE,$AD,$AB,$AA,$A8,$A7,$A5,$A3,$A1,$9F,$9D,$9B,$98,$96,$93,$91,$8E,$8B,$89,$86,$83,$80,$7C,$79,$76,$72,$6F,$6B,$68,$64,$60,$5D,$59,$55,$51,$4D,$49,$45,$41,$3C,$38,$34,$30,$2B,$27,$23,$1E,$1A,$16,$11,$D,$8,$4,$0,$FB,$F7,$F2,$EE,$E9,$E5,$E1,$DC,$D8,$D4,$CF,$CB,$C7,$C3,$BE,$BA,$B6,$B2,$AE,$AA,$A6,$A2,$9F,$9B,$97,$94,$90,$8D,$89,$86,$83,$80,$7C,$79,$76,$74,$71,$6E,$6C,$69,$67,$64,$62,$60,$5E,$5C,$5A,$58,$57,$55,$54,$52,$51,$50,$4F,$4E,$4D,$4C,$4C,$4B,$4B,$4B,$4B,$4A,$4B,$4B,$4B,$4B,$4C,$4C,$4D,$4E,$4F,$50,$51,$52,$54,$55,$57,$58,$5A,$5C,$5E,$60,$62,$64,$67,$69,$6C,$6E,$71,$74,$76,$79,$7C,$80,$83,$86,$89,$8D,$90,$94,$97,$9B,$9F,$A2,$A6,$AA,$AE,$B2,$B6,$BA,$BE,$C3,$C7,$CB,$CF,$D4,$D8,$DC,$E1,$E5,$E9,$EE,$F2,$F7,$FB
0033F7r 1  11 16 1A 1E  
0033FBr 1  23 27 2B 30  
0034F3r 1               
0034F3r 1               MOVE_Y_H:
0034F3r 1  00 00 00 00  .byte $0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$00,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0
0034F7r 1  00 00 00 00  
0034FBr 1  00 00 00 00  
0035F3r 1               MOVE_Y_L:
0035F3r 1  08 07 07 07  .byte $8,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$6,$6,$6,$6,$6,$6,$6,$6,$6,$5,$5,$5,$5,$5,$5,$5,$4,$4,$4,$4,$4,$4,$3,$3,$3,$3,$3,$3,$2,$2,$2,$2,$2,$1,$1,$1,$1,$1,$0,$0,$0,$0,$0,$0,$FF,$FF,$FF,$FF,$FF,$FE,$FE,$FE,$FE,$FE,$FD,$FD,$FD,$FD,$FD,$FC,$FC,$FC,$FC,$FC,$FC,$FB,$FB,$FB,$FB,$FB,$FB,$FA,$FA,$FA,$FA,$FA,$FA,$FA,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$FA,$FA,$FA,$FA,$FA,$FA,$FA,$FB,$FB,$FB,$FB,$FB,$FB,$FC,$FC,$FC,$FC,$FC,$FC,$FD,$FD,$FD,$FD,$FD,$FE,$FE,$FE,$FE,$FE,$FF,$FF,$FF,$FF,$FF,$0,$0,$0,$0,$0,$0,$1,$1,$1,$1,$1,$2,$2,$2,$2,$2,$3,$3,$3,$3,$3,$3,$4,$4,$4,$4,$4,$4,$5,$5,$5,$5,$5,$5,$5,$6,$6,$6,$6,$6,$6,$6,$6,$6,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7,$7
0035F7r 1  07 07 07 07  
0035FBr 1  07 07 07 07  
0036F3r 1               MOVE_X_H:
0036F3r 1  00 00 00 00  .byte $0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$0,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF
0036F7r 1  00 00 00 00  
0036FBr 1  00 00 00 00  
0037F3r 1               MOVE_X_L:
0037F3r 1  00 00 00 00  .byte $0,$0,$0,$0,$0,$0,$1,$1,$1,$1,$1,$1,$2,$2,$2,$2,$2,$2,$2,$3,$3,$3,$3,$3,$3,$3,$4,$4,$4,$4,$4,$4,$4,$5,$5,$5,$5,$5,$5,$5,$5,$5,$5,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$6,$5,$5,$5,$5,$5,$5,$5,$5,$5,$5,$4,$4,$4,$4,$4,$4,$4,$3,$3,$3,$3,$3,$3,$3,$2,$2,$2,$2,$2,$2,$2,$1,$1,$1,$1,$1,$1,$0,$0,$0,$0,$0,$0,$FF,$FF,$FF,$FF,$FF,$FE,$FE,$FE,$FE,$FE,$FE,$FD,$FD,$FD,$FD,$FD,$FD,$FD,$FC,$FC,$FC,$FC,$FC,$FC,$FC,$FB,$FB,$FB,$FB,$FB,$FB,$FB,$FA,$FA,$FA,$FA,$FA,$FA,$FA,$FA,$FA,$FA,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$FA,$FA,$FA,$FA,$FA,$FA,$FA,$FA,$FA,$FA,$FB,$FB,$FB,$FB,$FB,$FB,$FB,$FC,$FC,$FC,$FC,$FC,$FC,$FC,$FD,$FD,$FD,$FD,$FD,$FD,$FD,$FE,$FE,$FE,$FE,$FE,$FE,$FF,$FF,$FF,$FF,$FF
0037F7r 1  00 00 01 01  
0037FBr 1  01 01 01 01  
0038F3r 1               
0038F3r 1               
0038F3r 1               WORLD_SPRITE_CENTER_XH: ; 128 bytes
0038F3r 1  64 64 64 64  .byte $64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$65,$65,$65,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$65,$65,$65,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$65,$65,$65,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64,$64
0038F7r 1  64 64 64 64  
0038FBr 1  64 64 64 64  
003973r 1               WORLD_SPRITE_CENTER_XL: ; 128 bytes
003973r 1  00 0D 1B 29  .byte $0,$D,$1B,$29,$36,$43,$51,$5E,$6B,$78,$85,$92,$9F,$AB,$B8,$C4,$D1,$DD,$E9,$F6,$2,$E,$A,$FE,$F2,$E5,$D9,$CD,$C0,$B4,$A7,$9A,$8E,$81,$74,$67,$5A,$4C,$3F,$32,$24,$16,$9,$4,$12,$20,$2D,$3B,$48,$55,$62,$6F,$7C,$89,$96,$A3,$B0,$BC,$C9,$D5,$E1,$EE,$FA,$6,$12,$13,$FA,$EE,$E1,$D5,$C9,$BC,$B0,$A3,$96,$89,$7C,$6F,$62,$55,$48,$3B,$2D,$20,$12,$4,$9,$16,$24,$32,$3F,$4C,$5A,$67,$74,$81,$8E,$9A,$A7,$B4,$C0,$CD,$D9,$E5,$F2,$FE,$A,$E,$2,$F6,$E9,$DD,$D1,$C4,$B8,$AB,$9F,$92,$85,$78,$6B,$5E,$51,$43,$36,$29,$1B,$D
003977r 1  36 43 51 5E  
00397Br 1  6B 78 85 92  
0039F3r 1               WORLD_SPRITE_CENTER_YH: ; 128 bytes
0039F3r 1  4C 4C 4C 4C  .byte $4C,$4C,$4C,$4C,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4C,$4C,$4C,$4C,$4C,$4C,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4C,$4C,$4C,$4C,$4C,$4C,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4B,$4C,$4C,$4C
0039F7r 1  4B 4B 4B 4B  
0039FBr 1  4B 4B 4B 4B  
003A73r 1               WORLD_SPRITE_CENTER_YL: ; 128 bytes
003A73r 1  19 11 08 00  .byte $19,$11,$8,$0,$F7,$EE,$E6,$DD,$D4,$CB,$C2,$B9,$B0,$A7,$9D,$94,$8B,$81,$78,$6E,$64,$5B,$5E,$68,$71,$7B,$84,$8E,$97,$A0,$AA,$B3,$BC,$C5,$CE,$D7,$E0,$E8,$F1,$FA,$3,$B,$14,$17,$E,$5,$FD,$F4,$EB,$E3,$DA,$D1,$C8,$BF,$B6,$AD,$A3,$9A,$91,$87,$7E,$74,$6B,$61,$57,$57,$6B,$74,$7E,$87,$91,$9A,$A3,$AD,$B6,$BF,$C8,$D1,$DA,$E3,$EB,$F4,$FD,$5,$E,$17,$14,$B,$3,$FA,$F1,$E8,$E0,$D7,$CE,$C5,$BC,$B3,$AA,$A0,$97,$8E,$84,$7B,$71,$68,$5E,$5B,$64,$6E,$78,$81,$8B,$94,$9D,$A7,$B0,$B9,$C2,$CB,$D4,$DD,$E6,$EE,$F7,$0,$8,$11
003A77r 1  F7 EE E6 DD  
003A7Br 1  D4 CB C2 B9  
003AF3r 1               
003AF3r 1               WORLD_SPRITE_NUM_lookies: ; 128 bytes
003AF3r 1               ;      0   1   2   3   4   5   6   7   8   9   A   B   C   D   E   F
003AF3r 1  00 00 00 00  .byte   0,  0,  0,  0, 32, 32, 32, 32, 32, 32, 64, 64, 64, 64, 64, 64
003AF7r 1  20 20 20 20  
003AFBr 1  20 20 40 40  
003B03r 1  40 40 60 60  .byte  64, 64, 96, 96,160,160,160, 96, 96, 96, 64, 64, 64, 64, 64, 64
003B07r 1  A0 A0 A0 60  
003B0Br 1  60 60 40 40  
003B13r 1  40 40 20 20  .byte  64, 64, 32, 32, 32, 32, 32, 32,  0,  0,  0,  0,  0,  0, 32, 32
003B17r 1  20 20 20 20  
003B1Br 1  00 00 00 00  
003B23r 1  20 20 20 20  .byte  32, 32, 32, 32, 32, 64, 64, 64, 64, 64, 64, 64, 96, 96, 96,160
003B27r 1  20 40 40 40  
003B2Br 1  40 40 40 40  
003B33r 1  A0 A0 60 60  .byte 160,160, 96, 96, 96, 64, 64, 64, 64, 64, 64, 64, 32, 32, 32, 32
003B37r 1  60 40 40 40  
003B3Br 1  40 40 40 40  
003B43r 1  20 20 20 00  .byte  32, 32, 32,  0,  0,  0,  0,  0,  0, 32, 32, 32, 32, 32, 32, 64
003B47r 1  00 00 00 00  
003B4Br 1  00 20 20 20  
003B53r 1  40 40 40 40  .byte  64, 64, 64, 64, 64, 64, 64, 96, 96, 96,160,160,160, 96, 96, 64
003B57r 1  40 40 40 60  
003B5Br 1  60 60 A0 A0  
003B63r 1  40 40 40 40  .byte  64, 64, 64, 64, 64, 64, 64, 32, 32, 32, 32, 32, 32,  0,  0,  0
003B67r 1  40 40 40 20  
003B6Br 1  20 20 20 20  
003B73r 1               WORLD_WALL_SPRITE_NUM_lookies:
003B73r 1  80 80 80 80  .byte 128,128,128,128,128,128,128,128,128,128,192,192,192,192,192,192
003B77r 1  80 80 80 80  
003B7Br 1  80 80 C0 C0  
003B83r 1  C0 C0 C0 C0  .byte 192,192,192,192,224,224,224,192,192,192,192,192,192,192,192,192
003B87r 1  E0 E0 E0 C0  
003B8Br 1  C0 C0 C0 C0  
003B93r 1  C0 C0 80 80  .byte 192,192,128,128,128,128,128,128,128,128,128,128,128,128,128,128
003B97r 1  80 80 80 80  
003B9Br 1  80 80 80 80  
003BA3r 1  80 80 80 80  .byte 128,128,128,128,128,192,192,192,192,192,192,192,192,192,192,224
003BA7r 1  80 C0 C0 C0  
003BABr 1  C0 C0 C0 C0  
003BB3r 1  E0 E0 C0 C0  .byte 224,224,192,192,192,192,192,192,192,192,192,192,128,128,128,128
003BB7r 1  C0 C0 C0 C0  
003BBBr 1  C0 C0 C0 C0  
003BC3r 1  80 80 80 80  .byte 128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,192
003BC7r 1  80 80 80 80  
003BCBr 1  80 80 80 80  
003BD3r 1  C0 C0 C0 C0  .byte 192,192,192,192,192,192,192,192,192,192,224,224,224,192,192,192
003BD7r 1  C0 C0 C0 C0  
003BDBr 1  C0 C0 E0 E0  
003BE3r 1  C0 C0 C0 C0  .byte 192,192,192,192,192,192,192,128,128,128,128,128,128,128,128,128
003BE7r 1  C0 C0 C0 80  
003BEBr 1  80 80 80 80  
003BF3r 1               
003BF3r 1               SPRITE_ADDRESS_LOW_HIGH:
003BF3r 1  00 00 00 00  .byte 0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31
003BF7r 1  00 00 00 00  
003BFBr 1  01 01 01 01  
003CF3r 1               
003CF3r 1               SPRITE_ADDRESS_LOW_LOW:
003CF3r 1  00 20 40 60  .byte 0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224,0,32,64,96,128,160,192,224
003CF7r 1  80 A0 C0 E0  
003CFBr 1  00 20 40 60  
003DF3r 1               
003DF3r 1               NIBBLE_SWAPPER:
003DF3r 1               ;      0   1   2   3   4   5   6   7   8   9   A   B   C   D   E   F
003DF3r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003DF7r 1  40 50 60 70  
003DFBr 1  80 90 A0 B0  
003E03r 1  01 11 21 31  .byte $01,$11,$21,$31,$41,$51,$61,$71,$81,$91,$A1,$B1,$C1,$D1,$E1,$F1
003E07r 1  41 51 61 71  
003E0Br 1  81 91 A1 B1  
003E13r 1  02 12 22 32  .byte $02,$12,$22,$32,$42,$52,$62,$72,$82,$92,$A2,$B2,$C2,$D2,$E2,$F2
003E17r 1  42 52 62 72  
003E1Br 1  82 92 A2 B2  
003E23r 1  03 13 23 33  .byte $03,$13,$23,$33,$43,$53,$63,$73,$83,$93,$A3,$B3,$C3,$D3,$E3,$F3
003E27r 1  43 53 63 73  
003E2Br 1  83 93 A3 B3  
003E33r 1  04 14 24 34  .byte $04,$14,$24,$34,$44,$54,$64,$74,$84,$94,$A4,$B4,$C4,$D4,$E4,$F4
003E37r 1  44 54 64 74  
003E3Br 1  84 94 A4 B4  
003E43r 1  05 15 25 35  .byte $05,$15,$25,$35,$45,$55,$65,$75,$85,$95,$A5,$B5,$C5,$D5,$E5,$F5
003E47r 1  45 55 65 75  
003E4Br 1  85 95 A5 B5  
003E53r 1  06 16 26 36  .byte $06,$16,$26,$36,$46,$56,$66,$76,$86,$96,$A6,$B6,$C6,$D6,$E6,$F6
003E57r 1  46 56 66 76  
003E5Br 1  86 96 A6 B6  
003E63r 1  07 17 27 37  .byte $07,$17,$27,$37,$47,$57,$67,$77,$87,$97,$A7,$B7,$C7,$D7,$E7,$F7
003E67r 1  47 57 67 77  
003E6Br 1  87 97 A7 B7  
003E73r 1  08 18 28 38  .byte $08,$18,$28,$38,$48,$58,$68,$78,$88,$98,$A8,$B8,$C8,$D8,$E8,$F8
003E77r 1  48 58 68 78  
003E7Br 1  88 98 A8 B8  
003E83r 1  09 19 29 39  .byte $09,$19,$29,$39,$49,$59,$69,$79,$89,$99,$A9,$B9,$C9,$D9,$E9,$F9
003E87r 1  49 59 69 79  
003E8Br 1  89 99 A9 B9  
003E93r 1  0A 1A 2A 3A  .byte $0A,$1A,$2A,$3A,$4A,$5A,$6A,$7A,$8A,$9A,$AA,$BA,$CA,$DA,$EA,$FA
003E97r 1  4A 5A 6A 7A  
003E9Br 1  8A 9A AA BA  
003EA3r 1  0B 1B 2B 3B  .byte $0B,$1B,$2B,$3B,$4B,$5B,$6B,$7B,$8B,$9B,$AB,$BB,$CB,$DB,$EB,$FB
003EA7r 1  4B 5B 6B 7B  
003EABr 1  8B 9B AB BB  
003EB3r 1  0C 1C 2C 3C  .byte $0C,$1C,$2C,$3C,$4C,$5C,$6C,$7C,$8C,$9C,$AC,$BC,$CC,$DC,$EC,$FC
003EB7r 1  4C 5C 6C 7C  
003EBBr 1  8C 9C AC BC  
003EC3r 1  0D 1D 2D 3D  .byte $0D,$1D,$2D,$3D,$4D,$5D,$6D,$7D,$8D,$9D,$AD,$BD,$CD,$DD,$ED,$FD
003EC7r 1  4D 5D 6D 7D  
003ECBr 1  8D 9D AD BD  
003ED3r 1  0E 1E 2E 3E  .byte $0E,$1E,$2E,$3E,$4E,$5E,$6E,$7E,$8E,$9E,$AE,$BE,$CE,$DE,$EE,$FE
003ED7r 1  4E 5E 6E 7E  
003EDBr 1  8E 9E AE BE  
003EE3r 1  0F 1F 2F 3F  .byte $0F,$1F,$2F,$3F,$4F,$5F,$6F,$7F,$8F,$9F,$AF,$BF,$CF,$DF,$EF,$FF
003EE7r 1  4F 5F 6F 7F  
003EEBr 1  8F 9F AF BF  
003EF3r 1               
003EF3r 1               LOW_NIBBLE_HIGH:
003EF3r 1               ;      0   1   2   3   4   5   6   7   8   9   A   B   C   D   E   F
003EF3r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003EF7r 1  40 50 60 70  
003EFBr 1  80 90 A0 B0  
003F03r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003F07r 1  40 50 60 70  
003F0Br 1  80 90 A0 B0  
003F13r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003F17r 1  40 50 60 70  
003F1Br 1  80 90 A0 B0  
003F23r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003F27r 1  40 50 60 70  
003F2Br 1  80 90 A0 B0  
003F33r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003F37r 1  40 50 60 70  
003F3Br 1  80 90 A0 B0  
003F43r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003F47r 1  40 50 60 70  
003F4Br 1  80 90 A0 B0  
003F53r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003F57r 1  40 50 60 70  
003F5Br 1  80 90 A0 B0  
003F63r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003F67r 1  40 50 60 70  
003F6Br 1  80 90 A0 B0  
003F73r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003F77r 1  40 50 60 70  
003F7Br 1  80 90 A0 B0  
003F83r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003F87r 1  40 50 60 70  
003F8Br 1  80 90 A0 B0  
003F93r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003F97r 1  40 50 60 70  
003F9Br 1  80 90 A0 B0  
003FA3r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003FA7r 1  40 50 60 70  
003FABr 1  80 90 A0 B0  
003FB3r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003FB7r 1  40 50 60 70  
003FBBr 1  80 90 A0 B0  
003FC3r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003FC7r 1  40 50 60 70  
003FCBr 1  80 90 A0 B0  
003FD3r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003FD7r 1  40 50 60 70  
003FDBr 1  80 90 A0 B0  
003FE3r 1  00 10 20 30  .byte $00,$10,$20,$30,$40,$50,$60,$70,$80,$90,$A0,$B0,$C0,$D0,$E0,$F0
003FE7r 1  40 50 60 70  
003FEBr 1  80 90 A0 B0  
003FF3r 1               
003FF3r 1               SPECIAL_SCRATCH: ; 256 bytes
003FF3r 1  00 00 00 00  .res 256,0
003FF7r 1  00 00 00 00  
003FFBr 1  00 00 00 00  
0040F3r 1               
0040F3r 1               MISSING_ONE_NEIGHBOR_MUL:
0040F3r 1  00 01 02 04  .byte 0,1,2,4,5,6,7,8,10,11,12,13,14,16,17,18,19,20,22,23,24,25,26,28,29,30,31,32,34,35,36,37,38,40,41,42,43,44,46,47,48,49,50,52,53,54,55,56,58,59,60,61,62,64,65,66,67,68,70,71,72,73,74,76,77,78,79,80,82,83,84,85,86,88,89,90,91,92,94,95,96,97,98,100,101,102,103,104,106,107,108,109,110,112,113,114,115,116,118,119,120,121,122,124,125,126,127,128,130,131,132,133,134,136,137,138,139,140,142,143,144,145,146,148,149,150,151,152,154,155,156,157,158,160,161,162,163,164,166,167,168,169,170,172,173,174,175,176,178,179,180,181,182,184,185,186,187,188,190,191,192,193,194,196,197,198,199,200,202,203,204,205,206,208,209,210,211,212,214,215,216,217,218,220,221,222,223,224,226,227,228,229,230,232,233,234,235,236,238,239,240,241,242,244,245,246,247,248,250,251,252,253,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
0040F7r 1  05 06 07 08  
0040FBr 1  0A 0B 0C 0D  
0041F3r 1               
0041F3r 1               MISSING_TWO_NEIGHBOR_MUL:
0041F3r 1  00 02 03 05  .byte 0,2,3,5,6,8,9,11,12,14,15,17,18,20,21,23,24,26,27,29,30,32,33,35,36,38,39,41,42,44,45,47,48,50,51,53,54,56,57,59,60,62,63,65,66,68,69,71,72,74,75,77,78,80,81,83,84,86,87,89,90,92,93,95,96,98,99,101,102,104,105,107,108,110,111,113,114,116,117,119,120,122,123,125,126,128,129,131,132,134,135,137,138,140,141,143,144,146,147,149,150,152,153,155,156,158,159,161,162,164,165,167,168,170,171,173,174,176,177,179,180,182,183,185,186,188,189,191,192,194,195,197,198,200,201,203,204,206,207,209,210,212,213,215,216,218,219,221,222,224,225,227,228,230,231,233,234,236,237,239,240,242,243,245,246,248,249,251,252,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
0041F7r 1  06 08 09 0B  
0041FBr 1  0C 0E 0F 11  
0042F3r 1               BUFFER_A_OFFSETS_HIGH: ; 128 bytes
0042F3r 1  18 18 19 19  .byte 24,24,25,25,26,27,27,28,29,29,30,30,31,32,32,33,34,34,35,35,36,37,37,38,39,39,40,40,41,42,42,43,44,44,45,45,46,47,47,48,49,49,50,50,51,52,52,53,54,54,55,55,56,57,57,58,59,59,60,60,61,62,62,63,64,64,65,65,66,67,67,68,69,69,70,70,71,72,72,73,74,74,75,75,76,77,77,78,79,79,80,80,81,82,82,83,84,84,85,85,86,87,87,88,89,89,90,90,91,92,92,93,94,94,95,95,96,97,97,98,99,99,100,100,101,102,102,103
0042F7r 1  1A 1B 1B 1C  
0042FBr 1  1D 1D 1E 1E  
004373r 1               
004373r 1               BITMAP_OFFSETS_LOW: ; 128 bytes
004373r 1  00 A0 40 E0  .byte 0,160,64,224,128,32,192,96,0,160,64,224,128,32,192,96,0,160,64,224,128,32,192,96,0,160,64,224,128,32,192,96,0,160,64,224,128,32,192,96,0,160,64,224,128,32,192,96,0,160,64,224,128,32,192,96,0,160,64,224,128,32,192,96,0,160,64,224,128,32,192,96,0,160,64,224,128,32,192,96,0,160,64,224,128,32,192,96,0,160,64,224,128,32,192,96,0,160,64,224,128,32,192,96,0,160,64,224,128,32,192,96,0,160,64,224,128,32,192,96,0,160,64,224,128,32,192,96
004377r 1  80 20 C0 60  
00437Br 1  00 A0 40 E0  
0043F3r 1               
0043F3r 1               BUFFER_B_OFFSETS_HIGH: ; 128 bytes
0043F3r 1  80 80 81 81  .byte 128,128,129,129,130,131,131,132,133,133,134,134,135,136,136,137,138,138,139,139,140,141,141,142,143,143,144,144,145,146,146,147,148,148,149,149,150,151,151,152,153,153,154,154,155,156,156,157,158,158,159,159,160,161,161,162,163,163,164,164,165,166,166,167,168,168,169,169,170,171,171,172,173,173,174,174,175,176,176,177,178,178,179,179,180,181,181,182,183,183,184,184,185,186,186,187,188,188,189,189,190,191,191,192,193,193,194,194,195,196,196,197,198,198,199,199,200,201,201,202,203,203,204,204,205,206,206,207
0043F7r 1  82 83 83 84  
0043FBr 1  85 85 86 86  
004473r 1               
004473r 1               
004473r 1               
004473r 1               ;constants
004473r 1               ;--------------------------------
004473r 1               
004473r 1               ; RAM Interrupt Vectors
004473r 1               IRQVec            = $0314
004473r 1               
004473r 1               ; VERA
004473r 1               VERA_addr_low     = $9F20
004473r 1               VERA_addr_high    = $9F21
004473r 1               VERA_addr_bank    = $9F22
004473r 1               VERA_data0        = $9F23
004473r 1               VERA_data1        = $9F24
004473r 1               VERA_ctrl         = $9F25
004473r 1               VERA_ien          = $9F26
004473r 1               VERA_isr          = $9F27
004473r 1               VERA_dc_video     = $9F29 ; DCSEL = 0
004473r 1               FX_CTRL           = $9F29 ; DCSEL = 2
004473r 1               FX_MULT           = $9F2C ; DCSEL = 2
004473r 1               FX_CACHE_L        = $9F29 ; DCSEL = 6
004473r 1               FX_CACHE_M        = $9F2A
004473r 1               FX_CACHE_H        = $9F2B
004473r 1               FX_CACHE_U        = $9F2C
004473r 1               ;   Current Field | Sprites Enable | Layer1 Enable  |Layer0 Enable
004473r 1               ; NTSC/RGB: 240P  | NTSC: Chroma Disable / RGB: HV Sync Output Mode
004473r 1               
004473r 1               VERA_dc_hscale    = $9F2A
004473r 1               VERA_dc_vscale    = $9F2B
004473r 1               
004473r 1               VERA_L0_config    = $9F2D
004473r 1               ;   7       6     5   4       3       2             1   0
004473r 1               ;   Map Height | Map Width | T256C | Bitmap Mode | Color Depth
004473r 1               ;   0 - 32                  0 - 16    0 tiled       0   1bpp mono
004473r 1               ;   1 - 64                  1 - 256   1 enabled     1   2bpp 4 color
004473r 1               ;   2 - 128                                         2   4bpp 16 color
004473r 1               ;   3 - 256                                         3   8bpp 256 color
004473r 1               ;   bitmap mode - tilebase points to bitmap data, mapbase not used
004473r 1               ;   tile width = 0 is 320 pixels / tile width=1 is 640 pixels.. so could do 4bpp x 320?
004473r 1               ;   The palette offset (in 'H-Scroll (11:8)') modifies the color indexes of the bitmap in the same way as in the tile modes.
004473r 1               
004473r 1               VERA_L0_mapbase   = $9F2E
004473r 1               VERA_L0_tilebase  = $9F2F ;   Tile Base Address (16:11) | Tile Height 0-8/1-16 | Tile Width 0-8/1-16
004473r 1               VERA_L0_HSCROLL_L = $9F30 ;  H-Scroll (7:0)
004473r 1               VERA_L0_HSCROLL_H = $9F31 ;  - H-Scroll (11:8)
004473r 1               VERA_L0_VSCROLL_L = $9F32 ;  V-Scroll (7:0)
004473r 1               VERA_L0_VSCROLL_H = $9F33 ;  - V-Scroll (11:8)
004473r 1               
004473r 1               VERA_L1_config    = $9F34
004473r 1               VERA_L1_mapbase   = $9F35
004473r 1               VERA_L1_tilebase  = $9F36
004473r 1               VERA_L1_HSCROLL_L = $9F37 ;  H-Scroll (7:0)
004473r 1               VERA_L1_HSCROLL_H = $9F38 ;  - H-Scroll (11:8)
004473r 1               VERA_L1_VSCROLL_L = $9F39 ;  V-Scroll (7:0)
004473r 1               VERA_L1_VSCROLL_H = $9F3A ;  - V-Scroll (11:8)
004473r 1               
004473r 1               VSYNC_BIT         = $01
004473r 1               
004473r 1               ; VRAM Addresses
004473r 1               ;   Address range Description
004473r 1               ;   $00000 - $1F9BF Video RAM   - 129,424 bytes -> 126K is 129,024 (1F800)
004473r 1               ;   $1F9C0 - $1F9FF PSG registers
004473r 1               ;   $1FA00 - $1FBFF Palette
004473r 1               ;   $1FC00 - $1FFFF Sprite attributes
004473r 1               VRAM_SPRITES =      $00000  ; putting sprite data at start of VRAM for now.. may move later?
004473r 1               VRAM_BITMAP_LAYERA =$11800  ; setting this to 68K ; was starts at 70K ... so up to ~70K for sprites.. not too shabby..
004473r 1               VRAM_BITMAP_LAYERB =$18000  ; ~25K needs to start at 2K boundary... 121.5-25= 96k
004473r 1               VRAM_TEXT_SCREEN =  $1E400  ; 121.5K    256 x 21 => 32 x 24 would take 1.5K tiles is min.. 64*32 = 2K 8 config..
004473r 1               VRAM_SPRITE_BUF =   $1EC00  ; 123K - sprite attribute buffer for swapping data in ..
004473r 1               VRAM_CHARSET =      $1F000  ;  $1:F000-$1:F7FF Charset loaded by kernal here .. is at 124K ..
004473r 1               ; only can go to 126K ...
004473r 1               VRAM_palette      = $1FA00      ;
004473r 1               VRAM_sprite_attributes = $1FC00
004473r 1               
004473r 1               SPRITES_ONLY_VGA = $41
004473r 1               SPRITES_LAYER1_LAYER0_VGA = $71
004473r 1               
004473r 1               
004473r 1               ; Kernal
004473r 1               CHROUT            = $FFD2
004473r 1               GETIN             = $FFE4
004473r 1               CINT              = $FF81
004473r 1               
004473r 1               
004473r 1               ; PETSCII Codes
004473r 1               WHITE             = $05
004473r 1               RETURN            = $0D
004473r 1               SPACE             = $20
004473r 1               ZERO_CHAR         = $30
004473r 1               ONE_CHAR          = $31
004473r 1               TWO_CHAR          = $32
004473r 1               THREE_CHAR        = $33
004473r 1               FOUR_CHAR         = $34
004473r 1               FIVE_CHAR         = $35
004473r 1               SIX_CHAR          = $36
004473r 1               SEVEN_CHAR        = $37
004473r 1               EIGHT_CHAR        = $38
004473r 1               NINE_CHAR         = $39
004473r 1               
004473r 1               A_CHAR            = $41
004473r 1               C_CHAR            = $43
004473r 1               D_CHAR            = $44
004473r 1               E_CHAR            = $45
004473r 1               I_CHAR            = $49
004473r 1               J_CHAR            = $4A
004473r 1               K_CHAR            = $4B
004473r 1               L_CHAR            = $4C
004473r 1               O_CHAR            = $4F
004473r 1               T_CHAR            = $54
004473r 1               W_CHAR            = $57
004473r 1               X_CHAR            = $58
004473r 1               Y_CHAR            = $59
004473r 1               Z_CHAR            = $5A
004473r 1               
004473r 1               CLR               = $93
004473r 1               
004473r 1               ; 	$0800-$9EFF	BASIC program/variables; available to the user
004473r 1               WORLD_DATA = $6000 	;	so is %100 [Y 5 bits ] : [ab] 0 [X - 6 bits
004473r 1               SCREEN_buffer = $8000
004473r 1               
004473r 1               ; zero page layout $0022-$007F is available to user
004473r 1               ZP_PTR = $22
004473r 1               SCRATCH_PTR = $7E
004473r 1               
004473r 1               SPRITE_SIZE_ORA = $D0 ; $D0 for 16x64, $50 for 16x16
004473r 1               
004473r 1               diff_sprite_to_transparent = 15
004473r 1               
004473r 1               SCREEN_OUT_RIGHT  = 160 ; right of middle is 116, +48 = 164
004473r 1               SCREEN_OUT_LEFT8    = 256-8
004473r 1               SCREEN_OUT_LEFT16   = 256-16  ; left of middle is 100, -48=52-16=36
004473r 1               SCREEN_OUT_LEFT32   = 256-32  ; left of middle is 100, -48=52-16=36
004473r 1               SCREEN_OUT_LEFT64   = 256-64  ; left of middle is 100, -48=52-16=36
004473r 1               SCREEN_OUT_TOP     = 240
004473r 1               SCREEN_OUT_BOTTOM  = 120
004473r 1               
004473r 1               ; global data ; 2E00
004473r 1  00 00        default_irq_vector:  .addr 0 ; 4-5
004475r 1               ; current cell values in neighborhood...
004475r 1  FF           CELL_VAL_UPLEFT:  .byte 255
004476r 1  FF           CELL_VAL_UPRIGHT: .byte 255
004477r 1  FF           CELL_VAL_LEFT:    .byte 255
004478r 1  FF           CELL_VAL_SELF:    .byte 255
004479r 1  FF           CELL_VAL_RIGHT:   .byte 255
00447Ar 1  FF           CELL_VAL_DOWNLEFT: .byte 255
00447Br 1  FF           CELL_VAL_DOWNRIGHT: .byte 255
00447Cr 1               
00447Cr 1  DE AD BE EF  GLOBAL_DATA:         .byte $DE,$AD,$BE,$EF ; 0-1
004480r 1               ;line 0
004480r 1  00 00        MASTER_CLOCK:        .addr 0 ; 6-7
004482r 1  00           .byte 0
004483r 1  00           STATUS:              .byte 0
004484r 1               ;line 1
004484r 1  00           .byte 0
004485r 1  01           VSYNC_counter:       .byte 1 ; 8
004486r 1  00           STALL_COUNTERH:      .byte 0
004487r 1  00           STALL_COUNTER:       .byte 0
004488r 1               ;line 2
004488r 1  00           .byte 0
004489r 1  00           LAST_VSYNC_COUNTER:  .byte 0
00448Ar 1  00           LAST_STALLCOUNTERH:  .byte 0
00448Br 1  00           LAST_STALLCOUNTER:   .byte 0
00448Cr 1               ; line 3
00448Cr 1  FF           VERA_LOCK:           .byte 255 ; 9 value written to screen is value at time DEBUG_WRITE
00448Dr 1  50           IRQ_VERA_LOCK:       .byte 80 ; value of VERA_LOCK when reached the Interrupt
00448Er 1  40           CURRENT_BITMAP_BUFFER: .byte 64 ;
00448Fr 1               ;        A        B     CURRENT BITMAP BUFFER
00448Fr 1               ;   0   display  dirty    A is being displayed, B to be drawn on
00448Fr 1               ;  64   display  ready    B  is ready for swap
00448Fr 1               ; 128   dirty    display  B is being displayed, A to be drawn on
00448Fr 1               ; 192   ready    display  A  is ready for swap
00448Fr 1  00           LAST_BITMAP_BUFFER:    .byte 0 ;
004490r 1               
004490r 1               ; line 4
004490r 1  01           camera_facing: 		 .byte 1 ; 7
004491r 1  00           .byte 0
004492r 1  00           CAMERA_CENTER_XH:    .byte 0 ; 13
004493r 1  00           CAMERA_CENTER_YH:    .byte 0 ; 15
004494r 1               ; line 5
004494r 1  00           camera_cell_x: 		 .byte 0 ; c
004495r 1  00           camera_cell_xl:       .byte 0 ; d
004496r 1  00           camera_cell_y: 		 .byte 0 ; e
004497r 1  00           camera_cell_yl:       .byte 0 ; f
004498r 1               ; line 6
004498r 1  2C           camera_world_pos_XH:    .byte 44 ; 8
004499r 1  30           camera_world_pos_XL:       .byte 48 ; 9
00449Ar 1  0F           camera_world_pos_YH:        .byte 15 ; A
00449Br 1  80           camera_world_pos_YL:       .byte 128  ; B
00449Cr 1               ; line 7
00449Cr 1  00           DO_WATER:   .byte 0 ;
00449Dr 1  00           DO_FAUCET:  .byte 0 ;
00449Er 1               ; line 8
00449Er 1  80           NUM_AVAIL_SPRITES:   .byte 128 ; A
00449Fr 1  00           NUM_RESERVED_SPRITES:    .byte  0;(1+NUM_RESERVED_SPRITES-MASTER_CLOCK) << 1 ; F
0044A0r 1  FF           SPRITE_OBJECT_ENABLE: .byte 255 ;255 ;
0044A1r 1               
0044A1r 1  00           CAMERA_CENTER_XL:    .byte 0 ; 12
0044A2r 1  00           CAMERA_CENTER_YL:    .byte 0 ; 14
0044A3r 1  00           CAMERA_CENTER_TOP_PX: .byte 0 ; 16
0044A4r 1  00 00        CAMERA_CELL_LINE_PTR: .addr 0 ; 17-18
0044A6r 1  00           WORLD_SPRITE_NUM:    .byte 0 ; 1B
0044A7r 1  00           WORLD_WALL_SPRITE_NUM: .byte 0; 1C
0044A8r 1  FF           BUFFER_A_DIRTY:        .byte 255 ;
0044A9r 1  FF           BUFFER_B_DIRTY:        .byte 255 ;
0044AAr 1               
0044AAr 1  F0           camera_screen_out_top: .byte SCREEN_OUT_TOP       ; for determining visibility / stop conditions for checking if within range to view..
0044ABr 1  78           camera_screen_out_bottom: .byte SCREEN_OUT_BOTTOM
0044ACr 1               
0044ACr 1               ENDGLOBALS:
0044ACr 1               
0044ACr 1               .macro stash_scratch
0044ACr 1               	STA (SCRATCH_PTR)
0044ACr 1                   INC SCRATCH_PTR
0044ACr 1               .endmacro
0044ACr 1               
0044ACr 1               custom_irq_handler: ; 2E12
0044ACr 1  AD 27 9F        lda VERA_isr
0044AFr 1  29 01           and #VSYNC_BIT
0044B1r 1  F0 11           BEQ :++
0044B3r 1                  ;  for debug ..
0044B3r 1  AD rr rr        LDA VERA_LOCK
0044B6r 1  8D rr rr        STA IRQ_VERA_LOCK
0044B9r 1               
0044B9r 1  EE rr rr        INC VSYNC_counter
0044BCr 1               
0044BCr 1  EE rr rr        INC VERA_LOCK
0044BFr 1  F0 06           BEQ :+++  ; @unlock_vera ; if we don't have lock we'll just fail this frame..
0044C1r 1                @NOP_nothing_to_do:
0044C1r 1  CE rr rr      : DEC VERA_LOCK
0044C4r 1  6C rr rr      : jmp (default_irq_vector)
0044C7r 1               
0044C7r 1  AD rr rr      : LDA CURRENT_BITMAP_BUFFER
0044CAr 1  4D rr rr        EOR LAST_BITMAP_BUFFER
0044CDr 1  F0 F2           BEQ :--- ; if these match then there's nothing to change
0044CFr 1  18              CLC
0044D0r 1  AD rr rr        LDA CURRENT_BITMAP_BUFFER
0044D3r 1  8D rr rr        STA LAST_BITMAP_BUFFER
0044D6r 1               ;        A        B     CURRENT BITMAP BUFFER
0044D6r 1               ;   0   display  dirty    A is being displayed, B to be drawn on
0044D6r 1               ;  64   display  ready    B  is ready for swap
0044D6r 1               ; 128   dirty    display  B is being displayed, A to be drawn on
0044D6r 1               ; 192   ready    display  A  is ready for swap
0044D6r 1  30 0B           BMI @DISPLAY_B
0044D8r 1               @DISPLAY_A:
0044D8r 1  F0 E7           BEQ @NOP_nothing_to_do ;
0044DAr 1  A9 80           LDA #128
0044DCr 1  8D rr rr        STA CURRENT_BITMAP_BUFFER
0044DFr 1  A9 C0           LDA #VRAM_BITMAP_LAYERB>>9
0044E1r 1  80 09           BRA @GO_SWAP
0044E3r 1               @DISPLAY_B:
0044E3r 1  C9 C0           CMP #192
0044E5r 1  90 DA           BCC @NOP_nothing_to_do
0044E7r 1  9C rr rr        STZ CURRENT_BITMAP_BUFFER
0044EAr 1  A9 8C           LDA #VRAM_BITMAP_LAYERA>>9
0044ECr 1               @GO_SWAP:
0044ECr 1  8D 2F 9F        STA VERA_L0_tilebase
0044EFr 1               
0044EFr 1  A9 01           LDA #$01
0044F1r 1  8D 25 9F        STA VERA_ctrl
0044F4r 1               
0044F4r 1  A2 FF           LDX #$FF
0044F6r 1  8E 20 9F        STX VERA_addr_low
0044F9r 1  8E 21 9F        STX VERA_addr_high
0044FCr 1  A9 19           LDA #$19
0044FEr 1  8D 22 9F        STA VERA_addr_bank
004501r 1               
004501r 1  9C 25 9F        STZ VERA_ctrl  ;  reset to address 0
004504r 1  8D 22 9F        STA VERA_addr_bank
004507r 1               
004507r 1  A9 EF           LDA #$EF
004509r 1  8D 21 9F        STA VERA_addr_high
00450Cr 1  8E 20 9F        STX VERA_addr_low
00450Fr 1               
00450Fr 1  AE rr rr        LDX NUM_AVAIL_SPRITES
004512r 1  AD 23 9F      : LDA VERA_data0   ;  4
004515r 1  8D 24 9F        STA VERA_data1   ;  4  20
004518r 1  AD 23 9F        LDA VERA_data0   ;  4  8
00451Br 1  8D 24 9F        STA VERA_data1   ;  4  20
00451Er 1  AD 23 9F        LDA VERA_data0   ;  4  12
004521r 1  8D 24 9F        STA VERA_data1   ;  4  20
004524r 1  AD 23 9F        LDA VERA_data0   ;  4  16
004527r 1  8D 24 9F        STA VERA_data1   ;  4  20
00452Ar 1  AD 23 9F        LDA VERA_data0   ;  4
00452Dr 1  8D 24 9F        STA VERA_data1   ;  4  20
004530r 1  AD 23 9F        LDA VERA_data0   ;  4  8
004533r 1  8D 24 9F        STA VERA_data1   ;  4  20
004536r 1  AD 23 9F        LDA VERA_data0   ;  4  12
004539r 1  8D 24 9F        STA VERA_data1   ;  4  20
00453Cr 1  AD 23 9F        LDA VERA_data0   ;  4  16
00453Fr 1  8D 24 9F        STA VERA_data1   ;  4  20
004542r 1  CA              DEX         ;  2  22
004543r 1  D0 CD           BNE :-      ;  3  25       8per byte = 64 per sprite + 5 = 69 per * 128 = 8,832 cycles
004545r 1               
004545r 1  6C rr rr        jmp (default_irq_vector)
004548r 1                  ; RTI will happen after jump
004548r 1               
004548r 1               DO_WAVES:
004548r 1  64 22          STZ ZP_PTR
00454Ar 1  A9 rr          LDA #>TUB_WORLD
00454Cr 1  85 23          STA ZP_PTR+1
00454Er 1  A0 40          LDY #64
004550r 1  A2 08          LDX #8
004552r 1                 ; try to add 2
004552r 1  B1 22          : LDA (ZP_PTR),y ; grab world data
004554r 1  C9 80            CMP #128
004556r 1  B0 0A            BCS :++         ; need skip this one
004558r 1  C9 04            CMP #4        ; OK is this low or high to alter?
00455Ar 1  90 02            BCC :+         ; if low increase.. OK
00455Cr 1  E9 03            SBC #3
00455Er 1  69 01          : ADC #1
004560r 1  91 22            STA (ZP_PTR),y
004562r 1  C8             : INY
004563r 1  D0 ED            BNE :---
004565r 1  E6 23            INC ZP_PTR+1
004567r 1  CA               DEX
004568r 1  D0 E8            BNE :---
00456Ar 1  60               rts
00456Br 1               
00456Br 1               start:
00456Br 1                 ; start of program - init globals
00456Br 1  AD 14 03       lda IRQVec
00456Er 1  8D rr rr       sta default_irq_vector
004571r 1  AD 15 03       lda IRQVec+1
004574r 1  8D rr rr       sta default_irq_vector+1
004577r 1               
004577r 1  9C 29 9F       stz VERA_dc_video   ; disable display
00457Ar 1  A9 33          lda #51 ; #43 ; set scale for bitmap mode - going for 215x161 mode
00457Cr 1  8D 2A 9F       sta VERA_dc_hscale
00457Fr 1  8D 2B 9F       sta VERA_dc_vscale
004582r 1                 ; for now no L0 or L1
004582r 1               
004582r 1                 ; let's stick that test sprite data into VRAM at zero for now..
004582r 1  9C 25 9F       stz VERA_ctrl
004585r 1  9C 20 9F       stz VERA_addr_low
004588r 1  9C 21 9F       stz VERA_addr_high
00458Br 1  A9 10          lda #$10
00458Dr 1  8D 22 9F       sta VERA_addr_bank
004590r 1                 ; load test VRAM data
004590r 1               
004590r 1                 ; is 512 bytes at test_cell_sprite label
004590r 1  A0 00          ldy #0
004592r 1               
004592r 1  A9 rr          LDA #<test_vram_data
004594r 1  85 22          STA ZP_PTR
004596r 1  A9 rr          LDA #>test_vram_data
004598r 1  85 23          STA ZP_PTR+1
00459Ar 1  A2 30          LDX #48   ;   num pages to copy - 16 pages / 8K  - sprite addr 0-255
00459Cr 1  80 02          BRA :++
00459Er 1                 :
00459Er 1  E6 23             INC ZP_PTR+1
0045A0r 1                   :
0045A0r 1  B1 22              LDA (ZP_PTR),Y
0045A2r 1  8D 23 9F           STA VERA_data0
0045A5r 1  C8                 INY
0045A6r 1  D0 F8              BNE :-
0045A8r 1  CA                DEX
0045A9r 1  D0 F3             BNE :--
0045ABr 1               
0045ABr 1                 ; initialize some waves
0045ABr 1                 ; write custom palette data  - 16 colors only for now.. $1:FA00-$1:FBFF   VERA Color Palette (256 x 2 bytes)
0045ABr 1  A9 01          LDA #1
0045ADr 1  8D 25 9F       STA VERA_ctrl
0045B0r 1  A9 3F          LDA #63
0045B2r 1  8D 20 9F       STA VERA_addr_low
0045B5r 1  A9 FA          LDA #$FA
0045B7r 1  8D 21 9F       STA VERA_addr_high
0045BAr 1  A9 19          LDA #$19
0045BCr 1  8D 22 9F       STA VERA_addr_bank
0045BFr 1  9C 25 9F       STZ VERA_ctrl
0045C2r 1  A2 1F          LDX #31
0045C4r 1  8E 20 9F       STX VERA_addr_low
0045C7r 1  A9 FA          LDA #$FA
0045C9r 1  8D 21 9F       STA VERA_addr_high
0045CCr 1  A9 19          LDA #$19
0045CEr 1  8D 22 9F       STA VERA_addr_bank
0045D1r 1                 :
0045D1r 1  BD rr rr         LDA test_optimal_pal_data,X
0045D4r 1  8D 23 9F         STA VERA_data0
0045D7r 1  49 FF            EOR #$FF
0045D9r 1  8D 24 9F         STA VERA_data1
0045DCr 1  CA               DEX
0045DDr 1  D0 F2            BNE :-
0045DFr 1  BD rr rr       LDA test_optimal_pal_data,X
0045E2r 1  8D 23 9F       STA VERA_data0
0045E5r 1               
0045E5r 1  A9 08          LDA #8
0045E7r 1  9C 34 9F       STz VERA_L1_config
0045EAr 1  A9 F8          LDA #VRAM_CHARSET >> 9
0045ECr 1  8D 36 9F       STA VERA_L1_tilebase
0045EFr 1  A9 F2          LDA #VRAM_TEXT_SCREEN >> 9
0045F1r 1  8D 35 9F       STA VERA_L1_mapbase
0045F4r 1               
0045F4r 1  9C 20 9F       STZ VERA_addr_low
0045F7r 1  A9 18          LDA #>VRAM_BITMAP_LAYERA
0045F9r 1  8D 21 9F       STA VERA_addr_high
0045FCr 1  A9 11          LDA #$11
0045FEr 1  8D 22 9F       STA VERA_addr_bank
004601r 1  A2 67          LDX #103  ;  zero bufferA
004603r 1  A0 00          LDY #0
004605r 1  9C 23 9F     : STZ VERA_data0
004608r 1  C8             INY
004609r 1  D0 FA          BNE :-
00460Br 1  CA             DEX
00460Cr 1  D0 F7          BNE :-
00460Er 1  A2 65          LDX #101  ;  write A to bufferB initially as debug / flashing display when swapped..
004610r 1                 ;LDA #255
004610r 1  9C 23 9F     : STZ VERA_data0
004613r 1  C8             INY
004614r 1  D0 FA          BNE :-
004616r 1  CA             DEX
004617r 1  D0 F7          BNE :-
004619r 1               
004619r 1  9C 23 9F       STZ VERA_data0
00461Cr 1  A9 21          LDA #$21
00461Er 1  8D 22 9F       STA VERA_addr_bank
004621r 1               
004621r 1  A2 0F          LDX #15
004623r 1  A0 14        : LDY #20
004625r 1  A9 01          LDA #$01
004627r 1               
004627r 1  8D 23 9F       : STA VERA_data0
00462Ar 1  88               DEY
00462Br 1  D0 FA            BNE :-
00462Dr 1  A0 F1            LDY #$F1
00462Fr 1  8C 23 9F         STY VERA_data0 ; cols 20-23
004632r 1  8C 23 9F         STY VERA_data0
004635r 1  8C 23 9F         STY VERA_data0
004638r 1  8C 23 9F         STY VERA_data0
00463Br 1               
00463Br 1  8C 23 9F         STY VERA_data0 ; cols 24-27
00463Er 1  8C 23 9F         STY VERA_data0
004641r 1  8C 23 9F         STY VERA_data0
004644r 1  8C 23 9F         STY VERA_data0
004647r 1               
004647r 1  8C 23 9F         STY VERA_data0 ; cols 28-31
00464Ar 1  8C 23 9F         STY VERA_data0
00464Dr 1  8C 23 9F         STY VERA_data0
004650r 1  8C 23 9F         STY VERA_data0
004653r 1  CA              DEX
004654r 1  D0 CD           BNE :--
004656r 1  A2 A0          LDX #160
004658r 1  8C 23 9F       : STY VERA_data0
00465Br 1  8C 23 9F         STY VERA_data0
00465Er 1  CA               DEX
00465Fr 1  D0 F7            BNE :-
004661r 1               ;  LDA #4
004661r 1               ;  STA VERA_L1_HSCROLL_L
004661r 1               ;  STA VERA_L1_VSCROLL_L
004661r 1               
004661r 1  9C 20 9F       STZ VERA_addr_low
004664r 1  A9 E4          LDA #>VRAM_TEXT_SCREEN
004666r 1  8D 21 9F       STA VERA_addr_high
004669r 1  A2 04          LDX #4
00466Br 1  A9 20          LDA #32
00466Dr 1  8D 23 9F     : STA VERA_data0
004670r 1  C8             INY
004671r 1  D0 FA          BNE :-
004673r 1  CA             DEX
004674r 1  D0 F7          BNE :-
004676r 1               
004676r 1  A9 06          LDA #$06
004678r 1  8D 2D 9F       STA VERA_L0_config
00467Br 1  A9 01          LDA #$01 ; set L0 to palette offset 1 for now, to see where stuff is.
00467Dr 1  8D 31 9F       STA VERA_L0_HSCROLL_H
004680r 1  A9 8C          LDA #(VRAM_BITMAP_LAYERA>>9)
004682r 1               
004682r 1               ;  LDA #VRAM_BITMAP_LAYERB>>9
004682r 1  8D 2F 9F       STA VERA_L0_tilebase
004685r 1               
004685r 1  A9 06          LDA #6
004687r 1  8D 20 9F       STA VERA_addr_low
00468Ar 1  A9 EC          LDA #>VRAM_SPRITE_BUF
00468Cr 1  8D 21 9F       STA VERA_addr_high
00468Fr 1  A9 41          LDA #$41
004691r 1  8D 22 9F       STA VERA_addr_bank
004694r 1  9C 23 9F       : STZ VERA_data0
004697r 1  E8               INX
004698r 1  D0 FA            BNE :-
00469Ar 1                 ; enable display
00469Ar 1  9C 25 9F       stz VERA_ctrl
00469Dr 1  A9 71          lda #SPRITES_LAYER1_LAYER0_VGA ; #SPRITES_ONLY_VGA
00469Fr 1  8D 29 9F       sta VERA_dc_video
0046A2r 1               
0046A2r 1               ;  DEC VERA_LOCK ; unlock the vera for first go...
0046A2r 1               ;   BRA @camera_world_changed
0046A2r 1                 ; overwrite RAM IRQ vector with custom handler address
0046A2r 1  78             sei ; disable IRQ while vector is changing
0046A3r 1  A9 rr          lda #<custom_irq_handler
0046A5r 1  8D 14 03       sta IRQVec
0046A8r 1  A9 rr          lda #>custom_irq_handler
0046AAr 1  8D 15 03       sta IRQVec+1
0046ADr 1  A9 01          lda #VSYNC_BIT ; make VERA only generate VSYNC IRQs
0046AFr 1  8D 26 9F       sta VERA_ien
0046B2r 1  58             cli ; enable IRQ now that vector is properly set
0046B3r 1               
0046B3r 1               
0046B3r 1                 ; main loop here...
0046B3r 1  9C rr rr        STZ camera_facing
0046B6r 1               
0046B6r 1               @camera_world_changed:
0046B6r 1                  ; copy over cell YL as-is
0046B6r 1  AD rr rr        LDA camera_world_pos_YL
0046B9r 1  8D rr rr        STA camera_cell_yl
0046BCr 1                  ; YH gets copied over ..
0046BCr 1  AD rr rr        LDA camera_world_pos_YH
0046BFr 1  8D rr rr        STA camera_cell_y
0046C2r 1                  ; cellX = WORLDX*ratio - floor(cellY)/2
0046C2r 1                  ;  halve floor(cellY)
0046C2r 1  4A              LSR
0046C3r 1  85 7F           STA $7F ; stash it for scratch
0046C5r 1  A9 00           LDA #0
0046C7r 1  6A              ROR
0046C8r 1  85 7E           STA $7E ; and there's the half..
0046CAr 1               
0046CAr 1  AE rr rr        LDX camera_world_pos_XH
0046CDr 1  AC rr rr        LDY camera_world_pos_XL
0046D0r 1  18              CLC
0046D1r 1  B9 rr rr        LDA WORLD_TO_CELL_XH,Y ; that bit from pos_XL
0046D4r 1  7D rr rr        ADC WORLD_TO_CELL_XL,X ; plus the bit from pos_XH
0046D7r 1  A8              TAY   ;  cellXL from ratio
0046D8r 1  BD rr rr        LDA WORLD_TO_CELL_XH,X
0046DBr 1  69 00           ADC #0 ; gotta do that carry and all ..
0046DDr 1  AA              TAX   ; cellXH from ratio
0046DEr 1               
0046DEr 1  98              TYA
0046DFr 1  38              SEC
0046E0r 1  E5 7E           SBC $7E
0046E2r 1  8D rr rr        STA camera_cell_xl
0046E5r 1  8A              TXA
0046E6r 1  E5 7F           SBC $7F
0046E8r 1  8D rr rr        STA camera_cell_x
0046EBr 1  4C rr rr        jmp @do_update
0046EEr 1               
0046EEr 1               @camera_cell_changed: ; run through this more as a normalization step for camera..
0046EEr 1                  ; worldX = scaled(floor(cellY)/2 + cellX )
0046EEr 1  AD rr rr        LDA camera_cell_yl
0046F1r 1  8D rr rr        STA camera_world_pos_YL
0046F4r 1  AD rr rr        LDA camera_cell_y
0046F7r 1  8D rr rr        STA camera_world_pos_YH
0046FAr 1  4A              LSR
0046FBr 1  AA              TAX  ; high byte floor(Y)/2
0046FCr 1  A9 00           LDA #0
0046FEr 1  6A              ROR ; either is zero or 128 now ... either way, carry is cleared.
0046FFr 1  6D rr rr        ADC camera_cell_xl
004702r 1  A8              TAY ; stash the low to byte
004703r 1  8A              TXA ; high byte floor (Y)/2 .. ready for adding
004704r 1  6D rr rr        ADC camera_cell_x
004707r 1  AA              TAX ; stash high byte ... carry _should_ be cleared unless X >255 ... ?
004708r 1  B9 rr rr        LDA CELL_LOW_TO_WORLD_XL,Y
00470Br 1  7D rr rr        ADC CELL_TO_WORLD_XL,X
00470Er 1  8D rr rr        STA camera_world_pos_XL
004711r 1  B9 rr rr        LDA CELL_LOW_TO_WORLD_XH,Y
004714r 1  7D rr rr        ADC CELL_TO_WORLD_XH,X
004717r 1  8D rr rr        STA camera_world_pos_XH
00471Ar 1                  ;  jmp @do_update ; superfluous currently. redundant even..
00471Ar 1               
00471Ar 1               
00471Ar 1               @do_update:
00471Ar 1               
00471Ar 1                  ;  set up screen center stuff
00471Ar 1               
00471Ar 1               
00471Ar 1  AD rr rr        LDA camera_facing
00471Dr 1  29 7F           AND #127
00471Fr 1  AA              TAX
004720r 1  BD rr rr        LDA WORLD_SPRITE_NUM_lookies,X
004723r 1  8D rr rr        STA WORLD_SPRITE_NUM
004726r 1  BD rr rr        LDA WORLD_WALL_SPRITE_NUM_lookies,X
004729r 1  8D rr rr        STA WORLD_WALL_SPRITE_NUM
00472Cr 1               
00472Cr 1  38              SEC
00472Dr 1  BD rr rr        LDA WORLD_SPRITE_CENTER_XL,X
004730r 1  8D rr rr        STA CAMERA_CENTER_XL
004733r 1  BD rr rr        LDA WORLD_SPRITE_CENTER_XH,X
004736r 1  E9 1C           SBC #28
004738r 1  8D rr rr        STA CAMERA_CENTER_XH
00473Br 1               
00473Br 1  BD rr rr        LDA WORLD_SPRITE_CENTER_YL,X
00473Er 1  8D rr rr        STA CAMERA_CENTER_YL
004741r 1  38              SEC
004742r 1  BD rr rr        LDA WORLD_SPRITE_CENTER_YH,X
004745r 1  E9 14           SBC #20
004747r 1  8D rr rr        STA CAMERA_CENTER_TOP_PX
00474Ar 1               
00474Ar 1  AE rr rr         LDX camera_facing
00474Dr 1               
00474Dr 1  AD rr rr         LDA camera_cell_xl
004750r 1  4A               LSR ;   /2
004751r 1  4A               LSR ;   /4
004752r 1  4A               LSR ;   /8
004753r 1  4A               LSR ;   /16
004754r 1  38               SEC
004755r 1  E9 08            SBC #8 ;   subtract le middle..
004757r 1  A8               TAY
004758r 1  B0 29            BCS :++    ;  is positive..
00475Ar 1  18             : CLC
00475Br 1  AD rr rr         LDA CAMERA_CENTER_XL
00475Er 1  7D rr rr         ADC SUBCELL_X_COS_L,X
004761r 1  8D rr rr         STA CAMERA_CENTER_XL
004764r 1  AD rr rr         LDA CAMERA_CENTER_XH
004767r 1  7D rr rr         ADC SUBCELL_X_COS_H,X
00476Ar 1  8D rr rr         STA CAMERA_CENTER_XH
00476Dr 1  38               SEC
00476Er 1  AD rr rr         LDA CAMERA_CENTER_YL
004771r 1  FD rr rr         SBC SUBCELL_Y_SIN_L,X
004774r 1  8D rr rr         STA CAMERA_CENTER_YL
004777r 1  AD rr rr         LDA CAMERA_CENTER_TOP_PX
00477Ar 1  FD rr rr         SBC SUBCELL_Y_SIN_H,X
00477Dr 1  8D rr rr         STA CAMERA_CENTER_TOP_PX
004780r 1  C8               INY
004781r 1  D0 D7            BNE :-
004783r 1  F0 29          : BEQ :++
004785r 1  38             : SEC
004786r 1  AD rr rr         LDA CAMERA_CENTER_XL
004789r 1  FD rr rr         SBC SUBCELL_X_COS_L,X
00478Cr 1  8D rr rr         STA CAMERA_CENTER_XL
00478Fr 1  AD rr rr         LDA CAMERA_CENTER_XH
004792r 1  FD rr rr         SBC SUBCELL_X_COS_H,X
004795r 1  8D rr rr         STA CAMERA_CENTER_XH
004798r 1  18               CLC
004799r 1  AD rr rr         LDA CAMERA_CENTER_YL
00479Cr 1  7D rr rr         ADC SUBCELL_Y_SIN_L,X
00479Fr 1  8D rr rr         STA CAMERA_CENTER_YL
0047A2r 1  AD rr rr         LDA CAMERA_CENTER_TOP_PX
0047A5r 1  7D rr rr         ADC SUBCELL_Y_SIN_H,X
0047A8r 1  8D rr rr         STA CAMERA_CENTER_TOP_PX
0047ABr 1  88               DEY
0047ACr 1  D0 D7            BNE :-
0047AEr 1                 :
0047AEr 1               
0047AEr 1  AD rr rr         LDA camera_cell_yl
0047B1r 1  4A               LSR ;   /2
0047B2r 1  4A               LSR ;   /4
0047B3r 1  4A               LSR ;   /8
0047B4r 1  4A               LSR ;   /16
0047B5r 1  38               SEC
0047B6r 1  E9 08            SBC #8 ;   subtract le middle..
0047B8r 1  A8               TAY
0047B9r 1  B0 29            BCS :++    ;  is positive..
0047BBr 1  18             : CLC
0047BCr 1  AD rr rr         LDA CAMERA_CENTER_XL
0047BFr 1  7D rr rr         ADC SUBCELL_X_SIN_L,X
0047C2r 1  8D rr rr         STA CAMERA_CENTER_XL
0047C5r 1  AD rr rr         LDA CAMERA_CENTER_XH
0047C8r 1  7D rr rr         ADC SUBCELL_X_SIN_H,X
0047CBr 1  8D rr rr         STA CAMERA_CENTER_XH
0047CEr 1  18               CLC
0047CFr 1  AD rr rr         LDA CAMERA_CENTER_YL
0047D2r 1  7D rr rr         ADC SUBCELL_Y_COS_L,X
0047D5r 1  8D rr rr         STA CAMERA_CENTER_YL
0047D8r 1  AD rr rr         LDA CAMERA_CENTER_TOP_PX
0047DBr 1  7D rr rr         ADC SUBCELL_Y_COS_H,X
0047DEr 1  8D rr rr         STA CAMERA_CENTER_TOP_PX
0047E1r 1  C8               INY
0047E2r 1  D0 D7            BNE :-
0047E4r 1  F0 29          : BEQ :++
0047E6r 1  38             : SEC
0047E7r 1  AD rr rr         LDA CAMERA_CENTER_XL
0047EAr 1  FD rr rr         SBC SUBCELL_X_SIN_L,X
0047EDr 1  8D rr rr         STA CAMERA_CENTER_XL
0047F0r 1  AD rr rr         LDA CAMERA_CENTER_XH
0047F3r 1  FD rr rr         SBC SUBCELL_X_SIN_H,X
0047F6r 1  8D rr rr         STA CAMERA_CENTER_XH
0047F9r 1               
0047F9r 1  38               SEC
0047FAr 1  AD rr rr         LDA CAMERA_CENTER_YL
0047FDr 1  FD rr rr         SBC SUBCELL_Y_COS_L,X
004800r 1  8D rr rr         STA CAMERA_CENTER_YL
004803r 1  AD rr rr         LDA CAMERA_CENTER_TOP_PX
004806r 1  FD rr rr         SBC SUBCELL_Y_COS_H,X
004809r 1  8D rr rr         STA CAMERA_CENTER_TOP_PX
00480Cr 1  88               DEY
00480Dr 1  D0 D7            BNE :-
00480Fr 1                 :
00480Fr 1               
00480Fr 1                  ;  set up tub pointer .. this will let us grab the height value for current location..
00480Fr 1               
00480Fr 1  64 7C            STZ $7C
004811r 1  AD rr rr         LDA camera_cell_y
004814r 1  4A               LSR  ;  y pages of 128
004815r 1  66 7C            ROR $7C
004817r 1  4A               LSR  ; y pages of 64 !
004818r 1  66 7C            ROR $7C
00481Ar 1  69 rr            ADC #>TUB_WORLD
00481Cr 1  85 7D            STA $7D
00481Er 1  8D rr rr         STA CAMERA_CELL_LINE_PTR+1
004821r 1  A5 7C            LDA $7C
004823r 1  8D rr rr         STA CAMERA_CELL_LINE_PTR
004826r 1               
004826r 1               
004826r 1  AC rr rr         LDY camera_cell_x
004829r 1  B1 7C            LDA ($7C),y
00482Br 1  C9 56            CMP #86 ; is largest value we will allow .. accounts for tub heights..
00482Dr 1  90 02            BCC :+
00482Fr 1  A9 56            LDA #86
004831r 1               
004831r 1                  :
004831r 1  C9 3F             CMP #63
004833r 1  B0 02             BCS :+
004835r 1               ;     INC A;  increase the height of spot we're at by 1...
004835r 1  91 7E             STA ($7E),y
004837r 1  A8              : TAY
004838r 1               
004838r 1  18              CLC
004839r 1  AD rr rr        LDA CAMERA_CENTER_YL
00483Cr 1  79 rr rr        ADC CONVERT_HEIGHTS_PIXELS_L,Y
00483Fr 1  8D rr rr        STA CAMERA_CENTER_YL
004842r 1  AD rr rr        LDA CAMERA_CENTER_TOP_PX
004845r 1  79 rr rr        ADC CONVERT_HEIGHTS_PIXELS,Y
004848r 1  8D rr rr        STA CAMERA_CENTER_YH
00484Br 1               
00484Br 1  18              CLC
00484Cr 1  A9 78           LDA #SCREEN_OUT_BOTTOM
00484Er 1  79 rr rr        ADC CONVERT_HEIGHTS_PIXELS,Y
004851r 1  8D rr rr        STA camera_screen_out_bottom
004854r 1               
004854r 1                  ; if something is higher than us it would be (52-CONVERT_HEIGHTS_PIXELS,Y)
004854r 1                  ; so true effective top of screen check to account for that would be ...
004854r 1                  ; SCREEN_OUT_TOP - (52 - CONVERT_HEIGHTS_PIXELS,Y)
004854r 1                  ; screen out top - 52 + CONVERT_HEIGHTS_PIXELS,Y
004854r 1                  ; ok so if we are as high as we can be, then something at farthest Z visible Z
004854r 1                  ; or s this constant??? should it even be attempted to add to world data?
004854r 1  38              SEC
004855r 1  AD rr rr        LDA CAMERA_CENTER_TOP_PX
004858r 1  E9 80           SBC #16+60+52 ;-16 is top out.. 60 to mid screen, then max diff in height from there.. so if was middle screen 60 now its -68
00485Ar 1  8D rr rr        STA camera_screen_out_top
00485Dr 1               
00485Dr 1                  ; clear the object list ...
00485Dr 1  38               SEC
00485Er 1  A9 80            LDA #128
004860r 1  ED rr rr         SBC NUM_RESERVED_SPRITES
004863r 1  8D rr rr         STA NUM_AVAIL_SPRITES
004866r 1               
004866r 1  9C rr rr         STZ OBJECT_LIST_BYTE6_NEXT ; because we can't use zero anyway..
004869r 1  A9 08            LDA #$08 ; is basis for all the z_flips <- this may change depending on orientation..
00486Br 1  A2 00            LDX #0
00486Dr 1  9E rr rr         : STZ OBJECT_LIST_Z_START_POINTERS,X
004870r 1  9E rr rr           STZ OBJECT_LIST_BYTE1_MODE,X          ; 16 color / low address
004873r 1  9C rr rr           STZ OBJECT_LIST_BYTE2_X
004876r 1  9D rr rr           STA OBJECT_LIST_BYTE4_ZFLIPS,X
004879r 1                     ;STA OBJECT_LIST_BYTE5_SIZE,X ; 01.3456 done .
004879r 1  E8                 INX
00487Ar 1  D0 F1              BNE :-
00487Cr 1               
00487Cr 1  A9 D0            LDA #SPRITE_SIZE_ORA
00487Er 1  9D rr rr         : STA OBJECT_LIST_BYTE5_SIZE,X ; 01.3456 done .
004881r 1  E8                 INX
004882r 1  D0 FA              BNE :-
004884r 1  AD rr rr         LDA WORLD_SPRITE_NUM
004887r 1  9D rr rr         : STA OBJECT_LIST_BYTE0_ADDRLOW,X ; 01.3456 done .
00488Ar 1  E8                 INX
00488Br 1  D0 FA              BNE :-
00488Dr 1               
00488Dr 1  AD rr rr        LDA DO_WATER
004890r 1  F0 2B           BEQ :++
004892r 1               ;   LDA MASTER_CLOCK
004892r 1               ;   AND #1
004892r 1               
004892r 1  AD rr rr        LDA DO_FAUCET
004895r 1  F0 0E           BEQ :+
004897r 1  A9 55           LDA #85
004899r 1                  ; we're going to pretend the faucet is running...
004899r 1  8D rr rr        STA TUB_WORLD+(15*64)+7 ;  this is middle row furthest west ( < x )
00489Cr 1  8D rr rr        STA TUB_WORLD+(15*64)+8
00489Fr 1  8D rr rr        STA TUB_WORLD+(14*64)+8
0048A2r 1  8D rr rr        STA TUB_WORLD+(16*64)+7
0048A5r 1  AD rr rr      : LDA CAMERA_CELL_LINE_PTR
0048A8r 1  85 22           STA ZP_PTR
0048AAr 1  AD rr rr        LDA CAMERA_CELL_LINE_PTR+1
0048ADr 1  85 23           STA ZP_PTR+1
0048AFr 1  AC rr rr        LDY camera_cell_x
0048B2r 1  B1 22           LDA (ZP_PTR),y
0048B4r 1  1A              INC A
0048B5r 1  91 22           STA (ZP_PTR),y
0048B7r 1               
0048B7r 1  20 rr rr        JSR DO_WAVES
0048BAr 1               
0048BAr 1  20 rr rr        JSR UPDATE_WATER_SIM
0048BDr 1               ;   LDA DO_FAUCET
0048BDr 1               ;   BEQ :+
0048BDr 1               ;   LDA #85
0048BDr 1               ;   STA TUB_WORLD+(15*64)+7 ;  this is middle row furthest west ( < x )
0048BDr 1               ;   STA TUB_WORLD+(15*64)+8
0048BDr 1               ;   STA TUB_WORLD+(14*64)+8
0048BDr 1               ;   STA TUB_WORLD+(16*64)+7
0048BDr 1                :
0048BDr 1               
0048BDr 1  20 rr rr       jsr push_world_to_object_list
0048C0r 1  AC rr rr       LDY CAMERA_CENTER_YH
0048C3r 1  B9 rr rr       LDA OBJECT_LIST_Z_START_POINTERS,y ;  get pointer to current next..
0048C6r 1  EE rr rr       INC OBJECT_LIST_BYTE6_NEXT ; get next available object...
0048C9r 1  AE rr rr       LDX OBJECT_LIST_BYTE6_NEXT ; get offset for that
0048CCr 1  9D rr rr       STA OBJECT_LIST_BYTE6_NEXT,X ; set the old value to this next..
0048CFr 1  8A             TXA
0048D0r 1  99 rr rr       STA OBJECT_LIST_Z_START_POINTERS,y ; patch this into Z
0048D3r 1  A9 10          LDA #16
0048D5r 1  9D rr rr       STA OBJECT_LIST_BYTE0_ADDRLOW,X
0048D8r 1  A9 01          LDA #1
0048DAr 1  9D rr rr       STA OBJECT_LIST_BYTE1_MODE,X
0048DDr 1  A9 48          LDA #80-8
0048DFr 1  9D rr rr       STA OBJECT_LIST_BYTE2_X,X
0048E2r 1  A9 2C          LDA #60-16
0048E4r 1  9D rr rr       STA OBJECT_LIST_BYTE3_Y,X
0048E7r 1  A9 50          LDA #$50
0048E9r 1  9D rr rr       STA OBJECT_LIST_BYTE5_SIZE,X
0048ECr 1               
0048ECr 1               ;        A        B     CURRENT BITMAP BUFFER
0048ECr 1               ;   0   display  dirty    A is being displayed, B to be drawn on
0048ECr 1               ;  64   display  ready    B  is ready for swap
0048ECr 1               ; 128   dirty    display  B is being displayed, A to be drawn on
0048ECr 1               ; 192   ready    display  A  is ready for swap
0048ECr 1               
0048ECr 1               ; OK so we want bit 6 (64) to be set
0048ECr 1  80 01           BRA :++
0048EEr 1               ;   LDA #2
0048EEr 1               :
0048EEr 1  CB              wai
0048EFr 1               ;   CMP VSYNC_counter
0048EFr 1               ;   BCS :-
0048EFr 1  AD rr rr     :  LDA CURRENT_BITMAP_BUFFER
0048F2r 1  29 40           AND #64
0048F4r 1  D0 F8           BNE :--
0048F6r 1  9C rr rr        STZ VERA_LOCK ; ok gotta lock the VERA...
0048F9r 1  A9 D1           LDA #$D1
0048FBr 1  8D rr rr        STA OBJECT_LIST_BYTE5_SIZE+1
0048FEr 1               
0048FEr 1  20 rr rr        jsr draw_object_list
004901r 1               
004901r 1               @WRITE_DEBUG:
004901r 1  64 7A            STZ $7A
004903r 1  AD rr rr         LDA camera_cell_y
004906r 1  3A               DEC A
004907r 1  4A               LSR
004908r 1  66 7A            ROR $7A
00490Ar 1  4A               LSR
00490Br 1  66 7A            ROR $7A
00490Dr 1  69 rr            ADC #>TUB_WORLD
00490Fr 1  85 7B            STA $7B
004911r 1  AC rr rr         LDY camera_cell_x
004914r 1  B1 7A            LDA ($7A),y
004916r 1  8D rr rr         STA CELL_VAL_UPLEFT
004919r 1  C8               INY
00491Ar 1  B1 7A            LDA ($7A),Y
00491Cr 1  8D rr rr         STA CELL_VAL_UPRIGHT
00491Fr 1               
00491Fr 1  64 7C            STZ $7C
004921r 1  AD rr rr         LDA camera_cell_y
004924r 1  4A               LSR  ;  y pages of 128
004925r 1  66 7C            ROR $7C
004927r 1  4A               LSR  ; y pages of 64 !
004928r 1  66 7C            ROR $7C
00492Ar 1  69 rr            ADC #>TUB_WORLD
00492Cr 1  85 7D            STA $7D
00492Er 1  8D rr rr         STA CAMERA_CELL_LINE_PTR+1
004931r 1  A5 7C            LDA $7C
004933r 1  8D rr rr         STA CAMERA_CELL_LINE_PTR
004936r 1  B1 7C            LDA ($7C),Y
004938r 1  8D rr rr         STA CELL_VAL_RIGHT
00493Br 1  88               DEY
00493Cr 1  B1 7C            LDA ($7C),Y
00493Er 1  8D rr rr         STA CELL_VAL_SELF
004941r 1  88               DEY
004942r 1  B1 7C            LDA ($7C),Y
004944r 1  8D rr rr         STA CELL_VAL_LEFT
004947r 1               
004947r 1  64 7E            STZ $7E
004949r 1  AD rr rr         LDA camera_cell_y
00494Cr 1  1A               INC A
00494Dr 1  4A               LSR  ;  y pages of 128
00494Er 1  66 7E            ROR $7E
004950r 1  4A               LSR  ; y pages of 64 !
004951r 1  66 7E            ROR $7E
004953r 1  69 rr            ADC #>TUB_WORLD
004955r 1  85 7F            STA $7F
004957r 1  B1 7E            LDA ($7E),Y
004959r 1  8D rr rr         STA CELL_VAL_DOWNLEFT
00495Cr 1  C8               INY
00495Dr 1  B1 7E            LDA ($7E),Y
00495Fr 1  8D rr rr         STA CELL_VAL_DOWNRIGHT
004962r 1               
004962r 1  9C 25 9F        STZ VERA_ctrl
004965r 1  A9 2A           LDA #42;+64
004967r 1  8D 20 9F        STA VERA_addr_low
00496Ar 1  A9 E4           LDA #>VRAM_TEXT_SCREEN
00496Cr 1  8D 21 9F        STA VERA_addr_high
00496Fr 1  A9 21           LDA #$21
004971r 1  8D 22 9F        STA VERA_addr_bank
004974r 1               
004974r 1  AD 23 9F        LDA VERA_data0 ; skip a spot at 2
004977r 1  AD 23 9F        LDA VERA_data0 ; skip a spot at 4
00497Ar 1               
00497Ar 1  AE rr rr        LDX CELL_VAL_UPLEFT
00497Dr 1  BD rr rr        LDA HIGH_NIBBLE_TO_HEX,X
004980r 1  8D 23 9F        STA VERA_data0                ;  6
004983r 1  BD rr rr        LDA LOW_NIBBLE_TO_HEX,X
004986r 1  8D 23 9F        STA VERA_data0                ;  8
004989r 1               
004989r 1  AD 23 9F        LDA VERA_data0     ; skip a spot    10
00498Cr 1  AD 23 9F        LDA VERA_data0     ; skip a spot    12
00498Fr 1               
00498Fr 1  AE rr rr        LDX CELL_VAL_UPRIGHT
004992r 1  BD rr rr        LDA HIGH_NIBBLE_TO_HEX,X
004995r 1  8D 23 9F        STA VERA_data0                ;  14
004998r 1  BD rr rr        LDA LOW_NIBBLE_TO_HEX,X
00499Br 1  8D 23 9F        STA VERA_data0                ;  16
00499Er 1  18              CLC
00499Fr 1  AD 20 9F        LDA VERA_addr_low
0049A2r 1  69 30           ADC #64-16
0049A4r 1  8D 20 9F        STA VERA_addr_low
0049A7r 1               
0049A7r 1  AE rr rr        LDX CELL_VAL_LEFT
0049AAr 1  BD rr rr        LDA HIGH_NIBBLE_TO_HEX,X
0049ADr 1  8D 23 9F        STA VERA_data0                ;  2
0049B0r 1  BD rr rr        LDA LOW_NIBBLE_TO_HEX,X
0049B3r 1  8D 23 9F        STA VERA_data0                ;  4
0049B6r 1               
0049B6r 1  AD 23 9F        LDA VERA_data0    ;     6
0049B9r 1  AD 23 9F        LDA VERA_data0    ;     8
0049BCr 1               
0049BCr 1  AE rr rr        LDX CELL_VAL_SELF
0049BFr 1  BD rr rr        LDA HIGH_NIBBLE_TO_HEX,X
0049C2r 1  8D 23 9F        STA VERA_data0                ;  10
0049C5r 1  BD rr rr        LDA LOW_NIBBLE_TO_HEX,X
0049C8r 1  8D 23 9F        STA VERA_data0                ;  12
0049CBr 1               
0049CBr 1  AD 23 9F        LDA VERA_data0    ;     14
0049CEr 1  AD 23 9F        LDA VERA_data0    ;     16
0049D1r 1               
0049D1r 1  AE rr rr        LDX CELL_VAL_RIGHT
0049D4r 1  BD rr rr        LDA HIGH_NIBBLE_TO_HEX,X
0049D7r 1  8D 23 9F        STA VERA_data0                ;  18
0049DAr 1  BD rr rr        LDA LOW_NIBBLE_TO_HEX,X
0049DDr 1  8D 23 9F        STA VERA_data0                ;  20
0049E0r 1               
0049E0r 1  18              CLC
0049E1r 1  AD 20 9F        LDA VERA_addr_low
0049E4r 1  69 2C           ADC #64-20
0049E6r 1  8D 20 9F        STA VERA_addr_low
0049E9r 1               
0049E9r 1  AD 23 9F        LDA VERA_data0 ; skip a spot at 2
0049ECr 1  AD 23 9F        LDA VERA_data0 ; skip a spot at 4
0049EFr 1               
0049EFr 1  AE rr rr        LDX CELL_VAL_DOWNLEFT
0049F2r 1  BD rr rr        LDA HIGH_NIBBLE_TO_HEX,X
0049F5r 1  8D 23 9F        STA VERA_data0                ;  6
0049F8r 1  BD rr rr        LDA LOW_NIBBLE_TO_HEX,X
0049FBr 1  8D 23 9F        STA VERA_data0                ;  8
0049FEr 1               
0049FEr 1  AD 23 9F        LDA VERA_data0     ; skip a spot    10
004A01r 1  AD 23 9F        LDA VERA_data0     ; skip a spot    12
004A04r 1               
004A04r 1  AE rr rr        LDX CELL_VAL_DOWNRIGHT
004A07r 1  BD rr rr        LDA HIGH_NIBBLE_TO_HEX,X
004A0Ar 1  8D 23 9F        STA VERA_data0                ;  14
004A0Dr 1  BD rr rr        LDA LOW_NIBBLE_TO_HEX,X
004A10r 1  8D 23 9F        STA VERA_data0                ;  16
004A13r 1               
004A13r 1  A9 2A           LDA #42
004A15r 1  8D 20 9F        STA VERA_addr_low
004A18r 1  EE 21 9F        INC VERA_addr_high
004A1Br 1               
004A1Br 1               
004A1Br 1  A0 00           LDY #0
004A1Dr 1  BE rr rr      : LDX GLOBAL_DATA,Y
004A20r 1  BD rr rr        LDA HIGH_NIBBLE_TO_HEX,X ; 1
004A23r 1  8D 23 9F        STA VERA_data0
004A26r 1  BD rr rr        LDA LOW_NIBBLE_TO_HEX,X  ; 2
004A29r 1  8D 23 9F        STA VERA_data0
004A2Cr 1  C8              INY
004A2Dr 1  BE rr rr        LDX GLOBAL_DATA,Y
004A30r 1  BD rr rr        LDA HIGH_NIBBLE_TO_HEX,X   ;  3
004A33r 1  8D 23 9F        STA VERA_data0
004A36r 1  BD rr rr        LDA LOW_NIBBLE_TO_HEX,X    ;  4
004A39r 1  8D 23 9F        STA VERA_data0
004A3Cr 1  C8              INY
004A3Dr 1  AD 23 9F        LDA VERA_data0             ;  5
004A40r 1  BE rr rr        LDX GLOBAL_DATA,Y
004A43r 1  BD rr rr        LDA HIGH_NIBBLE_TO_HEX,X   ;  6
004A46r 1  8D 23 9F        STA VERA_data0
004A49r 1  BD rr rr        LDA LOW_NIBBLE_TO_HEX,X    ;  7
004A4Cr 1  8D 23 9F        STA VERA_data0
004A4Fr 1  C8              INY
004A50r 1  BE rr rr        LDX GLOBAL_DATA,Y
004A53r 1  BD rr rr        LDA HIGH_NIBBLE_TO_HEX,X   ;  8
004A56r 1  8D 23 9F        STA VERA_data0
004A59r 1  BD rr rr        LDA LOW_NIBBLE_TO_HEX,X    ;  9
004A5Cr 1  8D 23 9F        STA VERA_data0
004A5Fr 1  C8              INY
004A60r 1  18              CLC
004A61r 1  AD 20 9F        LDA VERA_addr_low          ;  moved 18 out of 64 bytes...
004A64r 1  69 2E           ADC #64-18
004A66r 1  8D 20 9F        STA VERA_addr_low
004A69r 1  90 03           BCC :+
004A6Br 1  EE 21 9F        INC VERA_addr_high
004A6Er 1  C0 30         : CPY #ENDGLOBALS-GLOBAL_DATA  ;
004A70r 1  90 AB           BCC :--
004A72r 1               
004A72r 1  18              CLC
004A73r 1  AD rr rr        LDA CURRENT_BITMAP_BUFFER
004A76r 1  69 40           ADC #64
004A78r 1  8D rr rr        STA CURRENT_BITMAP_BUFFER
004A7Br 1               
004A7Br 1  A9 FF           LDA #$FF ; time to unlock the VERA ..
004A7Dr 1  8D rr rr        STA VERA_LOCK
004A80r 1               
004A80r 1               ;   rts
004A80r 1               
004A80r 1               @FRAME_CHECK:
004A80r 1  AD rr rr        LDA STALL_COUNTERH
004A83r 1  8D rr rr        STA LAST_STALLCOUNTERH
004A86r 1  AD rr rr        LDA STALL_COUNTER
004A89r 1  8D rr rr        STA LAST_STALLCOUNTER
004A8Cr 1  A2 FF           LDX #255
004A8Er 1  A0 FF           LDY #255
004A90r 1  AD rr rr        LDA VSYNC_counter
004A93r 1  8D rr rr        STA LAST_VSYNC_COUNTER
004A96r 1               ;   BNE :+++
004A96r 1  9C rr rr        STZ VSYNC_counter
004A99r 1  E8           :  INX                     ;  2 cycles    8
004A9Ar 1  D0 01           BNE :+                  ;  ~3 cycles   11 or 10 if drop through
004A9Cr 1  C8              INY                     ; 2            11/12
004A9Dr 1               :  ;wai   disables the busy wait..
004A9Dr 1  AD rr rr        lda VSYNC_counter       ;  4  cyles    15/16
004AA0r 1  F0 F7           BEQ :--                ;  3  cycles     18/19   so 1 full of X = ~4,607 cycles .. count would go to ~7,407 for full frame.. or ~ $1C,$F0
004AA2r 1               ;:
004AA2r 1  9C rr rr        STZ VSYNC_counter
004AA5r 1  8E rr rr        STX STALL_COUNTER
004AA8r 1  8C rr rr        STY STALL_COUNTERH
004AABr 1               ;   LDA MASTER_CLOCK
004AABr 1               ;   INC A
004AABr 1               ;   CLC
004AABr 1               ;   ADC LAST_VSYNC_COUNTER
004AABr 1               ;   STA MASTER_CLOCK
004AABr 1  EE rr rr        INC MASTER_CLOCK
004AAEr 1  D0 03           BNE :+
004AB0r 1  EE rr rr        INC MASTER_CLOCK+1
004AB3r 1               :
004AB3r 1               ;   AND #1 ; restrict to 30 fps.. don't care missed cycle.
004AB3r 1               ;   BEQ :+
004AB3r 1               ;   JMP @WRITE_DEBUG
004AB3r 1                  ; poll keyboard for input
004AB3r 1               ; :
004AB3r 1  20 E4 FF        jsr GETIN
004AB6r 1  C9 00           cmp #0
004AB8r 1  D0 03           BNE :+
004ABAr 1  4C rr rr        JMP @do_update
004ABDr 1  C9 0D         : CMP #RETURN
004ABFr 1  D0 03           BNE :+
004AC1r 1  4C rr rr        JMP @cleanup_and_exit
004AC4r 1  C9 1D         : cmp #$1D 	;	cursor right
004AC6r 1  D0 06           BNE :+
004AC8r 1  EE rr rr        INC camera_facing
004ACBr 1  4C rr rr        JMP @do_update
004ACEr 1                  :
004ACEr 1  C9 9D           cmp  #$9D 	;	cursor left
004AD0r 1  D0 06           BNE :+
004AD2r 1  CE rr rr        DEC camera_facing
004AD5r 1  4C rr rr        JMP @do_update
004AD8r 1  C9 11         : cmp #$11; cursor down
004ADAr 1  D0 2C           BNE :+
004ADCr 1  AE rr rr        LDX camera_facing
004ADFr 1  38              SEC
004AE0r 1  AD rr rr        LDA camera_world_pos_XL
004AE3r 1  FD rr rr        SBC MOVE_X_L,X
004AE6r 1  8D rr rr        STA camera_world_pos_XL
004AE9r 1  AD rr rr        LDA camera_world_pos_XH
004AECr 1  FD rr rr        SBC MOVE_X_H,X
004AEFr 1  8D rr rr        STA camera_world_pos_XH
004AF2r 1  18              CLC
004AF3r 1  AD rr rr        LDA camera_world_pos_YL
004AF6r 1  7D rr rr        ADC MOVE_Y_L,X
004AF9r 1  8D rr rr        STA camera_world_pos_YL
004AFCr 1  AD rr rr        LDA camera_world_pos_YH
004AFFr 1  7D rr rr        ADC MOVE_Y_H,X
004B02r 1  8D rr rr        STA camera_world_pos_YH
004B05r 1  4C rr rr        jmp @camera_world_changed
004B08r 1               
004B08r 1  C9 91         : cmp #$91 ; cursor up
004B0Ar 1  D0 2C           BNE :+
004B0Cr 1  AE rr rr        LDX camera_facing
004B0Fr 1  18              CLC
004B10r 1  AD rr rr        LDA camera_world_pos_XL
004B13r 1  7D rr rr        ADC MOVE_X_L,X
004B16r 1  8D rr rr        STA camera_world_pos_XL
004B19r 1  AD rr rr        LDa camera_world_pos_XH
004B1Cr 1  7D rr rr        ADC MOVE_X_H,X
004B1Fr 1  8D rr rr        STA camera_world_pos_XH
004B22r 1  38              SEC
004B23r 1  AD rr rr        LDA camera_world_pos_YL
004B26r 1  FD rr rr        SBC MOVE_Y_L,X
004B29r 1  8D rr rr        STA camera_world_pos_YL
004B2Cr 1  AD rr rr        LDA camera_world_pos_YH
004B2Fr 1  FD rr rr        SBC MOVE_Y_H,X
004B32r 1  8D rr rr        STA camera_world_pos_YH
004B35r 1  4C rr rr        jmp @camera_world_changed
004B38r 1               
004B38r 1  C9 45         : cmp  #E_CHAR ; cell up right
004B3Ar 1  D0 15           BNE :+++
004B3Cr 1  AD rr rr        LDA camera_cell_y
004B3Fr 1  F0 03           BEQ :+
004B41r 1  CE rr rr        DEC camera_cell_y
004B44r 1  AD rr rr      : LDA camera_cell_x
004B47r 1  C9 3F           CMP #63
004B49r 1  B0 03           BCS :+
004B4Br 1  EE rr rr        INC camera_cell_x
004B4Er 1  4C rr rr      : JMP @camera_cell_changed
004B51r 1               
004B51r 1  C9 57         : cmp #W_CHAR ; cell up left
004B53r 1  D0 0B           BNE :++
004B55r 1  AD rr rr        LDA camera_cell_y
004B58r 1  F0 03           BEQ :+
004B5Ar 1  CE rr rr        DEC camera_cell_y
004B5Dr 1  4C rr rr      : JMP @camera_cell_changed
004B60r 1               
004B60r 1  C9 41         : cmp #A_CHAR ; cell left
004B62r 1  D0 0B           BNE :++
004B64r 1  AD rr rr        LDA camera_cell_x
004B67r 1  F0 03           BEQ :+
004B69r 1  CE rr rr        DEC camera_cell_x
004B6Cr 1  4C rr rr      : JMP @camera_cell_changed
004B6Fr 1               
004B6Fr 1  C9 44         : cmp #D_CHAR ; cell right
004B71r 1  D0 0D           BNE :++
004B73r 1  AD rr rr        LDA camera_cell_x
004B76r 1  C9 3F           CMP #63
004B78r 1  B0 03           BCS :+
004B7Ar 1  EE rr rr        INC camera_cell_x
004B7Dr 1  4C rr rr      : JMP @camera_cell_changed
004B80r 1               
004B80r 1  C9 58         : cmp #X_CHAR ; cell down right
004B82r 1  D0 0D           BNE :++
004B84r 1  AD rr rr        LDA camera_cell_y
004B87r 1  C9 1E           CMP #30
004B89r 1  B0 03           BCS :+
004B8Br 1  EE rr rr        INC camera_cell_y
004B8Er 1  4C rr rr      : JMP @camera_cell_changed
004B91r 1               
004B91r 1  C9 5A         : cmp  #Z_CHAR ; cell down left
004B93r 1  D0 15           BNE :+++
004B95r 1  AD rr rr        LDA camera_cell_y
004B98r 1  C9 1E           CMP #30
004B9Ar 1  B0 03           BCS :+
004B9Cr 1  EE rr rr        INC camera_cell_y
004B9Fr 1  AD rr rr      : LDA camera_cell_x
004BA2r 1  F0 03           BEQ :+
004BA4r 1  CE rr rr        DEC camera_cell_x
004BA7r 1  4C rr rr      : JMP @camera_cell_changed
004BAAr 1               
004BAAr 1  C9 20         : cmp #SPACE;
004BACr 1  D0 09           BNE :+
004BAEr 1  9C rr rr        STZ camera_cell_xl
004BB1r 1  9C rr rr        STZ camera_cell_yl
004BB4r 1  4C rr rr        JMP @camera_cell_changed
004BB7r 1               
004BB7r 1  C9 49         : cmp #I_CHAR ; cell y - 1/16
004BB9r 1  D0 25           BNE :++
004BBBr 1  38              SEC
004BBCr 1  AD rr rr        LDA camera_cell_yl
004BBFr 1  E9 10           SBC #16
004BC1r 1  8D rr rr        STA camera_cell_yl
004BC4r 1  B0 17           BCS :+
004BC6r 1  AD rr rr        LDA camera_cell_y
004BC9r 1  F0 12           BEQ :+
004BCBr 1  3A              DEC A
004BCCr 1  8D rr rr        STA camera_cell_y
004BCFr 1  18              CLC
004BD0r 1  AD rr rr        LDA camera_cell_xl
004BD3r 1  69 80           ADC #128
004BD5r 1  8D rr rr        STA camera_cell_xl
004BD8r 1  90 03           BCC :+
004BDAr 1  EE rr rr        INC camera_cell_x
004BDDr 1  4C rr rr      : JMP @camera_cell_changed
004BE0r 1               
004BE0r 1  C9 4A         : cmp #J_CHAR ; cell x - 1/16
004BE2r 1  D0 17           BNE :++
004BE4r 1  38              SEC
004BE5r 1  AD rr rr        LDA camera_cell_xl
004BE8r 1  E9 10           SBC #16
004BEAr 1  8D rr rr        STA camera_cell_xl
004BEDr 1  B0 09           BCS :+
004BEFr 1  AD rr rr        LDA camera_cell_x
004BF2r 1  F0 04           BEQ :+
004BF4r 1  3A              DEC A
004BF5r 1  8D rr rr        STA camera_cell_x
004BF8r 1  4C rr rr      : JMP @camera_cell_changed
004BFBr 1               
004BFBr 1  C9 4B         : cmp #K_CHAR ; cell y + 1/16
004BFDr 1  D0 27           BNE :++
004BFFr 1  18              CLC
004C00r 1  AD rr rr        LDA camera_cell_yl
004C03r 1  69 10           ADC #16
004C05r 1  8D rr rr        STA camera_cell_yl
004C08r 1  90 19           BCC :+
004C0Ar 1  AD rr rr        LDA camera_cell_y
004C0Dr 1  C9 1F           CMP #31
004C0Fr 1  B0 12           BCS :+
004C11r 1  1A              INC A
004C12r 1  8D rr rr        STA camera_cell_y
004C15r 1  38              SEC
004C16r 1  AD rr rr        LDA camera_cell_xl
004C19r 1  E9 80           SBC #128
004C1Br 1  8D rr rr        STA camera_cell_xl
004C1Er 1  B0 03           BCS :+
004C20r 1  CE rr rr        DEC camera_cell_x
004C23r 1  4C rr rr      : JMP @camera_cell_changed
004C26r 1               
004C26r 1  C9 4C         : cmp #L_CHAR ; cell x + 1/16
004C28r 1  D0 11           BNE :++
004C2Ar 1  18              CLC
004C2Br 1  AD rr rr        LDA camera_cell_xl
004C2Er 1  69 10           ADC #16
004C30r 1  8D rr rr        STA camera_cell_xl
004C33r 1  90 03           BCC :+
004C35r 1  EE rr rr        INC camera_cell_x
004C38r 1  4C rr rr      : JMP @camera_cell_changed
004C3Br 1               
004C3Br 1  C9 31         : CMP #ONE_CHAR
004C3Dr 1  D0 08           BNE :+
004C3Fr 1  AD 29 9F        LDA VERA_dc_video
004C42r 1  49 20           EOR #%00100000
004C44r 1  8D 29 9F        STA VERA_dc_video
004C47r 1               
004C47r 1  C9 32         : CMP #TWO_CHAR
004C49r 1  D0 08           BNE :+
004C4Br 1  AD 29 9F        LDA VERA_dc_video
004C4Er 1  49 40           EOR #%01000000
004C50r 1  8D 29 9F        STA VERA_dc_video
004C53r 1               
004C53r 1  C9 33         : CMP #THREE_CHAR
004C55r 1  D0 08           BNE :+
004C57r 1  AD 29 9F        LDA VERA_dc_video
004C5Ar 1  49 10           EOR #%00010000
004C5Cr 1  8D 29 9F        STA VERA_dc_video
004C5Fr 1               
004C5Fr 1  C9 30         : CMP #ZERO_CHAR
004C61r 1  D0 13           BNE :+++
004C63r 1  AD 2A 9F        LDA VERA_dc_hscale
004C66r 1  C9 2B           CMP #43
004C68r 1  B0 04           BCS :+
004C6Ar 1  A9 33           LDA #51 ; #51 ; 51 is 255
004C6Cr 1  80 02           BRA :++
004C6Er 1  A9 20         : LDA #32
004C70r 1  8D 2A 9F      : STA VERA_dc_hscale
004C73r 1  8D 2B 9F        STA VERA_dc_vscale
004C76r 1               
004C76r 1  C9 39         : CMP #NINE_CHAR
004C78r 1  D0 08           BNE :+
004C7Ar 1  AD rr rr        LDA SPRITE_OBJECT_ENABLE
004C7Dr 1  49 FF           EOR #$FF
004C7Fr 1  8D rr rr        STA SPRITE_OBJECT_ENABLE
004C82r 1               
004C82r 1  C9 38         : CMP #EIGHT_CHAR
004C84r 1  D0 08           BNE :+
004C86r 1  A9 FF           LDA #$FF
004C88r 1  4D rr rr        EOR DO_WATER
004C8Br 1  8D rr rr        STA DO_WATER
004C8Er 1               
004C8Er 1  C9 37         : CMP #SEVEN_CHAR
004C90r 1  D0 08           BNE :+
004C92r 1  AD rr rr        LDA DO_WATER
004C95r 1  D0 03           BNE :+
004C97r 1  20 rr rr        JSR UPDATE_WATER_SIM
004C9Ar 1               
004C9Ar 1  C9 36         : CMP #SIX_CHAR
004C9Cr 1  D0 08           BNE :+
004C9Er 1  AD rr rr        LDA DO_FAUCET
004CA1r 1  49 FF           EOR #$FF
004CA3r 1  8D rr rr        STA DO_FAUCET
004CA6r 1               
004CA6r 1  4C rr rr      : JMP @do_update
004CA9r 1               
004CA9r 1               @cleanup_and_exit:
004CA9r 1                  ; restore default IRQ vector
004CA9r 1  78              sei
004CAAr 1  AD rr rr        lda default_irq_vector
004CADr 1  8D 14 03        sta IRQVec
004CB0r 1  AD rr rr        lda default_irq_vector+1
004CB3r 1  8D 15 03        sta IRQVec+1
004CB6r 1  58              cli
004CB7r 1  20 81 FF        jsr CINT
004CBAr 1  60              rts
004CBBr 1               
004CBBr 1               
004CBBr 1               ; CURRENT
004CBBr 1               push_world_to_object_list: ; as in.. let's try this again?? wait.. missing a STZ ZP_PTR...
004CBBr 1               PWOL_TUB_PTR_AL   = ZP_PTR
004CBBr 1               PWOL_TUB_PTR_AH   = ZP_PTR+1
004CBBr 1               PWOL_TUB_PTR_BL   = ZP_PTR+2
004CBBr 1               PWOL_TUB_PTR_BH   = ZP_PTR+3
004CBBr 1               PWOL_CURRENT_XL   = ZP_PTR+4
004CBBr 1               PWOL_CURRENT_XH   = ZP_PTR+5
004CBBr 1               PWOL_CURRENT_YL   = ZP_PTR+6
004CBBr 1               PWOL_CURRENT_YH   = ZP_PTR+7
004CBBr 1               PWOL_ACROSS_ROW_XL= ZP_PTR+8
004CBBr 1               PWOL_ACROSS_ROW_XH= ZP_PTR+9
004CBBr 1               PWOL_ACROSS_ROW_YL= ZP_PTR+10
004CBBr 1               PWOL_ACROSS_ROW_YH= ZP_PTR+11
004CBBr 1               PWOL_NEXT_ROW_A_LEFT_XL  = ZP_PTR+12
004CBBr 1               PWOL_NEXT_ROW_A_LEFT_XH  = ZP_PTR+13
004CBBr 1               PWOL_NEXT_ROW_A_LEFT_YL  = ZP_PTR+14
004CBBr 1               PWOL_NEXT_ROW_A_LEFT_YH  = ZP_PTR+15
004CBBr 1               PWOL_NEXT_ROW_A_RIGHT_XL  = ZP_PTR+16
004CBBr 1               PWOL_NEXT_ROW_A_RIGHT_XH  = ZP_PTR+17
004CBBr 1               PWOL_NEXT_ROW_A_RIGHT_YL  = ZP_PTR+18
004CBBr 1               PWOL_NEXT_ROW_A_RIGHT_YH  = ZP_PTR+19
004CBBr 1               PWOL_NEXT_ROW_B_LEFT_XL  = ZP_PTR+20
004CBBr 1               PWOL_NEXT_ROW_B_LEFT_XH  = ZP_PTR+21
004CBBr 1               PWOL_NEXT_ROW_B_LEFT_YL  = ZP_PTR+22
004CBBr 1               PWOL_NEXT_ROW_B_LEFT_YH  = ZP_PTR+23
004CBBr 1               PWOL_NEXT_ROW_B_RIGHT_XL  = ZP_PTR+24
004CBBr 1               PWOL_NEXT_ROW_B_RIGHT_XH  = ZP_PTR+25
004CBBr 1               PWOL_NEXT_ROW_B_RIGHT_YL  = ZP_PTR+26
004CBBr 1               PWOL_NEXT_ROW_B_RIGHT_YH  = ZP_PTR+27
004CBBr 1               PWOL_Z_STARTS_PTR = ZP_PTR+28
004CBBr 1               PWOL_Z_STARTS_PTRH = ZP_PTR+29
004CBBr 1               PWOL_CONVERT_HEIGHTS = ZP_PTR+30
004CBBr 1               PWOL_CONVERT_HEIGHTSH= ZP_PTR+31
004CBBr 1               PWOL_CONVERT_HEIGHTS_L = ZP_PTR+32
004CBBr 1               PWOL_CONVERT_HEIGHTS_LH = ZP_PTR+33
004CBBr 1               PWOL_TRIES_COUNTER = ZP_PTR+34
004CBBr 1               PWOL_START_XL = ZP_PTR+35
004CBBr 1               PWOL_START_YL = ZP_PTR+36
004CBBr 1               PWOL_START_XH = ZP_PTR+37
004CBBr 1               PWOL_START_YH = ZP_PTR+38
004CBBr 1               
004CBBr 1               PWOL_START_COS_XL = ZP_PTR+39
004CBBr 1               PWOL_START_COS_XH = ZP_PTR+40
004CBBr 1               PWOL_START_COS_YL = ZP_PTR+41
004CBBr 1               PWOL_START_COS_YH = ZP_PTR+42
004CBBr 1               PWOL_START_SIN_XL = ZP_PTR+43
004CBBr 1               PWOL_START_SIN_XH = ZP_PTR+44
004CBBr 1               PWOL_START_SIN_YL = ZP_PTR+45
004CBBr 1               PWOL_START_SIN_YH = ZP_PTR+46
004CBBr 1               
004CBBr 1               PWOL_camera_cell_xl = ZP_PTR+47
004CBBr 1               PWOL_camera_cell_yl = ZP_PTR+48
004CBBr 1               PWOL_CENTER_Y  =  ZP_PTR+49
004CBBr 1               PWOL_CENTER_Y_TOP     =  ZP_PTR+50
004CBBr 1               
004CBBr 1               PWOL_TOP_CHECK = ZP_PTR+51
004CBBr 1               PWOL_BOT_CHECK = ZP_PTR+52
004CBBr 1               
004CBBr 1               TRY_AGAIN = 6
004CBBr 1  AD rr rr        LDA camera_screen_out_top
004CBEr 1  85 55           STA PWOL_TOP_CHECK
004CC0r 1  AD rr rr        LDA camera_screen_out_bottom
004CC3r 1  85 56           STA PWOL_BOT_CHECK
004CC5r 1               
004CC5r 1  AD rr rr        LDA CAMERA_CENTER_YH
004CC8r 1  1A              INC A
004CC9r 1  85 53           STA PWOL_CENTER_Y
004CCBr 1  AD rr rr        LDA CAMERA_CENTER_TOP_PX
004CCEr 1  18              CLC
004CCFr 1  69 0A           ADC #10
004CD1r 1  85 54           STA PWOL_CENTER_Y_TOP
004CD3r 1               
004CD3r 1               
004CD3r 1  A9 rr           LDA #>CONVERT_HEIGHTS_PIXELS
004CD5r 1  85 41           STA PWOL_CONVERT_HEIGHTSH
004CD7r 1  A9 rr           LDA #>CONVERT_HEIGHTS_PIXELS_L
004CD9r 1  85 43           STA PWOL_CONVERT_HEIGHTS_LH
004CDBr 1               
004CDBr 1  A9 rr           LDA #>OBJECT_LIST_Z_START_POINTERS
004CDDr 1  85 3F           STA PWOL_Z_STARTS_PTRH
004CDFr 1               
004CDFr 1  AE rr rr        LDX camera_facing
004CE2r 1  BD rr rr        LDA ACROSS_ROW_X_L,x    ; 0900  16 wide , 45* tilt ... this is added to go up row, sub for down row
004CE5r 1  85 2A           STA PWOL_ACROSS_ROW_XL
004CE7r 1  BD rr rr        LDA ACROSS_ROW_X_H,x
004CEAr 1  85 2B           STA PWOL_ACROSS_ROW_XH
004CECr 1               
004CECr 1  BD rr rr        LDA ACROSS_ROW_Y_L,x
004CEFr 1  85 2C           STA PWOL_ACROSS_ROW_YL
004CF1r 1  BD rr rr        LDA ACROSS_ROW_Y_H,x
004CF4r 1  85 2D           STA PWOL_ACROSS_ROW_YH
004CF6r 1               
004CF6r 1  18              CLC
004CF7r 1  BD rr rr        LDA NEXT_ROW_X_L,X  ; 0D00 next row LEFT/up when added
004CFAr 1  85 2E           STA PWOL_NEXT_ROW_A_LEFT_XL   ; -> next row is left, going up the screen ..  -1,-1
004CFCr 1  65 2A           ADC PWOL_ACROSS_ROW_XL   ; across row is for right , subtract to go left  +1 -> 0,1
004CFEr 1  85 32           STA PWOL_NEXT_ROW_A_RIGHT_XL  ;  -> next row is right, going up the screen .. -1,-1
004D00r 1  BD rr rr        LDA NEXT_ROW_X_H,x
004D03r 1  85 2F           STA PWOL_NEXT_ROW_A_LEFT_XH
004D05r 1  65 2B           ADC PWOL_ACROSS_ROW_XH
004D07r 1  85 33           STA PWOL_NEXT_ROW_A_RIGHT_XH
004D09r 1               
004D09r 1  18              CLC
004D0Ar 1  BD rr rr        LDA NEXT_ROW_Y_L,X  ; 0F00 next row LEFT/up when added
004D0Dr 1  85 30           STA PWOL_NEXT_ROW_A_LEFT_YL   ; -> next row is left, going up the screen
004D0Fr 1  65 2C           ADC PWOL_ACROSS_ROW_YL   ; across row is for right
004D11r 1  85 34           STA PWOL_NEXT_ROW_A_RIGHT_YL  ;  -> next row is right, going up the screen
004D13r 1  BD rr rr        LDA NEXT_ROW_Y_H,x
004D16r 1  85 31           STA PWOL_NEXT_ROW_A_LEFT_YH
004D18r 1  65 2D           ADC PWOL_ACROSS_ROW_YH
004D1Ar 1  85 35           STA PWOL_NEXT_ROW_A_RIGHT_YH
004D1Cr 1               
004D1Cr 1               
004D1Cr 1               ; for zig B , the opposite of left/up is right/down.. so A_LEFT * -1 = B_RIGHT
004D1Cr 1  38              SEC ; flip A_LEFT X to B_RIGHT X
004D1Dr 1  A9 00           LDA #0
004D1Fr 1  E5 2E           SBC PWOL_NEXT_ROW_A_LEFT_XL
004D21r 1  85 3A           STA PWOL_NEXT_ROW_B_RIGHT_XL
004D23r 1  A9 00           LDA #0
004D25r 1  E5 2F           SBC PWOL_NEXT_ROW_A_LEFT_XH
004D27r 1  85 3B           STA PWOL_NEXT_ROW_B_RIGHT_XH
004D29r 1               
004D29r 1  38              SEC ; flip A_LEFT Y to B_RIGHT Y
004D2Ar 1  A9 00           LDA #0
004D2Cr 1  E5 30           SBC PWOL_NEXT_ROW_A_LEFT_YL
004D2Er 1  85 3C           STA PWOL_NEXT_ROW_B_RIGHT_YL
004D30r 1  A9 00           LDA #0
004D32r 1  E5 31           SBC PWOL_NEXT_ROW_A_LEFT_YH
004D34r 1  85 3D           STA PWOL_NEXT_ROW_B_RIGHT_YH
004D36r 1               
004D36r 1  38              SEC ; flip A_RIGHT X to B_LEFT X
004D37r 1  A9 00           LDA #0
004D39r 1  E5 32           SBC PWOL_NEXT_ROW_A_RIGHT_XL
004D3Br 1  85 36           STA PWOL_NEXT_ROW_B_LEFT_XL
004D3Dr 1  A9 00           LDA #0
004D3Fr 1  E5 33           SBC PWOL_NEXT_ROW_A_RIGHT_XH
004D41r 1  85 37           STA PWOL_NEXT_ROW_B_LEFT_XH
004D43r 1               
004D43r 1  38              SEC ; flip A_RIGHT Y to B_LEFT Y
004D44r 1  A9 00           LDA #0
004D46r 1  E5 34           SBC PWOL_NEXT_ROW_A_RIGHT_YL
004D48r 1  85 38           STA PWOL_NEXT_ROW_B_LEFT_YL
004D4Ar 1  A9 00           LDA #0
004D4Cr 1  E5 35           SBC PWOL_NEXT_ROW_A_RIGHT_YH
004D4Er 1  85 39           STA PWOL_NEXT_ROW_B_LEFT_YH
004D50r 1               
004D50r 1  AD rr rr        LDA CAMERA_CENTER_XL
004D53r 1  85 26            STA PWOL_CURRENT_XL
004D55r 1  85 45            STA PWOL_START_XL
004D57r 1               
004D57r 1  AD rr rr        LDA CAMERA_CENTER_YL
004D5Ar 1  85 28            STA PWOL_CURRENT_YL
004D5Cr 1  85 46            STA PWOL_START_YL
004D5Er 1               
004D5Er 1  AD rr rr        LDA CAMERA_CENTER_XH
004D61r 1  85 27            STA PWOL_CURRENT_XH
004D63r 1  85 47            STA PWOL_START_XH
004D65r 1               
004D65r 1               
004D65r 1  AD rr rr        LDA CAMERA_CENTER_YH
004D68r 1  85 29            STA PWOL_CURRENT_YH
004D6Ar 1  85 48            STA PWOL_START_YH
004D6Cr 1               
004D6Cr 1  AD rr rr         LDA CAMERA_CELL_LINE_PTR
004D6Fr 1  85 22            STA PWOL_TUB_PTR_AL
004D71r 1  85 24            STA PWOL_TUB_PTR_BL
004D73r 1  AD rr rr         LDA CAMERA_CELL_LINE_PTR+1
004D76r 1  85 23            STA PWOL_TUB_PTR_AH
004D78r 1  85 25            STA PWOL_TUB_PTR_BH
004D7Ar 1               
004D7Ar 1                  ; STZ VERA_ctrl
004D7Ar 1                  ; LDA #<(VRAM_TEXT_SCREEN+17*64)
004D7Ar 1                  ; STA VERA_addr_low
004D7Ar 1                  ; LDA #>(VRAM_TEXT_SCREEN+17*64)
004D7Ar 1                  ; STA VERA_addr_high
004D7Ar 1                  ; LDA #$21
004D7Ar 1                  ; STA VERA_addr_bank
004D7Ar 1                  ; LDA #26
004D7Ar 1                  ; STA VERA_data0
004D7Ar 1               
004D7Ar 1                 @zigzag_A: ; going to right and up the screen, including where we are currently..
004D7Ar 1  AC rr rr         LDY camera_cell_x
004D7Dr 1  80 00            BRA @zigzag_A_right
004D7Fr 1                  @ZAR_OUT:
004D7Fr 1               
004D7Fr 1                   @zigzag_A_right:
004D7Fr 1  C0 40                CPY #64  ;  make sure we don't go outside level..
004D81r 1  B0 68                BCS @ZAR_NEXT ; if we're outside we'll just skip is OK here
004D83r 1  B1 22                LDA (PWOL_TUB_PTR_AL),y
004D85r 1  C9 81                CMP #129
004D87r 1  B0 62                BCS @ZAR_NEXT ; this isn't a valid spot in the level map..
004D89r 1                       ; bytes 1 and 4 were updated when we cleared the object list
004D89r 1  EE rr rr             INC OBJECT_LIST_BYTE6_NEXT ; is there objects left to use as next?
004D8Cr 1  D0 04                BNE :++
004D8Er 1  CE rr rr           : DEC OBJECT_LIST_BYTE6_NEXT ; so we can do this check again if out..
004D91r 1  60                   rts ; @WHAT_THE_WHAT ; we shouldn't be outside the screen...
004D92r 1  A6 29              : LDX PWOL_CURRENT_YH ;  current screenY .. to calculate effective Z for the buffer
004D94r 1  BD rr rr             LDA SCREEN_Y_TO_Z,x
004D97r 1  F0 F5                BEQ :-- ; we shouldn't be outside the screen... (could cause issues if we're high up? can't see behind?)
004D99r 1  85 3E                STA PWOL_Z_STARTS_PTR  ; ok now that's primed to be at the start .. we want to grab whatever is at this buffer and save it to our new next..
004D9Br 1  B2 3E                LDA (PWOL_Z_STARTS_PTR) ; get the current value here for the next ..
004D9Dr 1  AE rr rr             LDX OBJECT_LIST_BYTE6_NEXT ; get index for this object
004DA0r 1  9D rr rr             STA OBJECT_LIST_BYTE6_NEXT,X ; old next becomes this object's next
004DA3r 1  8A                   TXA ; push new next to the Z buffer spot
004DA4r 1  92 3E                STA (PWOL_Z_STARTS_PTR) ;  and the new next gets saved back the Z_starts... otay.. start filling in data..
004DA6r 1                       ; bytes .1..4.6 filled in already..
004DA6r 1  B1 22                LDA (PWOL_TUB_PTR_AL),y     ; get value of world at this point - 0-127=height, 128=wall, 129+ invalid
004DA8r 1  10 08                BPL @ZAR_INSIDE_TUB
004DAAr 1                     @ZAR_HIT_WALL_OUCH:
004DAAr 1  AD rr rr               LDA WORLD_WALL_SPRITE_NUM
004DADr 1  9D rr rr               STA OBJECT_LIST_BYTE0_ADDRLOW,X ; hit the wall, ouch.. write wall stuff
004DB0r 1  A9 56                  LDA #86 ; max height..
004DB2r 1                     @ZAR_INSIDE_TUB:
004DB2r 1  85 40                  STA PWOL_CONVERT_HEIGHTS ;
004DB4r 1  85 42                  STA PWOL_CONVERT_HEIGHTS_L;
004DB6r 1  38                     SEC
004DB7r 1  A5 28                  LDA PWOL_CURRENT_YL
004DB9r 1  F2 42                  SBC (PWOL_CONVERT_HEIGHTS_L)
004DBBr 1  A5 29                  LDA PWOL_CURRENT_YH ; set er up
004DBDr 1  F2 40                  SBC (PWOL_CONVERT_HEIGHTS)
004DBFr 1  C9 78                  CMP #SCREEN_OUT_BOTTOM    ;  are we even visible?
004DC1r 1  90 0E                  BCC :+
004DC3r 1  C5 55                  CMP PWOL_TOP_CHECK  ;     #SCREEN_OUT_TOP-50 ;PWOL_TOP_CHECK;
004DC5r 1  B0 0A                  BCS :+
004DC7r 1  CE rr rr               DEC OBJECT_LIST_BYTE6_NEXT
004DCAr 1  BD rr rr               LDA OBJECT_LIST_BYTE6_NEXT,X ; grab the old next value
004DCDr 1  92 3E                  STA (PWOL_Z_STARTS_PTR) ; patch the old one back in..
004DCFr 1  80 1A                  BRA @ZAR_NEXT ; and skip THIS
004DD1r 1                       :
004DD1r 1  9D rr rr               STA OBJECT_LIST_BYTE3_Y,X ; 01.34.6 filled in now
004DD4r 1  C5 54                  CMP PWOL_CENTER_Y_TOP ; is this above center on screen??
004DD6r 1  B0 0E                  BCS :+ ; is not covering us
004DD8r 1  A5 29                  LDA PWOL_CURRENT_YH
004DDAr 1  C5 53                  CMP PWOL_CENTER_Y
004DDCr 1  90 08                  BCC :+ ; its from ahead of us, OK
004DDEr 1                         ; it was from below and covers us ..
004DDEr 1  BD rr rr               LDA OBJECT_LIST_BYTE0_ADDRLOW,X
004DE1r 1  69 0F                  ADC #diff_sprite_to_transparent ; constant should be 1 less because carry is set
004DE3r 1  9D rr rr               STA OBJECT_LIST_BYTE0_ADDRLOW,X
004DE6r 1                         ;LDA #$D0
004DE6r 1                         ;STA OBJECT_LIST_BYTE5_SIZE,X ; 01.3456 done .
004DE6r 1  A5 27                : LDA PWOL_CURRENT_XH
004DE8r 1  9D rr rr               STA OBJECT_LIST_BYTE2_X,X    ; 0123456 OK - object is complete.
004DEBr 1                         ; for debugging ...
004DEBr 1                     ;    STZ VERA_data0
004DEBr 1                     ;    STA VERA_data0
004DEBr 1                     ;    LDA PWOL_CURRENT_YH
004DEBr 1                     ;    STA VERA_data0
004DEBr 1                     ;    STZ VERA_data0
004DEBr 1               
004DEBr 1                    @ZAR_NEXT:
004DEBr 1                        ; calc next to the right..
004DEBr 1  C8                    INY
004DECr 1  18                    CLC
004DEDr 1  A5 26                 LDA PWOL_CURRENT_XL
004DEFr 1  65 2A                 ADC PWOL_ACROSS_ROW_XL
004DF1r 1  85 26                 STA PWOL_CURRENT_XL
004DF3r 1  A5 27                 LDA PWOL_CURRENT_XH
004DF5r 1  65 2B                 ADC PWOL_ACROSS_ROW_XH
004DF7r 1  85 27                 STA PWOL_CURRENT_XH
004DF9r 1  AA                    TAX
004DFAr 1  18                    CLC
004DFBr 1  A5 28                 LDA PWOL_CURRENT_YL
004DFDr 1  65 2C                 ADC PWOL_ACROSS_ROW_YL
004DFFr 1  85 28                 STA PWOL_CURRENT_YL
004E01r 1  A5 29                 LDA PWOL_CURRENT_YH
004E03r 1  65 2D                 ADC PWOL_ACROSS_ROW_YH
004E05r 1  85 29                 STA PWOL_CURRENT_YH
004E07r 1               
004E07r 1               
004E07r 1  C5 56                 CMP PWOL_BOT_CHECK
004E09r 1  90 04                 BCC :+      ;     if its within bottom definitely on screen, else check top as well..
004E0Br 1  C9 F0                 CMP #SCREEN_OUT_TOP
004E0Dr 1  90 0B                 BCC @ZAR_ZIG_LEFT_SWITCH ; its bottom_out <= Y < top out .. because negatives are bigger
004E0Fr 1                      :
004E0Fr 1  E0 A0                 CPX #SCREEN_OUT_RIGHT ; check against right side
004E11r 1  90 04                 BCC :+                ; if its within right side then go do next thing..
004E13r 1  E0 F0                 CPX #SCREEN_OUT_LEFT16
004E15r 1  90 03                 BCC @ZAR_ZIG_LEFT_SWITCH ; we're to the right of the screen but not far enough to wrap around..
004E17r 1  4C rr rr            : JMP @zigzag_A_right
004E1Ar 1                    @ZAR_ZIG_LEFT_SWITCH: ;PWOL_NEXT_ROW_A_LEFT_XL   ; -> next row is left, going up the screen ..  +0,-1
004E1Ar 1  A9 06                 LDA #TRY_AGAIN
004E1Cr 1  85 44                 STA PWOL_TRIES_COUNTER
004E1Er 1               ;         INY
004E1Er 1  38                    SEC
004E1Fr 1  A5 22                 LDA PWOL_TUB_PTR_AL
004E21r 1  E9 40                 SBC #64 ;   0,-1
004E23r 1  85 22                 STA PWOL_TUB_PTR_AL
004E25r 1  A5 23                 LDA PWOL_TUB_PTR_AH
004E27r 1  E9 00                 SBC #0
004E29r 1  C9 rr                 CMP #>TUB_WORLD ; are we inside the world still?
004E2Br 1  B0 03                 BCS :+
004E2Dr 1  4C rr rr              JMP @zigzag_B
004E30r 1  85 23               : STA PWOL_TUB_PTR_AH
004E32r 1               
004E32r 1  18                    CLC
004E33r 1  A5 26                 LDA PWOL_CURRENT_XL
004E35r 1  65 2E                 ADC PWOL_NEXT_ROW_A_LEFT_XL
004E37r 1  85 26                 STA PWOL_CURRENT_XL
004E39r 1  A5 27                 LDA PWOL_CURRENT_XH
004E3Br 1  65 2F                 ADC PWOL_NEXT_ROW_A_LEFT_XH
004E3Dr 1  85 27                 STA PWOL_CURRENT_XH
004E3Fr 1  AA                    TAX
004E40r 1  18                    CLC
004E41r 1  A5 28                 LDA PWOL_CURRENT_YL
004E43r 1  65 30                 ADC PWOL_NEXT_ROW_A_LEFT_YL
004E45r 1  85 28                 STA PWOL_CURRENT_YL
004E47r 1  A5 29                 LDA PWOL_CURRENT_YH
004E49r 1  65 31                 ADC PWOL_NEXT_ROW_A_LEFT_YH
004E4Br 1  80 21                 BRA @ZAR_ZIG_LEFT_SWITCH_CHECK
004E4Dr 1               
004E4Dr 1                  @ZAR_ZIG_LEFT_SWITCH_TRY_AGAIN:
004E4Dr 1  C6 44                 DEC PWOL_TRIES_COUNTER
004E4Fr 1  D0 03                 BNE @ZAR_ZIG_LEFT_SWITCH_TRY_AGAIN_GO_LEFT
004E51r 1  4C rr rr              JMP @zigzag_B
004E54r 1                  @ZAR_ZIG_LEFT_SWITCH_TRY_AGAIN_GO_LEFT:
004E54r 1  88                    DEY
004E55r 1  38                    SEC
004E56r 1  A5 26                 LDA PWOL_CURRENT_XL
004E58r 1  E5 2A                 SBC PWOL_ACROSS_ROW_XL
004E5Ar 1  85 26                 STA PWOL_CURRENT_XL
004E5Cr 1  A5 27                 LDA PWOL_CURRENT_XH
004E5Er 1  E5 2B                 SBC PWOL_ACROSS_ROW_XH
004E60r 1  85 27                 STA PWOL_CURRENT_XH
004E62r 1  AA                    TAX
004E63r 1  38                    SEC
004E64r 1  A5 28                 LDA PWOL_CURRENT_YL
004E66r 1  E5 2C                 SBC PWOL_ACROSS_ROW_YL
004E68r 1  85 28                 STA PWOL_CURRENT_YL
004E6Ar 1  A5 29                 LDA PWOL_CURRENT_YH
004E6Cr 1  E5 2D                 SBC PWOL_ACROSS_ROW_YH
004E6Er 1               
004E6Er 1                  @ZAR_ZIG_LEFT_SWITCH_CHECK:
004E6Er 1  85 29                 STA PWOL_CURRENT_YH
004E70r 1  C5 56                 CMP PWOL_BOT_CHECK
004E72r 1  90 04                 BCC :+      ;     if its within bottom definitely on screen, else check top as well..
004E74r 1  C9 F0                 CMP #SCREEN_OUT_TOP
004E76r 1  90 D5                 BCC @ZAR_ZIG_LEFT_SWITCH_TRY_AGAIN   ; its bottom_out <= Y < top out .. because negatives are bigger
004E78r 1  E0 A0               : CPX #SCREEN_OUT_RIGHT ; check against right side
004E7Ar 1  90 04                 BCC @zigzag_A_left
004E7Cr 1  E0 F0                 CPX #SCREEN_OUT_LEFT16
004E7Er 1  90 CD                 BCC @ZAR_ZIG_LEFT_SWITCH_TRY_AGAIN
004E80r 1               
004E80r 1               
004E80r 1               
004E80r 1                  @zigzag_A_left:
004E80r 1  C0 40                CPY #64  ;  make sure we don't go outside level..
004E82r 1  B0 6E                BCS @ZAL_NEXT ; if we're outside we'll just skip is OK
004E84r 1  B1 22                LDA (PWOL_TUB_PTR_AL),y
004E86r 1  C9 81                CMP #129
004E88r 1  B0 68                BCS @ZAL_NEXT ; we're outside level.
004E8Ar 1               
004E8Ar 1                       ; bytes 1 and 4 were updated when we cleared the object list
004E8Ar 1  EE rr rr             INC OBJECT_LIST_BYTE6_NEXT ; is there objects left to use as next?
004E8Dr 1  D0 04                BNE :++
004E8Fr 1  CE rr rr           : DEC OBJECT_LIST_BYTE6_NEXT ; so we can do this check again if out..
004E92r 1  60                   rts ; @WHAT_THE_WHAT ; we shouldn't be outside the screen...
004E93r 1  A6 29              : LDX PWOL_CURRENT_YH ;  current screenY .. to calculate effective Z for the buffer
004E95r 1  BD rr rr             LDA SCREEN_Y_TO_Z,x
004E98r 1  F0 F5                BEQ :-- ; we shouldn't be outside the screen...
004E9Ar 1  85 3E                STA PWOL_Z_STARTS_PTR  ; ok now that's primed to be at the start .. we want to grab whatever is at this buffer and save it to our new next..
004E9Cr 1  B2 3E                LDA (PWOL_Z_STARTS_PTR) ; get the current value here for the next ..
004E9Er 1  AE rr rr             LDX OBJECT_LIST_BYTE6_NEXT ; get index for this object
004EA1r 1  9D rr rr             STA OBJECT_LIST_BYTE6_NEXT,X ; old next becomes this object's next
004EA4r 1  8A                   TXA ; push new next to the Z buffer spot
004EA5r 1  92 3E                STA (PWOL_Z_STARTS_PTR) ;  and the new next gets saved back the Z_starts... otay.. start filling in data..
004EA7r 1                       ; bytes .1..4.6 filled in already..
004EA7r 1  AD rr rr             LDA WORLD_SPRITE_NUM
004EAAr 1  9D rr rr             STA OBJECT_LIST_BYTE0_ADDRLOW,X  ;   most of the time will be setting this anyway..
004EADr 1  B1 22                LDA (PWOL_TUB_PTR_AL),y     ; get value of world at this point - 0-127=height, 128=wall, 129+ invalid
004EAFr 1  10 08                BPL @ZAL_INSIDE_TUB
004EB1r 1                     @ZAL_HIT_WALL_OUCH:
004EB1r 1  AD rr rr               LDA WORLD_WALL_SPRITE_NUM
004EB4r 1  9D rr rr               STA OBJECT_LIST_BYTE0_ADDRLOW,X ; hit the wall, ouch.. write wall stuff
004EB7r 1  A9 56                  LDA #86 ; max height..
004EB9r 1                     @ZAL_INSIDE_TUB:
004EB9r 1  85 40                  STA PWOL_CONVERT_HEIGHTS ;
004EBBr 1  85 42                  STA PWOL_CONVERT_HEIGHTS_L;
004EBDr 1  38                     SEC
004EBEr 1  A5 28                  LDA PWOL_CURRENT_YL
004EC0r 1  F2 42                  SBC (PWOL_CONVERT_HEIGHTS_L)
004EC2r 1  A5 29                  LDA PWOL_CURRENT_YH ; set er up
004EC4r 1  F2 40                  SBC (PWOL_CONVERT_HEIGHTS)
004EC6r 1  C9 78                  CMP #SCREEN_OUT_BOTTOM    ;  are we even visible?
004EC8r 1  90 0E                  BCC :+
004ECAr 1  C5 55                  CMP PWOL_TOP_CHECK  ;     #SCREEN_OUT_TOP-50 ;PWOL_TOP_CHECK;
004ECCr 1  B0 0A                  BCS :+
004ECEr 1  CE rr rr               DEC OBJECT_LIST_BYTE6_NEXT
004ED1r 1  BD rr rr               LDA OBJECT_LIST_BYTE6_NEXT,X ; grab the old next value
004ED4r 1  92 3E                  STA (PWOL_Z_STARTS_PTR) ; patch the old one back in..
004ED6r 1  80 1A                  BRA @ZAL_NEXT ; and skip THIS
004ED8r 1                       :
004ED8r 1               
004ED8r 1               
004ED8r 1  9D rr rr               STA OBJECT_LIST_BYTE3_Y,X ; 01.34.6 filled in now
004EDBr 1  C5 54                  CMP PWOL_CENTER_Y_TOP ; is this above center on screen??
004EDDr 1  B0 0E                  BCS :+ ; is not covering us
004EDFr 1  A5 29                  LDA PWOL_CURRENT_YH
004EE1r 1  C5 53                  CMP PWOL_CENTER_Y
004EE3r 1  90 08                  BCC :+ ; its from ahead of us, OK
004EE5r 1                         ; it was from below and covers us ..
004EE5r 1  BD rr rr               LDA OBJECT_LIST_BYTE0_ADDRLOW,X
004EE8r 1  69 0F                  ADC #diff_sprite_to_transparent ; constant should be 1 less because carry is set
004EEAr 1  9D rr rr               STA OBJECT_LIST_BYTE0_ADDRLOW,X
004EEDr 1                         ;LDA #$D0
004EEDr 1                         ;STA OBJECT_LIST_BYTE5_SIZE,X ; 01.3456 done .
004EEDr 1  A5 27                : LDA PWOL_CURRENT_XH
004EEFr 1  9D rr rr               STA OBJECT_LIST_BYTE2_X,X    ; 0123456 OK - object is complete.
004EF2r 1                    @ZAL_NEXT:
004EF2r 1                        ; calc next to the LEFT
004EF2r 1  88                    DEY
004EF3r 1  38                    SEC
004EF4r 1  A5 26                 LDA PWOL_CURRENT_XL
004EF6r 1  E5 2A                 SBC PWOL_ACROSS_ROW_XL
004EF8r 1  85 26                 STA PWOL_CURRENT_XL
004EFAr 1  A5 27                 LDA PWOL_CURRENT_XH
004EFCr 1  E5 2B                 SBC PWOL_ACROSS_ROW_XH
004EFEr 1  85 27                 STA PWOL_CURRENT_XH
004F00r 1  AA                    TAX
004F01r 1  38                    SEC
004F02r 1  A5 28                 LDA PWOL_CURRENT_YL
004F04r 1  E5 2C                 SBC PWOL_ACROSS_ROW_YL
004F06r 1  85 28                 STA PWOL_CURRENT_YL
004F08r 1  A5 29                 LDA PWOL_CURRENT_YH
004F0Ar 1  E5 2D                 SBC PWOL_ACROSS_ROW_YH
004F0Cr 1  85 29                 STA PWOL_CURRENT_YH
004F0Er 1               
004F0Er 1               
004F0Er 1  C5 56                 CMP PWOL_BOT_CHECK
004F10r 1  90 04                 BCC :+      ;     if its within bottom definitely on screen, else check top as well..
004F12r 1  C9 F0                 CMP #SCREEN_OUT_TOP
004F14r 1  90 0B                 BCC @ZAL_ZIG_RIGHT_SWITCH   ; its bottom_out <= Y < top out .. because negatives are bigger
004F16r 1  E0 A0               : CPX #SCREEN_OUT_RIGHT ; check against right side
004F18r 1  90 04                 BCC :+                ; if its within right side then go do next thing..
004F1Ar 1  E0 F0                 CPX #SCREEN_OUT_LEFT16
004F1Cr 1  90 03                 BCC @ZAL_ZIG_RIGHT_SWITCH     ; we're to the right of the screen but not far enough to wrap around..
004F1Er 1  4C rr rr            : JMP @zigzag_A_left
004F21r 1               
004F21r 1                    @ZAL_ZIG_RIGHT_SWITCH: ; up/right is +1,+1  from where we is right now ..
004F21r 1  A9 06                 LDA #TRY_AGAIN
004F23r 1  85 44                 STA PWOL_TRIES_COUNTER
004F25r 1  C8                    INY
004F26r 1  38                    SEC
004F27r 1  A5 22                 LDA PWOL_TUB_PTR_AL
004F29r 1  E9 40                 SBC #64
004F2Br 1  85 22                 STA PWOL_TUB_PTR_AL
004F2Dr 1  A5 23                 LDA PWOL_TUB_PTR_AH
004F2Fr 1  E9 00                 SBC #0
004F31r 1  C9 rr                 CMP #>TUB_WORLD ; are we inside the world still?
004F33r 1  B0 03                 BCS :+
004F35r 1  4C rr rr              JMP @zigzag_B
004F38r 1  85 23               : STA PWOL_TUB_PTR_AH
004F3Ar 1               
004F3Ar 1               
004F3Ar 1  18                    CLC
004F3Br 1               
004F3Br 1  A5 26                 LDA PWOL_CURRENT_XL
004F3Dr 1  65 32                 ADC PWOL_NEXT_ROW_A_RIGHT_XL
004F3Fr 1  85 26                 STA PWOL_CURRENT_XL
004F41r 1               
004F41r 1  A5 27                 LDA PWOL_CURRENT_XH
004F43r 1  65 33                 ADC PWOL_NEXT_ROW_A_RIGHT_XH
004F45r 1  85 27                 STA PWOL_CURRENT_XH
004F47r 1  AA                    TAX
004F48r 1               
004F48r 1               
004F48r 1  18                    CLC
004F49r 1  A5 28                 LDA PWOL_CURRENT_YL
004F4Br 1  65 34                 ADC PWOL_NEXT_ROW_A_RIGHT_YL
004F4Dr 1  85 28                 STA PWOL_CURRENT_YL
004F4Fr 1  A5 29                 LDA PWOL_CURRENT_YH
004F51r 1  65 35                 ADC PWOL_NEXT_ROW_A_RIGHT_YH
004F53r 1  80 1E                 BRA @ZAL_ZIG_RIGHT_SWITCH_CHECK
004F55r 1               
004F55r 1               
004F55r 1               
004F55r 1                  @ZAL_ZIG_RIGHT_SWITCH_TRY_AGAIN:
004F55r 1  C6 44                 DEC PWOL_TRIES_COUNTER
004F57r 1  F0 2F                 BEQ @zigzag_B
004F59r 1                  @ZAL_ZIG_RIGHT_SWITCH_TRY_AGAIN_GO_RIGHT:
004F59r 1  C8                    INY
004F5Ar 1  18                    CLC
004F5Br 1  A5 26                 LDA PWOL_CURRENT_XL
004F5Dr 1  65 2A                 ADC PWOL_ACROSS_ROW_XL
004F5Fr 1  85 26                 STA PWOL_CURRENT_XL
004F61r 1  A5 27                 LDA PWOL_CURRENT_XH
004F63r 1  65 2B                 ADC PWOL_ACROSS_ROW_XH
004F65r 1  85 27                 STA PWOL_CURRENT_XH
004F67r 1  AA                    TAX
004F68r 1  18                    CLC
004F69r 1  A5 28                 LDA PWOL_CURRENT_YL
004F6Br 1  65 2C                 ADC PWOL_ACROSS_ROW_YL
004F6Dr 1  85 28                 STA PWOL_CURRENT_YL
004F6Fr 1  A5 29                 LDA PWOL_CURRENT_YH
004F71r 1  65 2D                 ADC PWOL_ACROSS_ROW_YH
004F73r 1                  @ZAL_ZIG_RIGHT_SWITCH_CHECK:
004F73r 1  85 29                 STA PWOL_CURRENT_YH
004F75r 1  C5 56                 CMP PWOL_BOT_CHECK
004F77r 1  90 04                 BCC :+      ;     if its within bottom definitely on screen, else check top as well..
004F79r 1  C9 F0                 CMP #SCREEN_OUT_TOP
004F7Br 1  90 D8                 BCC @ZAL_ZIG_RIGHT_SWITCH_TRY_AGAIN    ; its bottom_out <= Y < top out .. because negatives are bigger
004F7Dr 1  E0 A0               : CPX #SCREEN_OUT_RIGHT ; check against right side
004F7Fr 1  90 04                 BCC :+
004F81r 1  E0 F0                 CPX #SCREEN_OUT_LEFT16
004F83r 1  90 D0                 BCC @ZAL_ZIG_RIGHT_SWITCH_TRY_AGAIN
004F85r 1  4C rr rr            : JMP @zigzag_A_right
004F88r 1               
004F88r 1               
004F88r 1                 @zigzag_B: ; going to left and down the screen, including where we are currently..
004F88r 1  38                 SEC
004F89r 1  A5 45              LDA PWOL_START_XL
004F8Br 1  E5 2A              SBC PWOL_ACROSS_ROW_XL
004F8Dr 1  85 26              STA PWOL_CURRENT_XL
004F8Fr 1  A5 47              LDA PWOL_START_XH
004F91r 1  E5 2B              SBC PWOL_ACROSS_ROW_XH
004F93r 1  85 27              STA PWOL_CURRENT_XH
004F95r 1               
004F95r 1               
004F95r 1  38                 SEC
004F96r 1  A5 46              LDA PWOL_START_YL
004F98r 1  E5 2C              SBC PWOL_ACROSS_ROW_YL
004F9Ar 1  85 28              STA PWOL_CURRENT_YL
004F9Cr 1  A5 48              LDA PWOL_START_YH
004F9Er 1  E5 2D              SBC PWOL_ACROSS_ROW_YH
004FA0r 1  85 29              STA PWOL_CURRENT_YH
004FA2r 1               
004FA2r 1  AC rr rr           LDY camera_cell_x   ;  eh voila! we haz pointer to ze row to start on .. woot!
004FA5r 1  88                 DEY ; start left
004FA6r 1               
004FA6r 1                  @zigzag_B_left:
004FA6r 1  C0 40                CPY #64  ;  make sure we don't go outside level..
004FA8r 1  B0 6E                BCS @ZBL_NEXT ; if we're outside we'll just skip is OK
004FAAr 1  B1 24                LDA (PWOL_TUB_PTR_BL),y
004FACr 1  C9 81                CMP #129
004FAEr 1  B0 68                BCS @ZBL_NEXT ; we're outside level.
004FB0r 1               
004FB0r 1                       ; bytes 1 and 4 were updated when we cleared the object list
004FB0r 1  EE rr rr             INC OBJECT_LIST_BYTE6_NEXT ; is there objects left to use as next?
004FB3r 1  D0 04                BNE :++
004FB5r 1  CE rr rr           : DEC OBJECT_LIST_BYTE6_NEXT ; so we can do this check again if out..
004FB8r 1  60                   rts ; @WHAT_THE_WHAT ; we shouldn't be outside the screen...
004FB9r 1  A6 29              : LDX PWOL_CURRENT_YH ;  current screenY .. to calculate effective Z for the buffer
004FBBr 1  BD rr rr             LDA SCREEN_Y_TO_Z,x
004FBEr 1  F0 F5                BEQ :-- ; we shouldn't be outside the screen...
004FC0r 1  85 3E                STA PWOL_Z_STARTS_PTR  ; ok now that's primed to be at the start .. we want to grab whatever is at this buffer and save it to our new next..
004FC2r 1  B2 3E                LDA (PWOL_Z_STARTS_PTR) ; get the current value here for the next ..
004FC4r 1  AE rr rr             LDX OBJECT_LIST_BYTE6_NEXT ; get index for this object
004FC7r 1  9D rr rr             STA OBJECT_LIST_BYTE6_NEXT,X ; old next becomes this object's next
004FCAr 1  8A                   TXA ; push new next to the Z buffer spot
004FCBr 1  92 3E                STA (PWOL_Z_STARTS_PTR) ;  and the new next gets saved back the Z_starts... otay.. start filling in data..
004FCDr 1                       ; bytes .1..4.6 filled in already..
004FCDr 1  AD rr rr             LDA WORLD_SPRITE_NUM
004FD0r 1  9D rr rr             STA OBJECT_LIST_BYTE0_ADDRLOW,X  ;   most of the time will be setting this anyway..
004FD3r 1  B1 24                LDA (PWOL_TUB_PTR_BL),y     ; get value of world at this point - 0-127=height, 128=wall, 129+ invalid
004FD5r 1  10 08                BPL @ZBL_INSIDE_TUB
004FD7r 1                     @ZBL_HIT_WALL_OUCH:
004FD7r 1  AD rr rr               LDA WORLD_WALL_SPRITE_NUM
004FDAr 1  9D rr rr               STA OBJECT_LIST_BYTE0_ADDRLOW,X ; hit the wall, ouch.. write wall stuff
004FDDr 1  A9 56                  LDA #86 ; max height..
004FDFr 1                     @ZBL_INSIDE_TUB:
004FDFr 1  85 40                  STA PWOL_CONVERT_HEIGHTS ;
004FE1r 1  85 42                  STA PWOL_CONVERT_HEIGHTS_L;
004FE3r 1  38                     SEC
004FE4r 1  A5 28                  LDA PWOL_CURRENT_YL
004FE6r 1  F2 42                  SBC (PWOL_CONVERT_HEIGHTS_L)
004FE8r 1  A5 29                  LDA PWOL_CURRENT_YH ; set er up
004FEAr 1  F2 40                  SBC (PWOL_CONVERT_HEIGHTS)
004FECr 1  C9 78                  CMP #SCREEN_OUT_BOTTOM    ;  are we even visible?
004FEEr 1  90 0E                  BCC :+
004FF0r 1  C5 55                  CMP PWOL_TOP_CHECK  ;     #SCREEN_OUT_TOP-50 ;PWOL_TOP_CHECK;
004FF2r 1  B0 0A                  BCS :+
004FF4r 1  CE rr rr               DEC OBJECT_LIST_BYTE6_NEXT
004FF7r 1  BD rr rr               LDA OBJECT_LIST_BYTE6_NEXT,X ; grab the old next value
004FFAr 1  92 3E                  STA (PWOL_Z_STARTS_PTR) ; patch the old one back in..
004FFCr 1  80 1A                  BRA @ZBL_NEXT ; and skip THIS
004FFEr 1                       :
004FFEr 1               
004FFEr 1  9D rr rr               STA OBJECT_LIST_BYTE3_Y,X ; 01.34.6 filled in now
005001r 1  C5 54                  CMP PWOL_CENTER_Y_TOP ; is this above center on screen??
005003r 1  B0 0E                  BCS :+ ; is not covering us
005005r 1  A5 29                  LDA PWOL_CURRENT_YH
005007r 1  C5 53                  CMP PWOL_CENTER_Y
005009r 1  90 08                  BCC :+ ; its from ahead of us, OK
00500Br 1                         ; it was from below and covers us ..
00500Br 1  BD rr rr               LDA OBJECT_LIST_BYTE0_ADDRLOW,X
00500Er 1  69 0F                  ADC #diff_sprite_to_transparent ; constant should be 1 less because carry is set
005010r 1  9D rr rr               STA OBJECT_LIST_BYTE0_ADDRLOW,X
005013r 1                         ;LDA #$D0
005013r 1                         ;STA OBJECT_LIST_BYTE5_SIZE,X ; 01.3456 done .
005013r 1  A5 27                : LDA PWOL_CURRENT_XH
005015r 1  9D rr rr               STA OBJECT_LIST_BYTE2_X,X    ; 0123456 OK - object is complete.
005018r 1                    @ZBL_NEXT:
005018r 1                        ; calc next to the LEFT
005018r 1  88                    DEY
005019r 1  38                    SEC
00501Ar 1  A5 26                 LDA PWOL_CURRENT_XL
00501Cr 1  E5 2A                 SBC PWOL_ACROSS_ROW_XL
00501Er 1  85 26                 STA PWOL_CURRENT_XL
005020r 1  A5 27                 LDA PWOL_CURRENT_XH
005022r 1  E5 2B                 SBC PWOL_ACROSS_ROW_XH
005024r 1  85 27                 STA PWOL_CURRENT_XH
005026r 1  AA                    TAX
005027r 1  38                    SEC
005028r 1  A5 28                 LDA PWOL_CURRENT_YL
00502Ar 1  E5 2C                 SBC PWOL_ACROSS_ROW_YL
00502Cr 1  85 28                 STA PWOL_CURRENT_YL
00502Er 1  A5 29                 LDA PWOL_CURRENT_YH
005030r 1  E5 2D                 SBC PWOL_ACROSS_ROW_YH
005032r 1  85 29                 STA PWOL_CURRENT_YH
005034r 1               
005034r 1               
005034r 1  C5 56                 CMP PWOL_BOT_CHECK
005036r 1  90 04                 BCC :+      ;     if its within bottom definitely on screen, else check top as well..
005038r 1  C9 F0                 CMP #SCREEN_OUT_TOP
00503Ar 1  90 0B                 BCC @ZBL_ZIG_RIGHT_SWITCH     ; its bottom_out <= Y < top out .. because negatives are bigger
00503Cr 1  E0 A0               : CPX #SCREEN_OUT_RIGHT ; check against right side
00503Er 1  90 04                 BCC :+                ; if its within right side then go do next thing..
005040r 1  E0 F0                 CPX #SCREEN_OUT_LEFT16
005042r 1  90 03                 BCC @ZBL_ZIG_RIGHT_SWITCH     ; we're to the right of the screen but not far enough to wrap around..
005044r 1  4C rr rr            : JMP @zigzag_B_left
005047r 1               
005047r 1               
005047r 1               
005047r 1                    @ZBL_ZIG_RIGHT_SWITCH: ; DOWN/LEFT to start right is is 0,+1  from where we is right now ..
005047r 1                        ;INY
005047r 1                        ;INY
005047r 1  A9 06                 LDA #TRY_AGAIN
005049r 1  85 44                 STA PWOL_TRIES_COUNTER
00504Br 1  18                    CLC
00504Cr 1  A5 24                 LDA PWOL_TUB_PTR_BL
00504Er 1  69 40                 ADC #64
005050r 1  85 24                 STA PWOL_TUB_PTR_BL
005052r 1  A5 25                 LDA PWOL_TUB_PTR_BH
005054r 1  69 00                 ADC #0
005056r 1  C9 rr                 CMP #>TUB_WORLD+8
005058r 1  90 01                 BCC :+
00505Ar 1  60                    rts
00505Br 1  85 25               : STA PWOL_TUB_PTR_BH
00505Dr 1               
00505Dr 1               
00505Dr 1  18                    CLC
00505Er 1               
00505Er 1  A5 26                 LDA PWOL_CURRENT_XL
005060r 1  65 3A                 ADC PWOL_NEXT_ROW_B_RIGHT_XL
005062r 1  85 26                 STA PWOL_CURRENT_XL
005064r 1               
005064r 1  A5 27                 LDA PWOL_CURRENT_XH
005066r 1  65 3B                 ADC PWOL_NEXT_ROW_B_RIGHT_XH
005068r 1  85 27                 STA PWOL_CURRENT_XH
00506Ar 1  AA                    TAX
00506Br 1               
00506Br 1               
00506Br 1  18                    CLC
00506Cr 1  A5 28                 LDA PWOL_CURRENT_YL
00506Er 1  65 3C                 ADC PWOL_NEXT_ROW_B_RIGHT_YL
005070r 1  85 28                 STA PWOL_CURRENT_YL
005072r 1  A5 29                 LDA PWOL_CURRENT_YH
005074r 1  65 3D                 ADC PWOL_NEXT_ROW_B_RIGHT_YH
005076r 1  80 1F                 BRA @ZBL_ZIG_RIGHT_SWITCH_CHECK
005078r 1               
005078r 1                  @ZBL_ZIG_RIGHT_SWITCH_TRY_AGAIN:
005078r 1  C6 44                 DEC PWOL_TRIES_COUNTER
00507Ar 1  D0 01                 BNE @ZBL_ZIG_RIGHT_SWITCH_TRY_AGAIN_GO_RIGHT
00507Cr 1                  @ZBL_RTS:
00507Cr 1               ;          STZ VERA_data0
00507Cr 1                ;         STZ VERA_data0
00507Cr 1                 ;        STZ VERA_data0
00507Cr 1                  ;       STZ VERA_data0
00507Cr 1  60                 rts
00507Dr 1                  @ZBL_ZIG_RIGHT_SWITCH_TRY_AGAIN_GO_RIGHT:
00507Dr 1  C8                    INY
00507Er 1  18                    CLC
00507Fr 1  A5 26                 LDA PWOL_CURRENT_XL
005081r 1  65 2A                 ADC PWOL_ACROSS_ROW_XL
005083r 1  85 26                 STA PWOL_CURRENT_XL
005085r 1  A5 27                 LDA PWOL_CURRENT_XH
005087r 1  65 2B                 ADC PWOL_ACROSS_ROW_XH
005089r 1  85 27                 STA PWOL_CURRENT_XH
00508Br 1  AA                    TAX
00508Cr 1  18                    CLC
00508Dr 1  A5 28                 LDA PWOL_CURRENT_YL
00508Fr 1  65 2C                 ADC PWOL_ACROSS_ROW_YL
005091r 1  85 28                 STA PWOL_CURRENT_YL
005093r 1  A5 29                 LDA PWOL_CURRENT_YH
005095r 1  65 2D                 ADC PWOL_ACROSS_ROW_YH
005097r 1                  @ZBL_ZIG_RIGHT_SWITCH_CHECK:
005097r 1  85 29                 STA PWOL_CURRENT_YH
005099r 1  C5 56                 CMP PWOL_BOT_CHECK
00509Br 1  90 04                 BCC :+      ;     if its within bottom definitely on screen, else check top as well..
00509Dr 1  C9 F0                 CMP #SCREEN_OUT_TOP
00509Fr 1  90 D7                 BCC @ZBL_ZIG_RIGHT_SWITCH_TRY_AGAIN    ; its bottom_out <= Y < top out .. because negatives are bigger
0050A1r 1  E0 A0               : CPX #SCREEN_OUT_RIGHT ; check against right side
0050A3r 1  90 04                 BCC @zigzag_B_right
0050A5r 1  E0 F0                 CPX #SCREEN_OUT_LEFT16
0050A7r 1  90 CF                 BCC @ZBL_ZIG_RIGHT_SWITCH_TRY_AGAIN
0050A9r 1               
0050A9r 1               
0050A9r 1               
0050A9r 1                   @zigzag_B_right:
0050A9r 1  C0 40                CPY #64  ;  make sure we don't go outside level..
0050ABr 1  B0 6E                BCS @ZBR_NEXT ; if we're outside we'll just skip is OK
0050ADr 1  B1 24                LDA (PWOL_TUB_PTR_BL),y
0050AFr 1  C9 81                CMP #129
0050B1r 1  B0 68                BCS @ZBR_NEXT ; we're outside level.
0050B3r 1               
0050B3r 1                       ; bytes 1 and 4 were updated when we cleared the object list
0050B3r 1  EE rr rr             INC OBJECT_LIST_BYTE6_NEXT ; is there objects left to use as next?
0050B6r 1  D0 04                BNE :++
0050B8r 1  CE rr rr           : DEC OBJECT_LIST_BYTE6_NEXT ; so we can do this check again if out..
0050BBr 1  60                   rts ; @WHAT_THE_WHAT ; we shouldn't be outside the screen...
0050BCr 1  A6 29              : LDX PWOL_CURRENT_YH ;  current screenY .. to calculate effective Z for the buffer
0050BEr 1  BD rr rr             LDA SCREEN_Y_TO_Z,x
0050C1r 1  F0 F5                BEQ :-- ; we shouldn't be outside the screen...
0050C3r 1  85 3E                STA PWOL_Z_STARTS_PTR  ; ok now that's primed to be at the start .. we want to grab whatever is at this buffer and save it to our new next..
0050C5r 1  B2 3E                LDA (PWOL_Z_STARTS_PTR) ; get the current value here for the next ..
0050C7r 1  AE rr rr             LDX OBJECT_LIST_BYTE6_NEXT ; get index for this object
0050CAr 1  9D rr rr             STA OBJECT_LIST_BYTE6_NEXT,X ; old next becomes this object's next
0050CDr 1  8A                   TXA ; push new next to the Z buffer spot
0050CEr 1  92 3E                STA (PWOL_Z_STARTS_PTR) ;  and the new next gets saved back the Z_starts... otay.. start filling in data..
0050D0r 1                       ; bytes .1..4.6 filled in already..
0050D0r 1  AD rr rr             LDA WORLD_SPRITE_NUM
0050D3r 1  9D rr rr             STA OBJECT_LIST_BYTE0_ADDRLOW,X  ;   most of the time will be setting this anyway..
0050D6r 1  B1 24                LDA (PWOL_TUB_PTR_BL),y     ; get value of world at this point - 0-127=height, 128=wall, 129+ invalid
0050D8r 1  10 08                BPL @ZBR_INSIDE_TUB
0050DAr 1                     @ZBR_HIT_WALL_OUCH:
0050DAr 1  AD rr rr               LDA WORLD_WALL_SPRITE_NUM
0050DDr 1  9D rr rr               STA OBJECT_LIST_BYTE0_ADDRLOW,X ; hit the wall, ouch.. write wall stuff
0050E0r 1  A9 56                  LDA #86 ; max height..
0050E2r 1                     @ZBR_INSIDE_TUB:
0050E2r 1  85 40                  STA PWOL_CONVERT_HEIGHTS ;
0050E4r 1  85 42                  STA PWOL_CONVERT_HEIGHTS_L;
0050E6r 1  38                     SEC
0050E7r 1  A5 28                  LDA PWOL_CURRENT_YL
0050E9r 1  F2 42                  SBC (PWOL_CONVERT_HEIGHTS_L)
0050EBr 1  A5 29                  LDA PWOL_CURRENT_YH ; set er up
0050EDr 1  F2 40                  SBC (PWOL_CONVERT_HEIGHTS)
0050EFr 1  C9 78                  CMP #SCREEN_OUT_BOTTOM    ;  are we even visible?
0050F1r 1  90 0E                  BCC :+
0050F3r 1  C5 55                  CMP PWOL_TOP_CHECK  ;     #SCREEN_OUT_TOP-50 ;PWOL_TOP_CHECK;
0050F5r 1  B0 0A                  BCS :+
0050F7r 1  CE rr rr               DEC OBJECT_LIST_BYTE6_NEXT
0050FAr 1  BD rr rr               LDA OBJECT_LIST_BYTE6_NEXT,X ; grab the old next value
0050FDr 1  92 3E                  STA (PWOL_Z_STARTS_PTR) ; patch the old one back in..
0050FFr 1  80 1A                  BRA @ZBR_NEXT ; and skip THIS
005101r 1                       :
005101r 1               
005101r 1               
005101r 1  9D rr rr               STA OBJECT_LIST_BYTE3_Y,X ; 01.34.6 filled in now
005104r 1  C5 54                  CMP PWOL_CENTER_Y_TOP ; is this above center on screen??
005106r 1  B0 0E                  BCS :+ ; is not covering us
005108r 1  A5 29                  LDA PWOL_CURRENT_YH
00510Ar 1  C5 53                  CMP PWOL_CENTER_Y
00510Cr 1  90 08                  BCC :+ ; its from ahead of us, OK
00510Er 1                         ; it was from below and covers us ..
00510Er 1  BD rr rr               LDA OBJECT_LIST_BYTE0_ADDRLOW,X
005111r 1  69 0F                  ADC #diff_sprite_to_transparent ; constant should be 1 less because carry is set
005113r 1  9D rr rr               STA OBJECT_LIST_BYTE0_ADDRLOW,X
005116r 1                         ;LDA #$D0
005116r 1                         ;STA OBJECT_LIST_BYTE5_SIZE,X ; 01.3456 done .
005116r 1  A5 27                : LDA PWOL_CURRENT_XH
005118r 1  9D rr rr               STA OBJECT_LIST_BYTE2_X,X    ; 0123456 OK - object is complete.
00511Br 1                    @ZBR_NEXT:
00511Br 1                        ; calc next to the right..
00511Br 1  C8                    INY
00511Cr 1  18                    CLC
00511Dr 1  A5 26                 LDA PWOL_CURRENT_XL
00511Fr 1  65 2A                 ADC PWOL_ACROSS_ROW_XL
005121r 1  85 26                 STA PWOL_CURRENT_XL
005123r 1  A5 27                 LDA PWOL_CURRENT_XH
005125r 1  65 2B                 ADC PWOL_ACROSS_ROW_XH
005127r 1  85 27                 STA PWOL_CURRENT_XH
005129r 1  AA                    TAX
00512Ar 1  18                    CLC
00512Br 1  A5 28                 LDA PWOL_CURRENT_YL
00512Dr 1  65 2C                 ADC PWOL_ACROSS_ROW_YL
00512Fr 1  85 28                 STA PWOL_CURRENT_YL
005131r 1  A5 29                 LDA PWOL_CURRENT_YH
005133r 1  65 2D                 ADC PWOL_ACROSS_ROW_YH
005135r 1  85 29                 STA PWOL_CURRENT_YH
005137r 1               
005137r 1               
005137r 1  C5 56                 CMP PWOL_BOT_CHECK
005139r 1  90 04                 BCC :+      ;     if its within bottom definitely on screen, else check top as well..
00513Br 1  C9 F0                 CMP #SCREEN_OUT_TOP
00513Dr 1  90 0B                 BCC @ZBR_ZIG_LEFT_SWITCH     ; its bottom_out <= Y < top out .. because negatives are bigger
00513Fr 1  E0 A0               : CPX #SCREEN_OUT_RIGHT ; check against right side
005141r 1  90 04                 BCC :+                ; if its within right side then go do next thing..
005143r 1  E0 F0                 CPX #SCREEN_OUT_LEFT16
005145r 1  90 03                 BCC @ZBR_ZIG_LEFT_SWITCH        ; we're to the right of the screen but not far enough to wrap around..
005147r 1  4C rr rr            : JMP @zigzag_B_right
00514Ar 1               
00514Ar 1               
00514Ar 1               
00514Ar 1                    @ZBR_ZIG_LEFT_SWITCH: ;PWOL_NEXT_ROW_A_LEFT_XL   ; -> next row is left, going down the screen ..  +1,+1
00514Ar 1  A9 06                 LDA #TRY_AGAIN
00514Cr 1  85 44                 STA PWOL_TRIES_COUNTER
00514Er 1  88                   DEY ; have to go this to match where the thing is going .. 0,0
00514Fr 1  18                    CLC
005150r 1  A5 24                 LDA PWOL_TUB_PTR_BL
005152r 1  69 40                 ADC #64 ;   0,-1
005154r 1  85 24                 STA PWOL_TUB_PTR_BL
005156r 1  A5 25                 LDA PWOL_TUB_PTR_BH
005158r 1  69 00                 ADC #0
00515Ar 1  C9 rr                 CMP #>TUB_WORLD+8
00515Cr 1  90 01                 BCC :+
00515Er 1  60                    rts
00515Fr 1  85 25               : STA PWOL_TUB_PTR_BH
005161r 1               
005161r 1  18                    CLC
005162r 1  A5 26                 LDA PWOL_CURRENT_XL
005164r 1  65 36                 ADC PWOL_NEXT_ROW_B_LEFT_XL
005166r 1  85 26                 STA PWOL_CURRENT_XL
005168r 1  A5 27                 LDA PWOL_CURRENT_XH
00516Ar 1  65 37                 ADC PWOL_NEXT_ROW_B_LEFT_XH
00516Cr 1  85 27                 STA PWOL_CURRENT_XH
00516Er 1  AA                    TAX
00516Fr 1  18                    CLC
005170r 1  A5 28                 LDA PWOL_CURRENT_YL
005172r 1  65 38                 ADC PWOL_NEXT_ROW_B_LEFT_YL
005174r 1  85 28                 STA PWOL_CURRENT_YL
005176r 1  A5 29                 LDA PWOL_CURRENT_YH
005178r 1  65 39                 ADC PWOL_NEXT_ROW_B_LEFT_YH
00517Ar 1  80 1F                 BRA @ZBR_ZIG_LEFT_SWITCH_CHECK
00517Cr 1               
00517Cr 1               
00517Cr 1               
00517Cr 1                  @ZBR_ZIG_LEFT_SWITCH_TRY_AGAIN:
00517Cr 1  C6 44                 DEC PWOL_TRIES_COUNTER
00517Er 1  D0 01                 BNE @ZBR_ZIG_LEFT_SWITCH_TRY_AGAIN_GO_LEFT
005180r 1                  @ZBR_RTS:
005180r 1               ;          STZ VERA_data0
005180r 1               ;          STZ VERA_data0
005180r 1               ;          STZ VERA_data0
005180r 1               ;          STZ VERA_data0
005180r 1  60                    rts
005181r 1                  @ZBR_ZIG_LEFT_SWITCH_TRY_AGAIN_GO_LEFT:
005181r 1  88                    DEY
005182r 1  38                    SEC
005183r 1  A5 26                 LDA PWOL_CURRENT_XL
005185r 1  E5 2A                 SBC PWOL_ACROSS_ROW_XL
005187r 1  85 26                 STA PWOL_CURRENT_XL
005189r 1  A5 27                 LDA PWOL_CURRENT_XH
00518Br 1  E5 2B                 SBC PWOL_ACROSS_ROW_XH
00518Dr 1  85 27                 STA PWOL_CURRENT_XH
00518Fr 1  AA                    TAX
005190r 1  38                    SEC
005191r 1  A5 28                 LDA PWOL_CURRENT_YL
005193r 1  E5 2C                 SBC PWOL_ACROSS_ROW_YL
005195r 1  85 28                 STA PWOL_CURRENT_YL
005197r 1  A5 29                 LDA PWOL_CURRENT_YH
005199r 1  E5 2D                 SBC PWOL_ACROSS_ROW_YH
00519Br 1               
00519Br 1               @ZBR_ZIG_LEFT_SWITCH_CHECK:
00519Br 1  85 29                 STA PWOL_CURRENT_YH
00519Dr 1  C5 56                 CMP PWOL_BOT_CHECK
00519Fr 1  90 04                 BCC :+      ;     if its within bottom definitely on screen, else check top as well..
0051A1r 1  C9 F0                 CMP #SCREEN_OUT_TOP
0051A3r 1  90 D7                 BCC @ZBR_ZIG_LEFT_SWITCH_TRY_AGAIN   ; its bottom_out <= Y < top out .. because negatives are bigger
0051A5r 1  E0 A0               : CPX #SCREEN_OUT_RIGHT ; check against right side
0051A7r 1  90 04                 BCC :+
0051A9r 1  E0 F0                 CPX #SCREEN_OUT_LEFT16
0051ABr 1  90 CF                 BCC @ZBR_ZIG_LEFT_SWITCH_TRY_AGAIN
0051ADr 1  4C rr rr            : JMP @zigzag_B_left
0051B0r 1               
0051B0r 1               
0051B0r 1               draw_object_list:
0051B0r 1  AC rr rr          LDY NUM_AVAIL_SPRITES ; num sprites can write
0051B3r 1  D0 03             BNE :+
0051B5r 1  4C rr rr          JMP draw_object_list_to_BUFFER
0051B8r 1                  :
0051B8r 1  AD rr rr         LDA NUM_RESERVED_SPRITES
0051BBr 1               ;    INC VERA_LOCK
0051BBr 1               ;    BNE @unlock_vera   there's no actual way to get here and not have vera unlock.. s
0051BBr 1               ;  so instead, we're going to DEC the VERA_LOCK after the new frame is ready, which is after this function..
0051BBr 1               
0051BBr 1               
0051BBr 1               
0051BBr 1               
0051BBr 1  9C 25 9F         STZ VERA_ctrl
0051BEr 1  64 22            STZ ZP_PTR
0051C0r 1  0A               ASL
0051C1r 1  26 22            ROL ZP_PTR
0051C3r 1  0A               ASL
0051C4r 1  26 22            ROL ZP_PTR
0051C6r 1  0A               ASL
0051C7r 1  26 22            ROL ZP_PTR
0051C9r 1  8D 20 9F         STA VERA_addr_low
0051CCr 1  18               CLC
0051CDr 1  A5 22            LDA ZP_PTR
0051CFr 1  69 EC            ADC #>VRAM_SPRITE_BUF;  #>VRAM_SPRITE_BUF ; #>VRAM_sprite_attributes;
0051D1r 1  8D 21 9F         sta VERA_addr_high
0051D4r 1  A9 11            lda #$11
0051D6r 1  8D 22 9F         sta VERA_addr_bank
0051D9r 1  AD rr rr         LDA SPRITE_OBJECT_ENABLE
0051DCr 1  D0 22            BNE @SET_Z_PTR
0051DEr 1  A9 01            LDA #1
0051E0r 1  A2 0C            LDX #$0C
0051E2r 1  9C 23 9F        : STZ VERA_data0  ; addr low
0051E5r 1  8D 23 9F          STA VERA_data0  ; mod/addr_hi
0051E8r 1  9C 23 9F          STZ VERA_data0  ; xl
0051EBr 1  9C 23 9F          STZ VERA_data0  ; Xh
0051EEr 1  9C 23 9F          STZ VERA_data0  ; yl
0051F1r 1  9C 23 9F          STZ VERA_data0  ; yh
0051F4r 1  8E 23 9F          STX VERA_data0
0051F7r 1  9C 23 9F          STZ VERA_data0
0051FAr 1  88                DEY
0051FBr 1  D0 E5             BNE :-
0051FDr 1  4C rr rr         JMP draw_object_list_to_BUFFER
005200r 1               
005200r 1               
005200r 1               @SET_Z_PTR:
005200r 1  64 22            STZ ZP_PTR
005202r 1  A9 rr            LDA #>OBJECT_LIST_Z_START_POINTERS
005204r 1  85 23            STA ZP_PTR+1
005206r 1               
005206r 1               
005206r 1                 @NEXT_Z: ; Z=0 is invalid...
005206r 1  E6 22              INC ZP_PTR
005208r 1  D0 1C              BNE @Z_LOOP
00520Ar 1  AD 23 9F           : LDA VERA_data0
00520Dr 1  AD 23 9F             LDA VERA_data0
005210r 1  9C 23 9F             STZ VERA_data0
005213r 1  9C 23 9F             STZ VERA_data0
005216r 1  AD 23 9F             LDA VERA_data0
005219r 1  AD 23 9F             LDA VERA_data0
00521Cr 1  AD 23 9F             LDA VERA_data0
00521Fr 1  AD 23 9F             LDA VERA_data0
005222r 1  88                   DEY
005223r 1  D0 E5                BNE :-
005225r 1                  @rts:
005225r 1  60                 rts
005226r 1                 @Z_LOOP:
005226r 1  B2 22              LDA (ZP_PTR) ; get our first victim
005228r 1  AA                 TAX
005229r 1  A9 00              LDA #0
00522Br 1  92 22              STA (ZP_PTR) ; zero this Z_next for now
00522Dr 1  8A                 TXA
00522Er 1                    @OBJ_LOOP:
00522Er 1  AA                    TAX
00522Fr 1  F0 D5                 BEQ @NEXT_Z ; got a bum next pointer there ...
005231r 1  BD rr rr              LDA OBJECT_LIST_BYTE0_ADDRLOW,X
005234r 1  8D 23 9F              STA VERA_data0
005237r 1  BD rr rr              LDA OBJECT_LIST_BYTE1_MODE,x
00523Ar 1  8D 23 9F              STA VERA_data0
00523Dr 1  BD rr rr              LDA OBJECT_LIST_BYTE2_X,x
005240r 1  8D 23 9F              STA VERA_data0
005243r 1  C9 A0                 CMP #SCREEN_OUT_RIGHT
005245r 1  A9 00                 LDA #0
005247r 1  90 02                 BCC :+
005249r 1  A9 FF                 LDA #$FF
00524Br 1  8D 23 9F            : STA VERA_data0
00524Er 1               
00524Er 1  BD rr rr              LDA OBJECT_LIST_BYTE3_Y,x
005251r 1  8D 23 9F              STA VERA_data0
005254r 1  C9 78                 CMP #SCREEN_OUT_BOTTOM
005256r 1  A9 00                 LDA #0
005258r 1  90 02                 BCC :+
00525Ar 1  A9 FF                 LDA #$FF
00525Cr 1  8D 23 9F            : STA VERA_data0
00525Fr 1  BD rr rr              LDA OBJECT_LIST_BYTE4_ZFLIPS,x
005262r 1  8D 23 9F              STA VERA_data0
005265r 1  BD rr rr              LDA OBJECT_LIST_BYTE5_SIZE,x
005268r 1  8D 23 9F              STA VERA_data0
00526Br 1  BD rr rr              LDA OBJECT_LIST_BYTE6_NEXT,x
00526Er 1  88                    DEY ; decrement that Y
00526Fr 1  D0 BD                 BNE @OBJ_LOOP ; still sprite slots left.. woot!
005271r 1  92 22                 STA (ZP_PTR) ; oops.. save that last thing and exit..
005273r 1               draw_object_list_to_BUFFER:
005273r 1               DOLB_ZTRACKER = ZP_PTR
005273r 1               DOLB_ZTRACKERH = ZP_PTR+1
005273r 1               DOLB_BUFFER_HIGH_BYTE = ZP_PTR+2
005273r 1               DOLB_CALC_DEST_LOW = ZP_PTR+3
005273r 1               DOLB_CALC_DEST_HIGH = ZP_PTR+4
005273r 1               DOLB_CALC_SCRATCH = ZP_PTR+5
005273r 1               DOLB_STOP_BOTTOM = ZP_PTR+6
005273r 1               DOLB_Y_CALC_POINTER = ZP_PTR+7
005273r 1               DOLB_Y_CALC_POINTERH = ZP_PTR+8
005273r 1               
005273r 1  A9 0C           LDA #12
005275r 1  8D 25 9F        STA VERA_ctrl
005278r 1  9C 29 9F        STZ FX_CACHE_L ; zero out the cache bytes..
00527Br 1  9C 2A 9F        STZ FX_CACHE_M
00527Er 1  9C 2B 9F        STZ FX_CACHE_H
005281r 1  9C 2C 9F        STZ FX_CACHE_U
005284r 1               
005284r 1  A9 04           LDA #4  ;    DCSEL 2 with address select 0.. to be used as destination..
005286r 1  8D 25 9F        STA VERA_ctrl
005289r 1  9C 2C 9F        STZ FX_MULT
00528Cr 1  A9 60           LDA #%01100000
00528Er 1  8D 29 9F        STA FX_CTRL ;     cache write enable, cache fill and other stuff disabled
005291r 1               
005291r 1  9C 20 9F        STZ VERA_addr_low
005294r 1               ;        A        B     CURRENT BITMAP BUFFER
005294r 1               ;   0   display  dirty    A is being displayed, B to be drawn on
005294r 1               ;  64   display  ready    B  is ready for swap
005294r 1               ; 128   dirty    display  B is being displayed, A to be drawn on
005294r 1               ; 192   ready    display  A  is ready for swap
005294r 1               
005294r 1  64 29           STZ DOLB_Y_CALC_POINTER
005296r 1  AD rr rr        LDA CURRENT_BITMAP_BUFFER
005299r 1  10 08           BPL @DRAW_ON_B
00529Br 1               @DRAW_ON_A:
00529Br 1  A9 18           LDA #>VRAM_BITMAP_LAYERA
00529Dr 1  A2 80           LDX #>VRAM_BITMAP_LAYERB
00529Fr 1  A0 rr           LDY #>BUFFER_A_OFFSETS_HIGH
0052A1r 1  80 06           BRA @GO_DRAW
0052A3r 1               @DRAW_ON_B:
0052A3r 1  A9 80           LDA #>VRAM_BITMAP_LAYERB
0052A5r 1  A2 E4           LDX #>VRAM_TEXT_SCREEN
0052A7r 1  A0 rr           LDY #>BUFFER_B_OFFSETS_HIGH
0052A9r 1               @GO_DRAW:
0052A9r 1  85 24           STA DOLB_BUFFER_HIGH_BYTE
0052ABr 1  CA              DEX
0052ACr 1  86 28           STX DOLB_STOP_BOTTOM
0052AEr 1  84 2A           STY DOLB_Y_CALC_POINTERH
0052B0r 1  8D 21 9F        STA VERA_addr_high
0052B3r 1  A9 31           LDA #$31; 4 at a time
0052B5r 1  8D 22 9F        STA VERA_addr_bank
0052B8r 1                  ; clear the buffer ...
0052B8r 1               
0052B8r 1               
0052B8r 1  18              CLC
0052B9r 1  A9 00           LDA #0
0052BBr 1  A2 78           LDX #120;120 ; do 160*120 = 19,200/4 = 4,800 iterations.. if we do 20 iterations a pop.. 240 x iterations
0052BDr 1               
0052BDr 1               
0052BDr 1  9C 23 9F      : STZ VERA_data0 ;     trigger cache write - 4 bytes / 8px
0052C0r 1  9C 23 9F        STZ VERA_data0
0052C3r 1  9C 23 9F        STZ VERA_data0
0052C6r 1  9C 23 9F        STZ VERA_data0 ; 32 px cleared
0052C9r 1               
0052C9r 1  9C 23 9F        STZ VERA_data0
0052CCr 1  9C 23 9F        STZ VERA_data0
0052CFr 1  9C 23 9F        STZ VERA_data0
0052D2r 1  9C 23 9F        STZ VERA_data0 ; 64 px cleared
0052D5r 1               
0052D5r 1  9C 23 9F        STZ VERA_data0
0052D8r 1  9C 23 9F        STZ VERA_data0
0052DBr 1  9C 23 9F        STZ VERA_data0
0052DEr 1  9C 23 9F        STZ VERA_data0 ; 96
0052E1r 1               
0052E1r 1  9C 23 9F        STZ VERA_data0
0052E4r 1  9C 23 9F        STZ VERA_data0
0052E7r 1  9C 23 9F        STZ VERA_data0
0052EAr 1  9C 23 9F        STZ VERA_data0 ; 128
0052EDr 1               
0052EDr 1  9C 23 9F        STZ VERA_data0
0052F0r 1  9C 23 9F        STZ VERA_data0
0052F3r 1  9C 23 9F        STZ VERA_data0
0052F6r 1  9C 23 9F        STZ VERA_data0 ; 160 px cleared
0052F9r 1               
0052F9r 1  18              CLC
0052FAr 1  AD 20 9F        LDA VERA_addr_low
0052FDr 1  69 50           ADC #80     ;     increment A for the low part the address
0052FFr 1  8D 20 9F        STA VERA_addr_low
005302r 1  AD 21 9F        LDA VERA_addr_high
005305r 1  69 00           ADC #0
005307r 1  8D 21 9F        STA VERA_addr_high
00530Ar 1               
00530Ar 1  CA              DEX
00530Br 1  D0 B0           BNE :- ; 85 * 120 = 10,200 .. + 119 * 14 =1,666 .. 11,866 cycles to clear entire screen.. ok
00530Dr 1               
00530Dr 1  A9 E0            LDA #$E0
00530Fr 1  8D 29 9F        STA FX_CTRL
005312r 1               ;    STZ FX_CTRL
005312r 1  A9 FF           LDA #$FF
005314r 1  85 22           STA DOLB_ZTRACKER
005316r 1  A9 rr           LDA #>OBJECT_LIST_Z_START_POINTERS
005318r 1  85 23           STA DOLB_ZTRACKERH
00531Ar 1  80 0B           BRA @GO_Z
00531Cr 1                 @DONE_Z: ; Z=0 is invalid...
00531Cr 1  9C 29 9F           STZ FX_CTRL ;     clear the cache writing for now
00531Fr 1  9C 25 9F           STZ VERA_ctrl  ;     switch back to regular mode for now..
005322r 1  60                 RTS
005323r 1                 @NEXT_Z:
005323r 1  C6 22              DEC DOLB_ZTRACKER
005325r 1  F0 F5              BEQ @DONE_Z
005327r 1                 @GO_Z:
005327r 1  B2 22              LDA (DOLB_ZTRACKER) ; get our first victim
005329r 1  D0 07              BNE @DO_OBJECT
00532Br 1  80 F6              BRA @NEXT_Z
00532Dr 1                 @NEXT_OBJECT:
00532Dr 1  BD rr rr           LDA OBJECT_LIST_BYTE6_NEXT,x
005330r 1  F0 F1              BEQ @NEXT_Z
005332r 1                 @DO_OBJECT:
005332r 1  AA                 TAX      ;     get that pointer into X so we can do stuffs...
005333r 1                     ; OK so now reference OBJECT_LIST_BYTE*,X for whatever we're drawing.. and Y is free for whatever..
005333r 1                     ; first things first, let's figure out where in the buffer to draw.. starting with X location..
005333r 1  BC rr rr           LDY OBJECT_LIST_BYTE3_Y,X
005336r 1  BD rr rr           LDA OBJECT_LIST_BYTE2_X,X  ;
005339r 1  4A                 LSR
00533Ar 1  C9 50              CMP #80
00533Cr 1  90 04              BCC @X_POSITIVE ; check  outside screen.. left/right...
00533Er 1  18                 CLC
00533Fr 1  69 20              ADC #32 ; to <128, then to <160 of the previous Y ?
005341r 1  88                 DEY
005342r 1                  @X_POSITIVE:
005342r 1  C0 78              CPY #120 ; check inside screen..
005344r 1  90 41              BCC @Y_POSITIVE ;   for now, just skip if outside..
005346r 1  C0 C1              CPY #193
005348r 1  90 E3              BCC @NEXT_OBJECT
00534Ar 1  8D 20 9F           STA VERA_addr_low
00534Dr 1  B2 29              LDA (DOLB_Y_CALC_POINTER)
00534Fr 1  8D 21 9F           STA VERA_addr_high
005352r 1  EE 25 9F           INC VERA_ctrl
005355r 1  98                 TYA
005356r 1  49 FF              EOR #$FF
005358r 1  1A                 INC A
005359r 1  0A                 ASL ; x2 bytes
00535Ar 1  0A                 ASL ; x4 bytes
00535Br 1  0A                 ASL ; x8 bytes - is offset into sprite address start..
00535Cr 1  85 27              STA DOLB_CALC_SCRATCH
00535Er 1  AC rr rr           LDY OBJECT_LIST_BYTE1_MODE
005361r 1               
005361r 1  B9 rr rr           LDA LOW_NIBBLE_HIGH,Y
005364r 1  0A                 ASL
005365r 1  A8                 TAY
005366r 1  A9 08              LDA #$08
005368r 1  2A                 ROL
005369r 1  8D 22 9F           STA VERA_addr_bank
00536Cr 1  98                 TYA
00536Dr 1  BC rr rr           LDY OBJECT_LIST_BYTE0_ADDRLOW,X
005370r 1  19 rr rr           ORA SPRITE_ADDRESS_LOW_HIGH,Y
005373r 1  8D 21 9F           STA VERA_addr_high
005376r 1  18                 CLC
005377r 1  B9 rr rr           LDA SPRITE_ADDRESS_LOW_LOW,Y
00537Ar 1  65 27              ADC DOLB_CALC_SCRATCH
00537Cr 1  8D 20 9F           STA VERA_addr_low
00537Fr 1               
00537Fr 1  BD rr rr           LDA OBJECT_LIST_BYTE3_Y,X
005382r 1  69 40              ADC #64 ; push positive..
005384r 1  A8                 TAY
005385r 1  80 3B              BRA @Y_WAS_NEGATIVE
005387r 1               
005387r 1                  @Y_POSITIVE:
005387r 1  79 rr rr           ADC BITMAP_OFFSETS_LOW,Y ; note how this works because carry isn't set.. ?
00538Ar 1  8D 20 9F           STA VERA_addr_low
00538Dr 1  B1 29              LDA (DOLB_Y_CALC_POINTER),Y ; now do the high for the dest..
00538Fr 1  69 00              ADC #0
005391r 1  8D 21 9F           STA VERA_addr_high
005394r 1  EE 25 9F           INC VERA_ctrl  ;  now we need to calculate sprite source address..
005397r 1  BC rr rr           LDY OBJECT_LIST_BYTE1_MODE,X
00539Ar 1  B9 rr rr           LDA LOW_NIBBLE_HIGH,Y
00539Dr 1  0A                 ASL
00539Er 1  A8                 TAY
00539Fr 1  A9 08              LDA #$08
0053A1r 1  2A                 ROL
0053A2r 1  8D 22 9F           STA VERA_addr_bank
0053A5r 1  98                 TYA
0053A6r 1  BC rr rr           LDY OBJECT_LIST_BYTE0_ADDRLOW,X
0053A9r 1  19 rr rr           ORA SPRITE_ADDRESS_LOW_HIGH,Y
0053ACr 1  8D 21 9F           STA VERA_addr_high
0053AFr 1  B9 rr rr           LDA SPRITE_ADDRESS_LOW_LOW,Y
0053B2r 1  8D 20 9F           STA VERA_addr_low
0053B5r 1               
0053B5r 1  38                 SEC
0053B6r 1  A9 78              LDA #120
0053B8r 1  FD rr rr           SBC OBJECT_LIST_BYTE3_Y,X ;   want to check if screenH-Y < 64
0053BBr 1  C9 41              CMP #65
0053BDr 1  90 02              BCC :+
0053BFr 1  A9 40              LDA #64
0053C1r 1  A8               : TAY
0053C2r 1                  @CHECK_ALIGN:
0053C2r 1                  @Y_WAS_NEGATIVE:
0053C2r 1  CE 25 9F           DEC VERA_ctrl  ;  regain dest address
0053C5r 1  AD 20 9F           LDA VERA_addr_low
0053C8r 1  29 03              AND #$03
0053CAr 1  F0 07              BEQ @DO_ZERO_RIGHT
0053CCr 1  0A                 ASL
0053CDr 1  0A                 ASL
0053CEr 1  8D 2C 9F           STA FX_MULT
0053D1r 1  D0 39              BNE @CHECK_OTHER_ALIGNS
0053D3r 1                  @DO_ZERO_RIGHT:
0053D3r 1  9C 2C 9F           STZ FX_MULT
0053D6r 1  80 10              BRA :++
0053D8r 1                  :
0053D8r 1  AD 20 9F           LDA VERA_addr_low
0053DBr 1  69 98              ADC #160-8
0053DDr 1  8D 20 9F           STA VERA_addr_low
0053E0r 1  AD 21 9F           LDA VERA_addr_high
0053E3r 1  69 00              ADC #0
0053E5r 1  8D 21 9F           STA VERA_addr_high
0053E8r 1                  :
0053E8r 1  AD 24 9F           LDA VERA_data1
0053EBr 1  AD 24 9F           LDA VERA_data1
0053EEr 1  AD 24 9F           LDA VERA_data1
0053F1r 1  AD 24 9F           LDA VERA_data1
0053F4r 1  9C 23 9F           STZ VERA_data0
0053F7r 1               
0053F7r 1  AD 24 9F           LDA VERA_data1
0053FAr 1  AD 24 9F           LDA VERA_data1
0053FDr 1  AD 24 9F           LDA VERA_data1
005400r 1  AD 24 9F           LDA VERA_data1
005403r 1  9C 23 9F           STZ VERA_data0
005406r 1  88                 DEY
005407r 1  D0 CF              BNE :--
005409r 1  4C rr rr           JMP @NEXT_OBJECT
00540Cr 1                  @CHECK_OTHER_ALIGNS:
00540Cr 1  C9 08              CMP #8   ;  is either 4,8,12
00540Er 1  90 16              BCC @DO_ONE_RIGHT
005410r 1  F0 4F              BEQ @DO_TWO_RIGHT
005412r 1  18                 CLC
005413r 1  4C rr rr           JMP @DO_THREE_RIGHT
005416r 1                   :
005416r 1  AD 20 9F           LDA VERA_addr_low
005419r 1  69 94              ADC #160-12
00541Br 1  8D 20 9F           STA VERA_addr_low
00541Er 1  AD 21 9F           LDA VERA_addr_high
005421r 1  69 00              ADC #0
005423r 1  8D 21 9F           STA VERA_addr_high
005426r 1                  @DO_ONE_RIGHT:
005426r 1  AD 24 9F           LDA VERA_data1
005429r 1  AD 24 9F           LDA VERA_data1
00542Cr 1  AD 24 9F           LDA VERA_data1
00542Fr 1  A9 03              LDA #%00000011
005431r 1  8D 23 9F           STA VERA_data0
005434r 1               
005434r 1  AD 24 9F           LDA VERA_data1
005437r 1  AD 24 9F           LDA VERA_data1
00543Ar 1  AD 24 9F           LDA VERA_data1
00543Dr 1  AD 24 9F           LDA VERA_data1
005440r 1  9C 23 9F           STZ VERA_data0
005443r 1               
005443r 1  AD 24 9F           LDA VERA_data1
005446r 1  A9 FC              LDA #%11111100
005448r 1  8D 23 9F           STA VERA_data0
00544Br 1  88                 DEY
00544Cr 1  D0 C8              BNE :-
00544Er 1  4C rr rr           JMP @NEXT_OBJECT
005451r 1               
005451r 1                   :
005451r 1  AD 20 9F           LDA VERA_addr_low
005454r 1  69 94              ADC #160-12
005456r 1  8D 20 9F           STA VERA_addr_low
005459r 1  AD 21 9F           LDA VERA_addr_high
00545Cr 1  69 00              ADC #0
00545Er 1  8D 21 9F           STA VERA_addr_high
005461r 1                  @DO_TWO_RIGHT:
005461r 1  AD 24 9F           LDA VERA_data1
005464r 1  AD 24 9F           LDA VERA_data1
005467r 1  A9 0F              LDA #%00001111
005469r 1  8D 23 9F           STA VERA_data0
00546Cr 1               
00546Cr 1  AD 24 9F           LDA VERA_data1
00546Fr 1  AD 24 9F           LDA VERA_data1
005472r 1  AD 24 9F           LDA VERA_data1
005475r 1  AD 24 9F           LDA VERA_data1
005478r 1  9C 23 9F           STZ VERA_data0
00547Br 1               
00547Br 1  AD 24 9F           LDA VERA_data1
00547Er 1  AD 24 9F           LDA VERA_data1
005481r 1  A9 F0              LDA #%11110000
005483r 1  8D 23 9F           STA VERA_data0
005486r 1  88                 DEY
005487r 1  D0 C8              BNE :-
005489r 1  4C rr rr           JMP @NEXT_OBJECT
00548Cr 1               
00548Cr 1                   :
00548Cr 1  AD 20 9F           LDA VERA_addr_low
00548Fr 1  69 94              ADC #160-12
005491r 1  8D 20 9F           STA VERA_addr_low
005494r 1  AD 21 9F           LDA VERA_addr_high
005497r 1  69 00              ADC #0
005499r 1  8D 21 9F           STA VERA_addr_high
00549Cr 1                  @DO_THREE_RIGHT:
00549Cr 1  AD 24 9F           LDA VERA_data1
00549Fr 1  A9 3F              LDA #%00111111
0054A1r 1  8D 23 9F           STA VERA_data0
0054A4r 1               
0054A4r 1  AD 24 9F           LDA VERA_data1
0054A7r 1  AD 24 9F           LDA VERA_data1
0054AAr 1  AD 24 9F           LDA VERA_data1
0054ADr 1  AD 24 9F           LDA VERA_data1
0054B0r 1  9C 23 9F           STZ VERA_data0
0054B3r 1               
0054B3r 1  AD 24 9F           LDA VERA_data1
0054B6r 1  AD 24 9F           LDA VERA_data1
0054B9r 1  AD 24 9F           LDA VERA_data1
0054BCr 1  A9 C0              LDA #%11000000
0054BEr 1  8D 23 9F           STA VERA_data0
0054C1r 1  88                 DEY
0054C2r 1  D0 C8              BNE :-
0054C4r 1  4C rr rr           JMP @NEXT_OBJECT
0054C7r 1               
0054C7r 1               .macro calc_downlefts_backwards_for_row row, start, end
0054C7r 1               .local SELF
0054C7r 1               .local LEFT
0054C7r 1               .local DOWNLEFT
0054C7r 1               .local DOWNRIGHT
0054C7r 1               .local SCRATCH
0054C7r 1               .local COUNT
0054C7r 1               .local LOOP
0054C7r 1                  SELF = TUB_WORLD+(64*row)+start ; because start has nothing to the left, needs processed different
0054C7r 1                  LEFT = SELF-1
0054C7r 1                  DOWNLEFT = LEFT+64
0054C7r 1                  DOWNRIGHT = DOWNLEFT+1
0054C7r 1                  SCRATCH = WATER_CALC_SCRATCH+(64*row)+start
0054C7r 1                  COUNT = end-start
0054C7r 1               
0054C7r 1               .if COUNT & 1 = 1
0054C7r 1                  LDX #COUNT-1
0054C7r 1                  LDA SELF+1,X ;   4   4this is basically start+count .. OK
0054C7r 1                  ADC DOWNRIGHT+1,X ; 4   8
0054C7r 1                  ADC LEFT+1,X   ;  4  12
0054C7r 1                  ADC DOWNLEFT+1,X  ;  4  16
0054C7r 1                  STA SCRATCH+1,X   ;  4  20    20 each without dex/BNE... = ~25 would be normal/expected without the Y thing..
0054C7r 1               .else
0054C7r 1                  LDX #COUNT
0054C7r 1               .endif
0054C7r 1               LOOP:
0054C7r 1                  LDA LEFT,X           ;  4
0054C7r 1                  ADC DOWNLEFT,X       ;  4  8
0054C7r 1                  TAY                  ;  2  10
0054C7r 1                  ADC SELF,X           ;  4  14
0054C7r 1                  ADC DOWNRIGHT,X      ;  4  18
0054C7r 1                  ADC SCRATCH,X
0054C7r 1                  ROR
0054C7r 1                  ADC #1
0054C7r 1                  STA SCRATCH,X        ;  4  22
0054C7r 1                  DEX                  ;  2  24
0054C7r 1                  TYA                  ;  2  26
0054C7r 1                  ADC LEFT,X           ;  4  30
0054C7r 1                  ADC DOWNLEFT,X       ;  4  34
0054C7r 1                  ADC SCRATCH,X
0054C7r 1                  ROR
0054C7r 1                  ADC #1
0054C7r 1                  STA SCRATCH,X        ;  4  38
0054C7r 1                  DEX                  ;  2  40
0054C7r 1                  BNE LOOP             ;  ~3   43  /2 =  ~22 per each
0054C7r 1               .endmacro
0054C7r 1               
0054C7r 1               .macro calc_new_values_for_row row, start, end ; end value needs to have an up-right and start must have downleft!
0054C7r 1               .local SELF
0054C7r 1               .local SCRATCH_DOWNLEFT
0054C7r 1               .local SCRATCH_UPRIGHT
0054C7r 1               .local COUNT
0054C7r 1                  SCRATCH_DOWNLEFT = WATER_CALC_SCRATCH+(64*row)+start-1
0054C7r 1                  SCRATCH_UPRIGHT = SCRATCH_DOWNLEFT-64+1
0054C7r 1                  SELF = TUB_WORLD+(64*row)+start-1
0054C7r 1                  COUNT = end-start+1
0054C7r 1                  LDX #COUNT
0054C7r 1                : LDA SCRATCH_DOWNLEFT,X  ;  <256    4
0054C7r 1                  ADC SCRATCH_UPRIGHT,X   ;  <512     4  8
0054C7r 1                  ROR ; <256                          2  10
0054C7r 1                  adc #0
0054C7r 1                  LSR ; <128                          2  12
0054C7r 1                  adc #0
0054C7r 1                  LSR ; <64 OK                        2  14
0054C7r 1                  ADC SELF,X ; <128                   4  18
0054C7r 1                  LSR ; <64                           2  20
0054C7r 1                  ADC #0   ;                          2  22
0054C7r 1                  STA SELF,X  ;                       4  26
0054C7r 1                  DEX                  ;              2  28
0054C7r 1                  BNE :-               ;             ~3  31    + ~22 per each = ~53 cycles per normie * ~1300 = ~69,000 cycles otay
0054C7r 1               .endmacro
0054C7r 1               
0054C7r 1               .macro calc_new_value_especial row, column, upleft, upright, right, left, downleft, downright
0054C7r 1               .local SELF
0054C7r 1               .local SCRATCH
0054C7r 1                  SELF = TUB_WORLD+(64*row)+column
0054C7r 1                  SCRATCH = WATER_CALC_SCRATCH+(64*row)+column
0054C7r 1                  LDA SELF
0054C7r 1                  ADC SELF+left
0054C7r 1                  adc SELF+downleft
0054C7r 1                  adc SELF+downright
0054C7r 1                  STA SCRATCH
0054C7r 1                  LDA SELF
0054C7r 1                  ADC SELF+upleft
0054C7r 1                  adc SELF+upright
0054C7r 1                  adc SELF+right
0054C7r 1                  ADC SCRATCH
0054C7r 1                  ROR
0054C7r 1                  LSR
0054C7r 1                  LSR
0054C7r 1               ;   ADC SELF
0054C7r 1               ;   LSR
0054C7r 1                ;  ADC #0
0054C7r 1                  STA SCRATCH
0054C7r 1               .endmacro
0054C7r 1               
0054C7r 1               .macro calc_missing_three_neighbors row, column, neighborA, neighborB, neighborC
0054C7r 1               .local SELF
0054C7r 1               .local SCRATCH
0054C7r 1                  SELF = TUB_WORLD+(64*row)+column
0054C7r 1                  LDA SELF
0054C7r 1                  ADC SELF+neighborA
0054C7r 1                  ADC SELF+neighborB
0054C7r 1                  ADC SELF+neighborC
0054C7r 1                  LSR
0054C7r 1                  LSR
0054C7r 1               ;   ADC SELF
0054C7r 1                ;  LSR
0054C7r 1                ;  ADC #0
0054C7r 1                  STA SPECIAL_SCRATCH,X
0054C7r 1                  INX
0054C7r 1               
0054C7r 1               .endmacro
0054C7r 1               
0054C7r 1               .macro calc_missing_two_neighbors row, column, neighborA, neighborB, neighborC, neighborD
0054C7r 1               .local SELF
0054C7r 1               .local SCRATCH
0054C7r 1                  SELF = TUB_WORLD+(64*row)+column
0054C7r 1                  LDA SELF+neighborA
0054C7r 1                  ADC SELF+neighborB
0054C7r 1                  ADC SELF+neighborC
0054C7r 1                  ADC SELF+neighborD   ;  4x
0054C7r 1                  LSR ; 2x..
0054C7r 1                  TAY
0054C7r 1                  LDA MISSING_TWO_NEIGHBOR_MUL,Y ; 3X !
0054C7r 1                  ADC SELF ;  4x
0054C7r 1                  LSR
0054C7r 1                  LSR
0054C7r 1                ;  ADC SELF
0054C7r 1                ;  LSR
0054C7r 1                ;  ADC #0
0054C7r 1                  STA SPECIAL_SCRATCH,X
0054C7r 1                  INX
0054C7r 1               .endmacro
0054C7r 1               
0054C7r 1               .macro calc_missing_one_neighbors row, column, neighborA, neighborB, neighborC, neighborD, neighborE
0054C7r 1               .local SELF
0054C7r 1               .local SCRATCH
0054C7r 1                  SELF = TUB_WORLD+(64*row)+column
0054C7r 1                  SCRATCH = WATER_CALC_SCRATCH+(64*row)+column
0054C7r 1                  LDA SELF+neighborA
0054C7r 1                  ADC SELF+neighborB
0054C7r 1                  ADC SELF+neighborC
0054C7r 1                  ADC SELF+neighborD   ;  4x <252
0054C7r 1                  ADC SELF+neighborE   ;  5x <315
0054C7r 1                  ROR ; 2.5X
0054C7r 1                  TAY
0054C7r 1                  LDA MISSING_ONE_NEIGHBOR_MUL,Y ; 2.5*6/5 = 6/2 = 3x
0054C7r 1                  ADC SELF ; 4X
0054C7r 1                  LSR
0054C7r 1                  LSR
0054C7r 1               ;   ADC SELF
0054C7r 1                ;  LSR
0054C7r 1                ;  ADC #0
0054C7r 1                  STA SPECIAL_SCRATCH,X
0054C7r 1                  INX
0054C7r 1               .endmacro
0054C7r 1               
0054C7r 1               .macro copy_scratch_to_self row,column
0054C7r 1                  LDA SPECIAL_SCRATCH,X
0054C7r 1                  STA TUB_WORLD+(64*row)+column
0054C7r 1                  INX
0054C7r 1               .endmacro
0054C7r 1               
0054C7r 1               UPDATE_WATER_SIM:
0054C7r 1                  ;  make downlefts shingles to stash for calculation as newSelf = (downleft+upright)/8 + Self )/2
0054C7r 1               
0054C7r 1                  ; row 0 is wall of tub... need to make "downlefts" for row 1 to use as uprights..
0054C7r 1  18              CLC
0054C8r 1  A2 21           LDX #54-21
0054CAr 1  BD rr rr      : LDA TUB_WORLD+64+21,X ;
0054CDr 1  7D rr rr        ADC TUB_WORLD+64+22,X ; right
0054D0r 1  7D rr rr        ADC TUB_WORLD+128+22,X ; down right
0054D3r 1  7D rr rr        ADC TUB_WORLD+128+21,X ; down left
0054D6r 1  9D rr rr        STA WATER_CALC_SCRATCH+21+1,X ; save to upper rights
0054D9r 1  CA              DEX
0054DAr 1  D0 EE           BNE :-
0054DCr 1  A2 22 BD rr     calc_downlefts_backwards_for_row  1, $15, $37 ; row 1 - 21 to 55 ... need to reflect because row 0 is wall of tub..
0054E0r 1  rr 7D rr rr  
0054E4r 1  A8 7D rr rr  
005508r 1  A2 24 BD rr     calc_downlefts_backwards_for_row 2, 20, 56
00550Cr 1  rr 7D rr rr  
005510r 1  A8 7D rr rr  
005534r 1  A2 26 BD rr     calc_downlefts_backwards_for_row  3, $12, $39 ; row 3 - 18 to 57
005538r 1  rr 7D rr rr  
00553Cr 1  7D rr rr 7D  
00556Fr 1  A2 2A BD rr     calc_downlefts_backwards_for_row  4, $10, $3A ; row 2 - 20 to
005573r 1  rr 7D rr rr  
005577r 1  A8 7D rr rr  
00559Br 1  A2 2C BD rr     calc_downlefts_backwards_for_row  5, $0E, $3B ; row 2 - 20 to
00559Fr 1  rr 7D rr rr  
0055A3r 1  7D rr rr 7D  
0055D6r 1  A2 2E BD rr     calc_downlefts_backwards_for_row  6, $0D, $3B ; row 2 - 20 to
0055DAr 1  rr 7D rr rr  
0055DEr 1  A8 7D rr rr  
005602r 1  A2 2E BD rr     calc_downlefts_backwards_for_row  7, $0C, $3B ; row 2 - 20 to
005606r 1  rr 7D rr rr  
00560Ar 1  7D rr rr 7D  
00563Dr 1  A2 30 BD rr     calc_downlefts_backwards_for_row  8, $0B, $3B ; row 2 - 20 to
005641r 1  rr 7D rr rr  
005645r 1  A8 7D rr rr  
005669r 1  A2 30 BD rr     calc_downlefts_backwards_for_row  9, $0A, $3A ; row 9 - $3B has no DR
00566Dr 1  rr 7D rr rr  
005671r 1  A8 7D rr rr  
005695r 1  A2 30 BD rr     calc_downlefts_backwards_for_row 10, $0A, $3A ; row
005699r 1  rr 7D rr rr  
00569Dr 1  A8 7D rr rr  
0056C1r 1  A2 30 BD rr     calc_downlefts_backwards_for_row 11, $09, $39 ; row 11 - $3A has no DR
0056C5r 1  rr 7D rr rr  
0056C9r 1  A8 7D rr rr  
0056EDr 1  A2 30 BD rr     calc_downlefts_backwards_for_row 12, $09, $39 ; row 2 - 20 to
0056F1r 1  rr 7D rr rr  
0056F5r 1  A8 7D rr rr  
005719r 1  A2 30 BD rr     calc_downlefts_backwards_for_row 13, $08, $39 ; row 2 - 20 to
00571Dr 1  rr 7D rr rr  
005721r 1  7D rr rr 7D  
005754r 1  A2 30 BD rr     calc_downlefts_backwards_for_row 14, $08, $39 ; row 2 - 20 to
005758r 1  rr 7D rr rr  
00575Cr 1  7D rr rr 7D  
00578Fr 1  A2 30 BD rr     calc_downlefts_backwards_for_row 15, $07, $38 ; row 15 - $39 has no DR
005793r 1  rr 7D rr rr  
005797r 1  7D rr rr 7D  
0057CAr 1  A2 30 BD rr     calc_downlefts_backwards_for_row 16, $07, $37 ;
0057CEr 1  rr 7D rr rr  
0057D2r 1  A8 7D rr rr  
0057F6r 1  A2 30 BD rr     calc_downlefts_backwards_for_row 17, $06, $36 ; row 2 - 20 to
0057FAr 1  rr 7D rr rr  
0057FEr 1  A8 7D rr rr  
005822r 1  A2 30 BD rr     calc_downlefts_backwards_for_row 18, $06, $36 ; row 2 - 20 to
005826r 1  rr 7D rr rr  
00582Ar 1  A8 7D rr rr  
00584Er 1  A2 30 BD rr     calc_downlefts_backwards_for_row 19, $05, $35 ; row 2 - 20 to
005852r 1  rr 7D rr rr  
005856r 1  A8 7D rr rr  
00587Ar 1  A2 30 BD rr     calc_downlefts_backwards_for_row 20, $05, $35 ; row 2 - 20 to
00587Er 1  rr 7D rr rr  
005882r 1  A8 7D rr rr  
0058A6r 1  A2 30 BD rr     calc_downlefts_backwards_for_row 21, $04, $34 ; row 2 - 20 to
0058AAr 1  rr 7D rr rr  
0058AEr 1  A8 7D rr rr  
0058D2r 1  A2 2E BD rr     calc_downlefts_backwards_for_row 22, $04, $33 ; row 2 - 20 to
0058D6r 1  rr 7D rr rr  
0058DAr 1  7D rr rr 7D  
00590Dr 1  A2 2E BD rr     calc_downlefts_backwards_for_row 23, $04, $32 ; row 2 - 20 to
005911r 1  rr 7D rr rr  
005915r 1  A8 7D rr rr  
005939r 1  A2 2C BD rr     calc_downlefts_backwards_for_row 24, $04, $31 ; row 2 - 20 to
00593Dr 1  rr 7D rr rr  
005941r 1  7D rr rr 7D  
005974r 1  A2 2C BD rr     calc_downlefts_backwards_for_row 25, $04, $30 ; row 2 - 20 to
005978r 1  rr 7D rr rr  
00597Cr 1  A8 7D rr rr  
0059A0r 1  A2 28 BD rr     calc_downlefts_backwards_for_row 26, $05, $2E ; row 26 - 4 to but 5 has no downleft
0059A4r 1  rr 7D rr rr  
0059A8r 1  7D rr rr 7D  
0059DBr 1  A2 26 BD rr     calc_downlefts_backwards_for_row 27, $06, $2C ; row 27 - 5 to but 5/6 have no downleft
0059DFr 1  rr 7D rr rr  
0059E3r 1  A8 7D rr rr  
005A07r 1  A2 22 BD rr     calc_downlefts_backwards_for_row 28, $07, $2A ; row 28 - 6 to but 6/7 have no downleft
005A0Br 1  rr 7D rr rr  
005A0Fr 1  7D rr rr 7D  
005A42r 1  A2 23           LDX #42-7
005A44r 1  BD rr rr      : LDA TUB_WORLD+(29*64)+7,X ;  self
005A47r 1  7D rr rr        ADC TUB_WORLD+(29*64)+6,X ;  left
005A4Ar 1  7D rr rr        ADC TUB_WORLD+(28*64)+7,X ;  upleft as low right
005A4Dr 1  7D rr rr        ADC TUB_WORLD+(28*64)+8,X ;  upright as low left
005A50r 1  9D rr rr        STA WATER_CALC_SCRATCH+(29*64)+7,X
005A53r 1  CA              DEX
005A54r 1  D0 EE           BNE :-
005A56r 1                  ; X is zero.. good .. will increment through these..
005A56r 1                  ;     type                  row,col,   A,   B,   C,   D,   E
005A56r 1  AD rr rr 6D     calc_missing_three_neighbors  1, 21,   1,  63,  64
005A5Ar 1  rr rr 6D rr  
005A5Er 1  rr 6D rr rr  
005A68r 1  AD rr rr 6D     calc_missing_two_neighbors    2, 20, -63,   1,  63,  64
005A6Cr 1  rr rr 6D rr  
005A70r 1  rr 6D rr rr  
005A82r 1  AD rr rr 6D     calc_missing_one_neighbors    3, 19, -63,  -1,   1,  63,  64
005A86r 1  rr rr 6D rr  
005A8Ar 1  rr 6D rr rr  
005A9Fr 1  AD rr rr 6D     calc_missing_three_neighbors  3, 18,   1,  63,  64
005AA3r 1  rr rr 6D rr  
005AA7r 1  rr 6D rr rr  
005AB1r 1  AD rr rr 6D     calc_missing_one_neighbors    4, 17, -63,  -1,   1,  63,  64
005AB5r 1  rr rr 6D rr  
005AB9r 1  rr 6D rr rr  
005ACEr 1  AD rr rr 6D     calc_missing_three_neighbors  4, 16,   1,  63,  64
005AD2r 1  rr rr 6D rr  
005AD6r 1  rr 6D rr rr  
005AE0r 1  AD rr rr 6D     calc_missing_one_neighbors    5, 15, -63,  -1,   1,  63,  64
005AE4r 1  rr rr 6D rr  
005AE8r 1  rr 6D rr rr  
005AFDr 1  AD rr rr 6D     calc_missing_three_neighbors  5, 14,   1,  63,  64
005B01r 1  rr rr 6D rr  
005B05r 1  rr 6D rr rr  
005B0Fr 1  AD rr rr 6D     calc_missing_two_neighbors    6, 13, -63,   1,  63,  64
005B13r 1  rr rr 6D rr  
005B17r 1  rr 6D rr rr  
005B29r 1  AD rr rr 6D     calc_missing_two_neighbors    7, 12, -63,   1,  63,  64
005B2Dr 1  rr rr 6D rr  
005B31r 1  rr 6D rr rr  
005B43r 1  AD rr rr 6D     calc_missing_two_neighbors    8, 11, -63,   1,  63,  64
005B47r 1  rr rr 6D rr  
005B4Br 1  rr 6D rr rr  
005B5Dr 1  AD rr rr 6D     calc_missing_three_neighbors  9, 10, -63,   1,  64
005B61r 1  rr rr 6D rr  
005B65r 1  rr 6D rr rr  
005B6Fr 1  AD rr rr 6D     calc_missing_one_neighbors   10, 10, -64, -63,   1,  63,  64
005B73r 1  rr rr 6D rr  
005B77r 1  rr 6D rr rr  
005B8Cr 1  AD rr rr 6D     calc_missing_three_neighbors 11,  9, -63,   1,  64
005B90r 1  rr rr 6D rr  
005B94r 1  rr 6D rr rr  
005B9Er 1  AD rr rr 6D     calc_missing_one_neighbors   12,  9, -64, -63,   1,  63,  64
005BA2r 1  rr rr 6D rr  
005BA6r 1  rr 6D rr rr  
005BBBr 1  AD rr rr 6D     calc_missing_three_neighbors 13,  8, -63,   1,  64
005BBFr 1  rr rr 6D rr  
005BC3r 1  rr 6D rr rr  
005BCDr 1  AD rr rr 6D     calc_missing_one_neighbors   14,  8, -64, -63,   1,  63,  64
005BD1r 1  rr rr 6D rr  
005BD5r 1  rr 6D rr rr  
005BEAr 1  AD rr rr 6D     calc_missing_three_neighbors 15,  7, -63,   1,  64
005BEEr 1  rr rr 6D rr  
005BF2r 1  rr 6D rr rr  
005BFCr 1  AD rr rr 6D     calc_missing_one_neighbors   16,  7, -64, -63,   1,  63,  64
005C00r 1  rr rr 6D rr  
005C04r 1  rr 6D rr rr  
005C19r 1  AD rr rr 6D     calc_missing_three_neighbors 17,  6, -63,   1,  64
005C1Dr 1  rr rr 6D rr  
005C21r 1  rr 6D rr rr  
005C2Br 1  AD rr rr 6D     calc_missing_one_neighbors   18,  6, -64, -63,   1,  63,  64
005C2Fr 1  rr rr 6D rr  
005C33r 1  rr 6D rr rr  
005C48r 1  AD rr rr 6D     calc_missing_three_neighbors 19,  5, -63,   1,  64
005C4Cr 1  rr rr 6D rr  
005C50r 1  rr 6D rr rr  
005C5Ar 1  AD rr rr 6D     calc_missing_one_neighbors   20,  5, -64, -63,   1,  63,  64
005C5Er 1  rr rr 6D rr  
005C62r 1  rr 6D rr rr  
005C77r 1  AD rr rr 6D     calc_missing_three_neighbors 21,  4, -63,   1,  64
005C7Br 1  rr rr 6D rr  
005C7Fr 1  rr 6D rr rr  
005C89r 1  AD rr rr 6D     calc_missing_two_neighbors   22,  4, -64, -63,   1,  64
005C8Dr 1  rr rr 6D rr  
005C91r 1  rr 6D rr rr  
005CA3r 1  AD rr rr 6D     calc_missing_two_neighbors   23,  4, -64, -63,   1,  64
005CA7r 1  rr rr 6D rr  
005CABr 1  rr 6D rr rr  
005CBDr 1  AD rr rr 6D     calc_missing_two_neighbors   24,  4, -64, -63,   1,  64
005CC1r 1  rr rr 6D rr  
005CC5r 1  rr 6D rr rr  
005CD7r 1  AD rr rr 6D     calc_missing_two_neighbors   25,  4, -64, -63,   1,  64
005CDBr 1  rr rr 6D rr  
005CDFr 1  rr 6D rr rr  
005CF1r 1  AD rr rr 6D     calc_missing_three_neighbors 26,  4, -64, -63,   1
005CF5r 1  rr rr 6D rr  
005CF9r 1  rr 6D rr rr  
005D03r 1  AD rr rr 6D     calc_missing_three_neighbors 27,  5, -64, -63,   1
005D07r 1  rr rr 6D rr  
005D0Br 1  rr 6D rr rr  
005D15r 1  AD rr rr 6D     calc_missing_three_neighbors 28,  6, -64, -63,   1
005D19r 1  rr rr 6D rr  
005D1Dr 1  rr 6D rr rr  
005D27r 1  AD rr rr 6D     calc_missing_three_neighbors 29,  7, -64, -63,   1
005D2Br 1  rr rr 6D rr  
005D2Fr 1  rr 6D rr rr  
005D39r 1                  ;     type                  row,col,   A,   B,   C,   D,   E
005D39r 1  AD rr rr 6D     calc_missing_three_neighbors  1, 55,  -1,  63,  64
005D3Dr 1  rr rr 6D rr  
005D41r 1  rr 6D rr rr  
005D4Br 1  AD rr rr 6D     calc_missing_three_neighbors  2, 56,  -1,  63,  64
005D4Fr 1  rr rr 6D rr  
005D53r 1  rr 6D rr rr  
005D5Dr 1  AD rr rr 6D     calc_missing_three_neighbors  3, 57,  -1,  63,  64
005D61r 1  rr rr 6D rr  
005D65r 1  rr 6D rr rr  
005D6Fr 1  AD rr rr 6D     calc_missing_three_neighbors  4, 58,  -1,  63,  64
005D73r 1  rr rr 6D rr  
005D77r 1  rr 6D rr rr  
005D81r 1  AD rr rr 6D     calc_missing_three_neighbors  5, 59,  -1,  63,  64
005D85r 1  rr rr 6D rr  
005D89r 1  rr 6D rr rr  
005D93r 1  AD rr rr 6D     calc_missing_two_neighbors    6, 59, -64,  -1,  63,  64
005D97r 1  rr rr 6D rr  
005D9Br 1  rr 6D rr rr  
005DADr 1  AD rr rr 6D     calc_missing_two_neighbors    7, 59, -64,  -1,  63,  64
005DB1r 1  rr rr 6D rr  
005DB5r 1  rr 6D rr rr  
005DC7r 1  AD rr rr 6D     calc_missing_two_neighbors    8, 59, -64,  -1,  63,  64
005DCBr 1  rr rr 6D rr  
005DCFr 1  rr 6D rr rr  
005DE1r 1  AD rr rr 6D     calc_missing_three_neighbors  9, 59, -64,  -1,  63
005DE5r 1  rr rr 6D rr  
005DE9r 1  rr 6D rr rr  
005DF3r 1  AD rr rr 6D     calc_missing_one_neighbors   10, 58, -64, -63,  -1,  63,  64
005DF7r 1  rr rr 6D rr  
005DFBr 1  rr 6D rr rr  
005E10r 1  AD rr rr 6D     calc_missing_three_neighbors 11, 58, -64,  -1,  63
005E14r 1  rr rr 6D rr  
005E18r 1  rr 6D rr rr  
005E22r 1  AD rr rr 6D     calc_missing_two_neighbors   12, 57, -64,  -1,  63,  64
005E26r 1  rr rr 6D rr  
005E2Ar 1  rr 6D rr rr  
005E3Cr 1  AD rr rr 6D     calc_missing_two_neighbors   13, 57, -64,  -1,  63,  64
005E40r 1  rr rr 6D rr  
005E44r 1  rr 6D rr rr  
005E56r 1  AD rr rr 6D     calc_missing_two_neighbors   14, 57, -64,  -1,  63,  64
005E5Ar 1  rr rr 6D rr  
005E5Er 1  rr 6D rr rr  
005E70r 1  AD rr rr 6D     calc_missing_three_neighbors 15, 57, -64,  -1,  63
005E74r 1  rr rr 6D rr  
005E78r 1  rr 6D rr rr  
005E82r 1  AD rr rr 6D     calc_missing_two_neighbors   16, 56, -64, -63,  -1,  63
005E86r 1  rr rr 6D rr  
005E8Ar 1  rr 6D rr rr  
005E9Cr 1  AD rr rr 6D     calc_missing_two_neighbors   17, 55, -64, -63,  -1,  63
005EA0r 1  rr rr 6D rr  
005EA4r 1  rr 6D rr rr  
005EB6r 1  AD rr rr 6D     calc_missing_one_neighbors   18, 54, -64, -63,  -1,  63,  64
005EBAr 1  rr rr 6D rr  
005EBEr 1  rr 6D rr rr  
005ED3r 1  AD rr rr 6D     calc_missing_three_neighbors 19, 54, -64,  -1,  63
005ED7r 1  rr rr 6D rr  
005EDBr 1  rr 6D rr rr  
005EE5r 1  AD rr rr 6D     calc_missing_one_neighbors   20, 53, -64, -63,  -1,  63,  64
005EE9r 1  rr rr 6D rr  
005EEDr 1  rr 6D rr rr  
005F02r 1  AD rr rr 6D     calc_missing_three_neighbors 21, 53, -64,  -1,  63
005F06r 1  rr rr 6D rr  
005F0Ar 1  rr 6D rr rr  
005F14r 1  AD rr rr 6D     calc_missing_two_neighbors   22, 52, -64, -63,  -1,  63
005F18r 1  rr rr 6D rr  
005F1Cr 1  rr 6D rr rr  
005F2Er 1  AD rr rr 6D     calc_missing_two_neighbors   23, 51, -64, -63,  -1,  63
005F32r 1  rr rr 6D rr  
005F36r 1  rr 6D rr rr  
005F48r 1  AD rr rr 6D     calc_missing_two_neighbors   24, 50, -64, -63,  -1,  63
005F4Cr 1  rr rr 6D rr  
005F50r 1  rr 6D rr rr  
005F62r 1  AD rr rr 6D     calc_missing_two_neighbors   25, 49, -64, -63,  -1,  63
005F66r 1  rr rr 6D rr  
005F6Ar 1  rr 6D rr rr  
005F7Cr 1  AD rr rr 6D     calc_missing_three_neighbors 26, 48, -64, -63,  -1
005F80r 1  rr rr 6D rr  
005F84r 1  rr 6D rr rr  
005F8Er 1  AD rr rr 6D     calc_missing_one_neighbors   26, 47, -64, -63,  -1,   1,  63
005F92r 1  rr rr 6D rr  
005F96r 1  rr 6D rr rr  
005FABr 1  AD rr rr 6D     calc_missing_three_neighbors 27, 46, -64, -63,  -1
005FAFr 1  rr rr 6D rr  
005FB3r 1  rr 6D rr rr  
005FBDr 1  AD rr rr 6D     calc_missing_one_neighbors   27, 45, -64, -63,  -1,   1,  63
005FC1r 1  rr rr 6D rr  
005FC5r 1  rr 6D rr rr  
005FDAr 1  AD rr rr 6D     calc_missing_three_neighbors 28, 44, -64, -63,  -1
005FDEr 1  rr rr 6D rr  
005FE2r 1  rr 6D rr rr  
005FECr 1  AD rr rr 6D     calc_missing_one_neighbors   28, 43, -64, -63,  -1,   1,  63
005FF0r 1  rr rr 6D rr  
005FF4r 1  rr 6D rr rr  
006009r 1  AD rr rr 6D     calc_missing_three_neighbors 29, 42, -64, -63,  -1
00600Dr 1  rr rr 6D rr  
006011r 1  rr 6D rr rr  
00601Br 1               
00601Br 1  64 22           STZ ZP_PTR
00601Dr 1  A9 rr           LDA #>MISSING_TWO_NEIGHBOR_MUL
00601Fr 1  85 23           STA ZP_PTR+1
006021r 1  A0 22           LDY #41-7
006023r 1  B9 rr rr      : LDA TUB_WORLD+(64*29)+7-64,y ; upleft
006026r 1  79 rr rr        ADC TUB_WORLD+(64*29)+7-63,y ; up right
006029r 1  79 rr rr        ADC TUB_WORLD+(64*29)+7-1,y ; left
00602Cr 1  79 rr rr        ADC TUB_WORLD+(64*29)+7+1,y ; right
00602Fr 1  4A              LSR ; 2x..
006030r 1  85 22           STA ZP_PTR
006032r 1  B2 22           LDA (ZP_PTR) ; 3X !
006034r 1  79 rr rr        ADC TUB_WORLD+(64*29)+7,y
006037r 1  4A              LSR
006038r 1  4A              LSR
006039r 1  79 rr rr        ADC TUB_WORLD+(64*29)+7,y
00603Cr 1  4A              LSR
00603Dr 1  69 00           ADC #0
00603Fr 1  9D rr rr        STA SPECIAL_SCRATCH,X
006042r 1  E8              INX
006043r 1  88              DEY
006044r 1  D0 DD           BNE :-
006046r 1               
006046r 1               
006046r 1               
006046r 1               ;  now calculate new values...
006046r 1  A2 21 BD rr     calc_new_values_for_row 1, 22, 54
00604Ar 1  rr 7D rr rr  
00604Er 1  6A 69 00 4A  
006061r 1  A2 22 BD rr     calc_new_values_for_row 2, $15, $36 ; row 2 - $14 has no left and $38 has no up/right
006065r 1  rr 7D rr rr  
006069r 1  6A 69 00 4A  
00607Cr 1  A2 24 BD rr     calc_new_values_for_row 3, $14, $37 ; row 3 - $12 has no left and $37 has no up/right
006080r 1  rr 7D rr rr  
006084r 1  6A 69 00 4A  
006097r 1  A2 27 BD rr     calc_new_values_for_row 4, $12, $38 ; row
00609Br 1  rr 7D rr rr  
00609Fr 1  6A 69 00 4A  
0060B2r 1  A2 2A BD rr     calc_new_values_for_row 5, 16, $39 ; row start 1 more than calc back (because need downleft) and 1 less prev calc back
0060B6r 1  rr 7D rr rr  
0060BAr 1  6A 69 00 4A  
0060CDr 1  A2 2D BD rr     calc_new_values_for_row 6, $0E, $3A ; row start 1 more than calc back (because need downleft) and 1 less prev calc back
0060D1r 1  rr 7D rr rr  
0060D5r 1  6A 69 00 4A  
0060E8r 1  A2 2E BD rr     calc_new_values_for_row 7, $0D, $3A ; row start 1 more than calc back (because need downleft) and 1 less prev calc back
0060ECr 1  rr 7D rr rr  
0060F0r 1  6A 69 00 4A  
006103r 1  A2 2F BD rr     calc_new_values_for_row 8, $0C, $3A ; row start 1 more than calc back (because need downleft) and 1 less prev calc back
006107r 1  rr 7D rr rr  
00610Br 1  6A 69 00 4A  
00611Er 1  A2 30 BD rr     calc_new_values_for_row 9, $0B, $3A ; row start 1 more than calc back (because need downleft) and 1 less prev calc back
006122r 1  rr 7D rr rr  
006126r 1  6A 69 00 4A  
006139r 1  A2 2F BD rr     calc_new_values_for_row 10, $0B, $39 ; row start 1 more than calc back (because need downleft) and 1 less prev calc back
00613Dr 1  rr 7D rr rr  
006141r 1  6A 69 00 4A  
006154r 1  A2 2F BD rr     calc_new_values_for_row 11, $0A, $38 ; row start 1 more than calc back (because need downleft) and 1 less prev calc back
006158r 1  rr 7D rr rr  
00615Cr 1  6A 69 00 4A  
00616Fr 1  A2 2F BD rr     calc_new_values_for_row 12, $0A, $38 ; row start 1 more than calc back (because need downleft) and 1 less prev calc back
006173r 1  rr 7D rr rr  
006177r 1  6A 69 00 4A  
00618Ar 1  A2 30 BD rr     calc_new_values_for_row 13, $09, $38 ; row start 1 more than calc back (because need downleft) and 1 less prev calc back
00618Er 1  rr 7D rr rr  
006192r 1  6A 69 00 4A  
0061A5r 1  A2 30 BD rr     calc_new_values_for_row 14, $09, $38 ; row start 1 more than calc back (because need downleft) and 1 less prev calc back
0061A9r 1  rr 7D rr rr  
0061ADr 1  6A 69 00 4A  
0061C0r 1  A2 30 BD rr     calc_new_values_for_row 15, $08, $37 ; row start 1 more than calc back (because need downleft) and 1 less prev calc back
0061C4r 1  rr 7D rr rr  
0061C8r 1  6A 69 00 4A  
0061DBr 1  A2 30 BD rr     calc_new_values_for_row 16, $08, $37
0061DFr 1  rr 7D rr rr  
0061E3r 1  6A 69 00 4A  
0061F6r 1  A2 30 BD rr     calc_new_values_for_row 17, $07, $36
0061FAr 1  rr 7D rr rr  
0061FEr 1  6A 69 00 4A  
006211r 1  A2 2F BD rr     calc_new_values_for_row 18, $07, $35
006215r 1  rr 7D rr rr  
006219r 1  6A 69 00 4A  
00622Cr 1  A2 30 BD rr     calc_new_values_for_row 19, $06, $35
006230r 1  rr 7D rr rr  
006234r 1  6A 69 00 4A  
006247r 1  A2 2F BD rr     calc_new_values_for_row 20, $06, $34
00624Br 1  rr 7D rr rr  
00624Fr 1  6A 69 00 4A  
006262r 1  A2 30 BD rr     calc_new_values_for_row 21, $05, $34
006266r 1  rr 7D rr rr  
00626Ar 1  6A 69 00 4A  
00627Dr 1  A2 2F BD rr     calc_new_values_for_row 22, $05, $33
006281r 1  rr 7D rr rr  
006285r 1  6A 69 00 4A  
006298r 1  A2 2E BD rr     calc_new_values_for_row 23, $05, $32
00629Cr 1  rr 7D rr rr  
0062A0r 1  6A 69 00 4A  
0062B3r 1  A2 2D BD rr     calc_new_values_for_row 24, $05, $31
0062B7r 1  rr 7D rr rr  
0062BBr 1  6A 69 00 4A  
0062CEr 1  A2 2C BD rr     calc_new_values_for_row 25, $05, $30
0062D2r 1  rr 7D rr rr  
0062D6r 1  6A 69 00 4A  
0062E9r 1  A2 29 BD rr     calc_new_values_for_row 26, $06, $2E
0062EDr 1  rr 7D rr rr  
0062F1r 1  6A 69 00 4A  
006304r 1  A2 26 BD rr     calc_new_values_for_row 27, $07, $2C
006308r 1  rr 7D rr rr  
00630Cr 1  6A 69 00 4A  
00631Fr 1  A2 23 BD rr     calc_new_values_for_row 28, $08, $2A
006323r 1  rr 7D rr rr  
006327r 1  6A 69 00 4A  
00633Ar 1               
00633Ar 1                  ; X should be zeroed here ..
00633Ar 1               ;  the ones we had to do especiale need copied now...
00633Ar 1  BD rr rr 8D     copy_scratch_to_self  1, 21
00633Er 1  rr rr E8     
006341r 1  BD rr rr 8D     copy_scratch_to_self  2, 20
006345r 1  rr rr E8     
006348r 1  BD rr rr 8D     copy_scratch_to_self  3, 19
00634Cr 1  rr rr E8     
00634Fr 1  BD rr rr 8D     copy_scratch_to_self  3, 18
006353r 1  rr rr E8     
006356r 1  BD rr rr 8D     copy_scratch_to_self  4, 17
00635Ar 1  rr rr E8     
00635Dr 1  BD rr rr 8D     copy_scratch_to_self  4, 16
006361r 1  rr rr E8     
006364r 1  BD rr rr 8D     copy_scratch_to_self  5, 15
006368r 1  rr rr E8     
00636Br 1  BD rr rr 8D     copy_scratch_to_self  5, 14
00636Fr 1  rr rr E8     
006372r 1  BD rr rr 8D     copy_scratch_to_self  6, 13
006376r 1  rr rr E8     
006379r 1  BD rr rr 8D     copy_scratch_to_self  7, 12
00637Dr 1  rr rr E8     
006380r 1  BD rr rr 8D     copy_scratch_to_self  8, 11
006384r 1  rr rr E8     
006387r 1  BD rr rr 8D     copy_scratch_to_self  9, 10
00638Br 1  rr rr E8     
00638Er 1  BD rr rr 8D     copy_scratch_to_self 10, 10
006392r 1  rr rr E8     
006395r 1  BD rr rr 8D     copy_scratch_to_self 11,  9
006399r 1  rr rr E8     
00639Cr 1  BD rr rr 8D     copy_scratch_to_self 12,  9
0063A0r 1  rr rr E8     
0063A3r 1  BD rr rr 8D     copy_scratch_to_self 13,  8
0063A7r 1  rr rr E8     
0063AAr 1  BD rr rr 8D     copy_scratch_to_self 14,  8
0063AEr 1  rr rr E8     
0063B1r 1  BD rr rr 8D     copy_scratch_to_self 15,  7
0063B5r 1  rr rr E8     
0063B8r 1  BD rr rr 8D     copy_scratch_to_self 16,  7
0063BCr 1  rr rr E8     
0063BFr 1  BD rr rr 8D     copy_scratch_to_self 17,  6
0063C3r 1  rr rr E8     
0063C6r 1  BD rr rr 8D     copy_scratch_to_self 18,  6
0063CAr 1  rr rr E8     
0063CDr 1  BD rr rr 8D     copy_scratch_to_self 19,  5
0063D1r 1  rr rr E8     
0063D4r 1  BD rr rr 8D     copy_scratch_to_self 20,  5
0063D8r 1  rr rr E8     
0063DBr 1  BD rr rr 8D     copy_scratch_to_self 21,  4
0063DFr 1  rr rr E8     
0063E2r 1  BD rr rr 8D     copy_scratch_to_self 22,  4
0063E6r 1  rr rr E8     
0063E9r 1  BD rr rr 8D     copy_scratch_to_self 23,  4
0063EDr 1  rr rr E8     
0063F0r 1  BD rr rr 8D     copy_scratch_to_self 24,  4
0063F4r 1  rr rr E8     
0063F7r 1  BD rr rr 8D     copy_scratch_to_self 25,  4
0063FBr 1  rr rr E8     
0063FEr 1  BD rr rr 8D     copy_scratch_to_self 26,  4
006402r 1  rr rr E8     
006405r 1  BD rr rr 8D     copy_scratch_to_self 27,  5
006409r 1  rr rr E8     
00640Cr 1  BD rr rr 8D     copy_scratch_to_self 28,  6
006410r 1  rr rr E8     
006413r 1  BD rr rr 8D     copy_scratch_to_self 29,  7
006417r 1  rr rr E8     
00641Ar 1               
00641Ar 1               
00641Ar 1  BD rr rr 8D     copy_scratch_to_self  1, 55
00641Er 1  rr rr E8     
006421r 1  BD rr rr 8D     copy_scratch_to_self  2, 56
006425r 1  rr rr E8     
006428r 1  BD rr rr 8D     copy_scratch_to_self  3, 57
00642Cr 1  rr rr E8     
00642Fr 1  BD rr rr 8D     copy_scratch_to_self  4, 58
006433r 1  rr rr E8     
006436r 1  BD rr rr 8D     copy_scratch_to_self  5, 59
00643Ar 1  rr rr E8     
00643Dr 1  BD rr rr 8D     copy_scratch_to_self    6, 59
006441r 1  rr rr E8     
006444r 1  BD rr rr 8D     copy_scratch_to_self    7, 59
006448r 1  rr rr E8     
00644Br 1  BD rr rr 8D     copy_scratch_to_self    8, 59
00644Fr 1  rr rr E8     
006452r 1  BD rr rr 8D     copy_scratch_to_self  9, 59
006456r 1  rr rr E8     
006459r 1  BD rr rr 8D     copy_scratch_to_self   10, 58
00645Dr 1  rr rr E8     
006460r 1  BD rr rr 8D     copy_scratch_to_self 11, 58
006464r 1  rr rr E8     
006467r 1  BD rr rr 8D     copy_scratch_to_self   12, 57
00646Br 1  rr rr E8     
00646Er 1  BD rr rr 8D     copy_scratch_to_self   13, 57
006472r 1  rr rr E8     
006475r 1  BD rr rr 8D     copy_scratch_to_self   14, 57
006479r 1  rr rr E8     
00647Cr 1  BD rr rr 8D     copy_scratch_to_self 15, 57
006480r 1  rr rr E8     
006483r 1  BD rr rr 8D     copy_scratch_to_self   16, 56
006487r 1  rr rr E8     
00648Ar 1  BD rr rr 8D     copy_scratch_to_self   17, 55
00648Er 1  rr rr E8     
006491r 1  BD rr rr 8D     copy_scratch_to_self   18, 54
006495r 1  rr rr E8     
006498r 1  BD rr rr 8D     copy_scratch_to_self 19, 54
00649Cr 1  rr rr E8     
00649Fr 1  BD rr rr 8D     copy_scratch_to_self   20, 53
0064A3r 1  rr rr E8     
0064A6r 1  BD rr rr 8D     copy_scratch_to_self 21, 53
0064AAr 1  rr rr E8     
0064ADr 1  BD rr rr 8D     copy_scratch_to_self   22, 52
0064B1r 1  rr rr E8     
0064B4r 1  BD rr rr 8D     copy_scratch_to_self   23, 51
0064B8r 1  rr rr E8     
0064BBr 1  BD rr rr 8D     copy_scratch_to_self   24, 50
0064BFr 1  rr rr E8     
0064C2r 1  BD rr rr 8D     copy_scratch_to_self   25, 49
0064C6r 1  rr rr E8     
0064C9r 1  BD rr rr 8D     copy_scratch_to_self 26, 48
0064CDr 1  rr rr E8     
0064D0r 1  BD rr rr 8D     copy_scratch_to_self   26, 47
0064D4r 1  rr rr E8     
0064D7r 1  BD rr rr 8D     copy_scratch_to_self 27, 46
0064DBr 1  rr rr E8     
0064DEr 1  BD rr rr 8D     copy_scratch_to_self   27, 45
0064E2r 1  rr rr E8     
0064E5r 1  BD rr rr 8D     copy_scratch_to_self 28, 44
0064E9r 1  rr rr E8     
0064ECr 1  BD rr rr 8D     copy_scratch_to_self   28, 43
0064F0r 1  rr rr E8     
0064F3r 1               
0064F3r 1  A0 23           LDY #42-7
0064F5r 1  BD rr rr      : LDA SPECIAL_SCRATCH,X
0064F8r 1  99 rr rr        STA TUB_WORLD+(64*29)+7,Y
0064FBr 1  E8              INX
0064FCr 1  88              DEY
0064FDr 1  D0 F6           BNE :-
0064FFr 1               
0064FFr 1               
0064FFr 1  60              RTS ; fin
006500r 1               
006500r 1               test_optimal_pal_data:
006500r 1               ;      GB   R  $1:FA00-$1:FBFF   VERA Color Palette (256 x 2 bytes)
006500r 1  00 00        .byte $00,$00  ; 0 - black/transparent
006502r 1  C8 0F        .byte $c8,$0f  ; 1 #ffcc88
006504r 1  04 06        .byte $04,$06  ; 2 #660044
006506r 1  00 0C        .byte $00,$0C  ; 3  #cc0000
006508r 1  F0 0C        .byte $F0,$0C  ; 4#ccff00
00650Ar 1  42 03        .byte $42,$03
00650Cr 1  60 0C        .byte $60,$0c   ; 6  #cc6600
00650Er 1  40 08        .byte $40,$08   ; 7 #884400
006510r 1  C0 0C        .byte $c0,$0c   ; 8 #cccc00
006512r 1  6A 02        .byte $6a,$02   ; 9 #2266aa mid blue
006514r 1  C0 00        .byte $c0,$00   ; A #00cc00
006516r 1  AC 07        .byte $ac,$07   ; B #77aacc light blue
006518r 1  C0 00        .byte $c0,$00   ; C #0000c0 dark blue
00651Ar 1  0C 0C        .byte $0c,$0c   ; D #cc00cc
00651Cr 1  88 08        .byte $88,$08   ; E #888888
00651Er 1  22 02        .byte $22,$02   ; F #222222
006520r 1               
006520r 1               test_vram_data:
006520r 1               ; 70 to 127 - start of 16x16 (each 128 byte) for testing directions / sizing..
006520r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$11  ;  0-15 16x10 -  0
006524r 1  11 11 11 11  
006528r 1  1F FF FF FF  .byte $1F,$FF,$FF,$FF,$FF,$FF,$FF,$F1
00652Cr 1  FF FF FF F1  
006530r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$F1
006534r 1  FF FF FF F1  
006538r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$F1
00653Cr 1  FF FF FF F1  
006540r 1  1F FF FF F1  .byte $1F,$FF,$ff,$f1,$ff,$fF,$FF,$F1
006544r 1  FF FF FF F1  
006548r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$F1
00654Cr 1  FF FF FF F1  
006550r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$F1
006554r 1  FF FF FF F1  
006558r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$F1
00655Cr 1  FF FF FF F1  
006560r 1  1F FF FF FF  .byte $1F,$FF,$FF,$FF,$FF,$FF,$FF,$F1
006564r 1  FF FF FF F1  
006568r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$11
00656Cr 1  11 11 11 11  
006570r 1  55 55 55 55  .repeat 54
006574r 1  55 55 55 55  
006578r 1  55 55 55 55  
006720r 1               .res 8,$55
006720r 1               .endrepeat
006720r 1               
006720r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$11  ;  16-31    16x10 -  0 trans
006724r 1  11 11 11 11  
006728r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$F1
00672Cr 1  F0 F0 F0 F1  
006730r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$01
006734r 1  0F 0F 0F 01  
006738r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$F1
00673Cr 1  F0 F0 F0 F1  
006740r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$01
006744r 1  0F 0F 0F 01  
006748r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$F1
00674Cr 1  F0 F0 F0 F1  
006750r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$01
006754r 1  0F 0F 0F 01  
006758r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$F1
00675Cr 1  F0 F0 F0 F1  
006760r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$01
006764r 1  0F 0F 0F 01  
006768r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$11
00676Cr 1  11 11 11 11  
006770r 1  50 50 50 50  .repeat 27
006774r 1  50 50 50 50  
006778r 1  05 05 05 05  
006920r 1               .res 8,$50
006920r 1               .res 8,$05
006920r 1               .endrepeat
006920r 1               
006920r 1               
006920r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$11  ;  32-47    16x11 -  4
006924r 1  11 11 11 11  
006928r 1  1F FF FF FF  .byte $1F,$FF,$FF,$FF,$FF,$FF,$FF,$F1
00692Cr 1  FF FF FF F1  
006930r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$F1
006934r 1  FF FF FF F1  
006938r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$F1
00693Cr 1  FF FF FF F1  
006940r 1  1F FF FF F1  .byte $1F,$FF,$ff,$f1,$ff,$fF,$FF,$F1
006944r 1  FF FF FF F1  
006948r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$F1
00694Cr 1  FF FF FF F1  
006950r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$F1
006954r 1  FF FF FF F1  
006958r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$F1
00695Cr 1  FF FF FF F1  
006960r 1  1F FF FF FF  .byte $1F,$FF,$FF,$FF,$FF,$FF,$FF,$F1
006964r 1  FF FF FF F1  
006968r 1  1F FF FF FF  .byte $1F,$FF,$FF,$FF,$FF,$FF,$FF,$F1
00696Cr 1  FF FF FF F1  
006970r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$11
006974r 1  11 11 11 11  
006978r 1  55 55 55 55  .repeat 53
00697Cr 1  55 55 55 55  
006980r 1  55 55 55 55  
006B20r 1               .res 8,$55
006B20r 1               .endrepeat
006B20r 1               
006B20r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$11  ;  48-63    16x11 -  4 trans
006B24r 1  11 11 11 11  
006B28r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$F1
006B2Cr 1  F0 F0 F0 F1  
006B30r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$01
006B34r 1  0F 0F 0F 01  
006B38r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$F1
006B3Cr 1  F0 F0 F0 F1  
006B40r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$01
006B44r 1  0F 0F 0F 01  
006B48r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$F1
006B4Cr 1  F0 F0 F0 F1  
006B50r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$01
006B54r 1  0F 0F 0F 01  
006B58r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$F1
006B5Cr 1  F0 F0 F0 F1  
006B60r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$01
006B64r 1  0F 0F 0F 01  
006B68r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$F1
006B6Cr 1  F0 F0 F0 F1  
006B70r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$11
006B74r 1  11 11 11 11  
006B78r 1  05 05 05 05  .res 7,$05
006B7Cr 1  05 05 05     
006B7Fr 1  00           .byte 0
006B80r 1  50 50 50 50  .repeat 26
006B84r 1  50 50 50 50  
006B88r 1  05 05 05 05  
006D20r 1               .res 8,$50
006D20r 1               .res 7,$05
006D20r 1               .byte 0
006D20r 1               .endrepeat
006D20r 1               
006D20r 1               
006D20r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$10  ;  64-79    15x11 - 10
006D24r 1  11 11 11 10  
006D28r 1  1F FF FF FF  .byte $1F,$FF,$FF,$FF,$FF,$FF,$FF,$10
006D2Cr 1  FF FF FF 10  
006D30r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$10
006D34r 1  FF FF FF 10  
006D38r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$10
006D3Cr 1  FF FF FF 10  
006D40r 1  1F FF FF F1  .byte $1F,$FF,$ff,$f1,$ff,$fF,$FF,$10
006D44r 1  FF FF FF 10  
006D48r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$10
006D4Cr 1  FF FF FF 10  
006D50r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$10
006D54r 1  FF FF FF 10  
006D58r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$10
006D5Cr 1  FF FF FF 10  
006D60r 1  1F FF FF FF  .byte $1F,$FF,$FF,$FF,$FF,$FF,$FF,$10
006D64r 1  FF FF FF 10  
006D68r 1  1F FF FF FF  .byte $1F,$FF,$FF,$FF,$FF,$FF,$FF,$10
006D6Cr 1  FF FF FF 10  
006D70r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$10
006D74r 1  11 11 11 10  
006D78r 1  55 55 55 55  .repeat 53
006D7Cr 1  55 55 55 50  
006D80r 1  55 55 55 55  
006F20r 1               .res 7,$55
006F20r 1               .byte $50
006F20r 1               .endrepeat
006F20r 1               
006F20r 1               
006F20r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$10  ;  80-95    15x11 - 10 trans
006F24r 1  11 11 11 10  
006F28r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$10
006F2Cr 1  F0 F0 F0 10  
006F30r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$10
006F34r 1  0F 0F 0F 10  
006F38r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$10
006F3Cr 1  F0 F0 F0 10  
006F40r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$10
006F44r 1  0F 0F 0F 10  
006F48r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$10
006F4Cr 1  F0 F0 F0 10  
006F50r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$10
006F54r 1  0F 0F 0F 10  
006F58r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$10
006F5Cr 1  F0 F0 F0 10  
006F60r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$10
006F64r 1  0F 0F 0F 10  
006F68r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$10
006F6Cr 1  F0 F0 F0 10  
006F70r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$10
006F74r 1  11 11 11 10  
006F78r 1  05 05 05 05  .res 7,$05
006F7Cr 1  05 05 05     
006F7Fr 1  00           .byte 0
006F80r 1  50 50 50 50  .repeat 26
006F84r 1  50 50 50 50  
006F88r 1  05 05 05 05  
007120r 1               .res 8,$50
007120r 1               .res 7,$05
007120r 1               .byte 0
007120r 1               .endrepeat
007120r 1               
007120r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$10  ;  96-111    15x12 - 18
007124r 1  11 11 11 10  
007128r 1  1F FF FF FF  .byte $1F,$FF,$FF,$FF,$FF,$FF,$FF,$10
00712Cr 1  FF FF FF 10  
007130r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$10
007134r 1  FF FF FF 10  
007138r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$10
00713Cr 1  FF FF FF 10  
007140r 1  1F FF FF F1  .byte $1F,$FF,$ff,$f1,$ff,$fF,$FF,$10
007144r 1  FF FF FF 10  
007148r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$10
00714Cr 1  FF FF FF 10  
007150r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$10
007154r 1  FF FF FF 10  
007158r 1  1F FF FF FF  .byte $1F,$FF,$FF,$Ff,$FF,$FF,$FF,$10
00715Cr 1  FF FF FF 10  
007160r 1  1F FF FF FF  .byte $1F,$FF,$FF,$FF,$FF,$FF,$FF,$10
007164r 1  FF FF FF 10  
007168r 1  1F FF FF FF  .byte $1F,$FF,$FF,$FF,$FF,$FF,$FF,$10
00716Cr 1  FF FF FF 10  
007170r 1  1F FF FF FF  .byte $1F,$FF,$FF,$FF,$FF,$FF,$FF,$10
007174r 1  FF FF FF 10  
007178r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$10
00717Cr 1  11 11 11 10  
007180r 1  55 55 55 55  .repeat 52
007184r 1  55 55 55 50  
007188r 1  55 55 55 55  
007320r 1               .res 7,$55
007320r 1               .byte $50
007320r 1               .endrepeat
007320r 1               
007320r 1               
007320r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$10  ;  112-127    15x12 - 18 trans
007324r 1  11 11 11 10  
007328r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$10
00732Cr 1  F0 F0 F0 10  
007330r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$10
007334r 1  0F 0F 0F 10  
007338r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$10
00733Cr 1  F0 F0 F0 10  
007340r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$10
007344r 1  0F 0F 0F 10  
007348r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$10
00734Cr 1  F0 F0 F0 10  
007350r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$10
007354r 1  0F 0F 0F 10  
007358r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$10
00735Cr 1  F0 F0 F0 10  
007360r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$10
007364r 1  0F 0F 0F 10  
007368r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$10
00736Cr 1  F0 F0 F0 10  
007370r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$10
007374r 1  0F 0F 0F 10  
007378r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$10
00737Cr 1  11 11 11 10  
007380r 1  50 50 50 50  .repeat 26
007384r 1  50 50 50 50  
007388r 1  05 05 05 05  
007520r 1               .res 8,$50
007520r 1               .res 7,$05
007520r 1               .byte 0
007520r 1               .endrepeat
007520r 1               
007520r 1               ; alernate tile graphic to use for tub wall .. 128-143 ; 16x tile
007520r 1  16 16 16 16  .repeat 32
007524r 1  16 16 16 16  
007528r 1  61 61 61 61  
007720r 1                   .byte $16, $16, $16, $16, $16, $16, $16, $16
007720r 1                   .byte $61, $61, $61, $61, $61, $61, $61, $61
007720r 1               .endrepeat
007720r 1               
007720r 1  10 10 10 10  .repeat 32  ;  144-159
007724r 1  10 10 10 10  
007728r 1  06 06 06 06  
007920r 1                   .byte $10, $10, $10, $10, $10, $10, $10, $10
007920r 1                   .byte $06, $06, $06, $06, $06, $06, $06, $06
007920r 1               .endrepeat
007920r 1               
007920r 1               
007920r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$00  ;  160-175    14x12
007924r 1  11 11 11 00  
007928r 1  1F FF FF FF  .byte $1f,$FF,$FF,$FF,$fF,$FF,$F1,$00
00792Cr 1  FF FF F1 00  
007930r 1  1F FF FF FF  .byte $1f,$FF,$FF,$FF,$fF,$FF,$F1,$00
007934r 1  FF FF F1 00  
007938r 1  1F FF FF FF  .byte $1f,$FF,$ff,$Ff,$Ff,$fF,$F1,$00
00793Cr 1  FF FF F1 00  
007940r 1  1F FF FF F1  .byte $1f,$FF,$FF,$f1,$fF,$FF,$F1,$00
007944r 1  FF FF F1 00  
007948r 1  1F FF FF FF  .byte $1f,$FF,$FF,$Ff,$Ff,$fF,$F1,$00
00794Cr 1  FF FF F1 00  
007950r 1  1F FF FF FF  .byte $1f,$FF,$FF,$fF,$FF,$FF,$F1,$00
007954r 1  FF FF F1 00  
007958r 1  1F FF FF FF  .byte $1f,$FF,$FF,$fF,$FF,$FF,$F1,$00
00795Cr 1  FF FF F1 00  
007960r 1  1F FF FF FF  .byte $1f,$FF,$FF,$FF,$FF,$FF,$F1,$00
007964r 1  FF FF F1 00  
007968r 1  1F FF FF FF  .byte $1f,$FF,$FF,$FF,$FF,$FF,$F1,$00
00796Cr 1  FF FF F1 00  
007970r 1  1F FF FF FF  .byte $1f,$FF,$FF,$FF,$FF,$FF,$F1,$00
007974r 1  FF FF F1 00  
007978r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$00
00797Cr 1  11 11 11 00  
007980r 1  55 55 55 55  .repeat 52
007984r 1  55 55 55 00  
007988r 1  55 55 55 55  
007B20r 1               .res 7,$55
007B20r 1               .byte 0
007B20r 1               .endrepeat
007B20r 1               
007B20r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$00  ;  176-191
007B24r 1  11 11 11 00  
007B28r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$10
007B2Cr 1  F0 F0 F0 10  
007B30r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$10
007B34r 1  0F 0F 0F 10  
007B38r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$10
007B3Cr 1  F0 F0 F0 10  
007B40r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$10
007B44r 1  0F 0F 0F 10  
007B48r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$10
007B4Cr 1  F0 F0 F0 10  
007B50r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$10
007B54r 1  0F 0F 0F 10  
007B58r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$10
007B5Cr 1  F0 F0 F0 10  
007B60r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$10
007B64r 1  0F 0F 0F 10  
007B68r 1  10 F0 F0 F0  .byte $10,$F0,$F0,$F0,$F0,$F0,$F0,$10
007B6Cr 1  F0 F0 F0 10  
007B70r 1  1F 0F 0F 0F  .byte $1F,$0F,$0F,$0f,$0F,$0F,$0F,$10
007B74r 1  0F 0F 0F 10  
007B78r 1  11 11 11 11  .byte $11,$11,$11,$11,$11,$11,$11,$10
007B7Cr 1  11 11 11 10  
007B80r 1  50 50 50 50  .repeat 26
007B84r 1  50 50 50 50  
007B88r 1  05 05 05 05  
007D20r 1               .res 8,$50
007D20r 1               .res 7,$05
007D20r 1               .byte 0
007D20r 1               .endrepeat
007D20r 1               
007D20r 1               ; alernate tile graphic to use for tub wall .. 192-223 ; 15x tile
007D20r 1  16 16 16 16  .repeat 32
007D24r 1  16 16 16 10  
007D28r 1  61 61 61 61  
007F20r 1                   .byte $16, $16, $16, $16, $16, $16, $16, $10
007F20r 1                   .byte $61, $61, $61, $61, $61, $61, $61, $60
007F20r 1               .endrepeat
007F20r 1               
007F20r 1  10 10 10 10  .repeat 32  ;  144-159
007F24r 1  10 10 10 10  
007F28r 1  06 06 06 06  
008120r 1                   .byte $10, $10, $10, $10, $10, $10, $10, $10
008120r 1                   .byte $06, $06, $06, $06, $06, $06, $06, $00
008120r 1               .endrepeat
008120r 1               
008120r 1               
008120r 1               ; alernate tile graphic to use for tub wall .. 224 ; 14x tile
008120r 1  16 16 16 16  .repeat 32
008124r 1  16 16 16 00  
008128r 1  61 61 61 61  
008320r 1                   .byte $16, $16, $16, $16, $16, $16, $16, $00
008320r 1                   .byte $61, $61, $61, $61, $61, $61, $61, $00
008320r 1               .endrepeat
008320r 1               
008320r 1  10 10 10 10  .repeat 32  ;  144-159
008324r 1  10 10 10 00  
008328r 1  06 06 06 06  
008520r 1                   .byte $10, $10, $10, $10, $10, $10, $10, $00
008520r 1                   .byte $06, $06, $06, $06, $06, $06, $06, $00
008520r 1               .endrepeat
008520r 1               
008520r 1               
008520r 1               
008520r 1               HEX_DISPLAY_FONT:       ; 8x8x16 color = 32 bytes ... sprite addr 256
008520r 1               ;     01   23   45   67
008520r 1  00 11 11 00  .byte $00, $11, $11, $00   ; 0
008524r 1  01 00 00 10  .byte $01, $00, $00, $10
008528r 1  01 00 00 10  .byte $01, $00, $00, $10
00852Cr 1  00 00 00 00  .byte $00, $00, $00, $00
008530r 1  01 00 00 10  .byte $01, $00, $00, $10
008534r 1  01 00 00 10  .byte $01, $00, $00, $10
008538r 1  01 00 00 10  .byte $01, $00, $00, $10
00853Cr 1  00 11 11 00  .byte $00, $11, $11, $00   ; 0 /
008540r 1               
008540r 1  00 00 00 00  .byte $00, $00, $00, $00 ; 1
008544r 1  00 00 00 10  .byte $00, $00, $00, $10
008548r 1  00 00 00 10  .byte $00, $00, $00, $10
00854Cr 1  00 00 00 00  .byte $00, $00, $00, $00
008550r 1  00 00 00 10  .byte $00, $00, $00, $10
008554r 1  00 00 00 10  .byte $00, $00, $00, $10
008558r 1  00 00 00 10  .byte $00, $00, $00, $10
00855Cr 1  00 00 00 00  .byte $00, $00, $00, $00
008560r 1               
008560r 1  00 11 11 00  .byte $00, $11, $11, $00   ; 2
008564r 1  00 00 00 10  .byte $00, $00, $00, $10
008568r 1  00 00 00 10  .byte $00, $00, $00, $10
00856Cr 1  00 11 11 00  .byte $00, $11, $11, $00
008570r 1  01 00 00 00  .byte $01, $00, $00, $00
008574r 1  01 00 00 00  .byte $01, $00, $00, $00
008578r 1  01 00 00 00  .byte $01, $00, $00, $00
00857Cr 1  00 11 11 00  .byte $00, $11, $11, $00
008580r 1               
008580r 1  00 11 11 00  .byte $00, $11, $11, $00   ; 3
008584r 1  00 00 00 10  .byte $00, $00, $00, $10
008588r 1  00 00 00 10  .byte $00, $00, $00, $10
00858Cr 1  00 11 11 00  .byte $00, $11, $11, $00
008590r 1  00 00 00 10  .byte $00, $00, $00, $10
008594r 1  00 00 00 10  .byte $00, $00, $00, $10
008598r 1  00 00 00 10  .byte $00, $00, $00, $10
00859Cr 1  00 11 11 00  .byte $00, $11, $11, $00
0085A0r 1               
0085A0r 1  00 00 00 00  .byte $00, $00, $00, $00   ; 4
0085A4r 1  01 00 00 10  .byte $01, $00, $00, $10
0085A8r 1  01 00 00 10  .byte $01, $00, $00, $10
0085ACr 1  00 11 11 00  .byte $00, $11, $11, $00
0085B0r 1  00 00 00 10  .byte $00, $00, $00, $10
0085B4r 1  00 00 00 10  .byte $00, $00, $00, $10
0085B8r 1  00 00 00 10  .byte $00, $00, $00, $10
0085BCr 1  00 00 00 00  .byte $00, $00, $00, $00
0085C0r 1               
0085C0r 1  00 11 11 00  .byte $00, $11, $11, $00   ; 5
0085C4r 1  01 00 00 00  .byte $01, $00, $00, $00
0085C8r 1  01 00 00 00  .byte $01, $00, $00, $00
0085CCr 1  00 11 11 00  .byte $00, $11, $11, $00
0085D0r 1  00 00 00 10  .byte $00, $00, $00, $10
0085D4r 1  00 00 00 10  .byte $00, $00, $00, $10
0085D8r 1  00 00 00 10  .byte $00, $00, $00, $10
0085DCr 1  00 11 11 00  .byte $00, $11, $11, $00
0085E0r 1               
0085E0r 1  00 11 11 00  .byte $00, $11, $11, $00   ; 6
0085E4r 1  01 00 00 00  .byte $01, $00, $00, $00
0085E8r 1  01 00 00 00  .byte $01, $00, $00, $00
0085ECr 1  00 11 11 00  .byte $00, $11, $11, $00
0085F0r 1  01 00 00 10  .byte $01, $00, $00, $10
0085F4r 1  01 00 00 10  .byte $01, $00, $00, $10
0085F8r 1  01 00 00 10  .byte $01, $00, $00, $10
0085FCr 1  00 11 11 00  .byte $00, $11, $11, $00
008600r 1               
008600r 1  00 01 01 00  .byte $00, $01, $01, $00 ; 7
008604r 1  00 00 00 10  .byte $00, $00, $00, $10
008608r 1  00 00 00 10  .byte $00, $00, $00, $10
00860Cr 1  00 00 00 00  .byte $00, $00, $00, $00
008610r 1  00 00 00 10  .byte $00, $00, $00, $10
008614r 1  00 00 00 10  .byte $00, $00, $00, $10
008618r 1  00 00 00 10  .byte $00, $00, $00, $10
00861Cr 1  00 00 00 00  .byte $00, $00, $00, $00
008620r 1               
008620r 1  00 11 11 00  .byte $00, $11, $11, $00   ; 8
008624r 1  01 00 00 10  .byte $01, $00, $00, $10
008628r 1  01 00 00 10  .byte $01, $00, $00, $10
00862Cr 1  00 11 11 00  .byte $00, $11, $11, $00
008630r 1  01 00 00 10  .byte $01, $00, $00, $10
008634r 1  01 00 00 10  .byte $01, $00, $00, $10
008638r 1  01 00 00 10  .byte $01, $00, $00, $10
00863Cr 1  00 11 11 00  .byte $00, $11, $11, $00
008640r 1               
008640r 1  00 11 11 00  .byte $00, $11, $11, $00   ; 9
008644r 1  01 00 00 10  .byte $01, $00, $00, $10
008648r 1  01 00 00 10  .byte $01, $00, $00, $10
00864Cr 1  00 11 11 00  .byte $00, $11, $11, $00
008650r 1  00 00 00 10  .byte $00, $00, $00, $10
008654r 1  00 00 00 10  .byte $00, $00, $00, $10
008658r 1  00 00 00 10  .byte $00, $00, $00, $10
00865Cr 1  00 11 11 00  .byte $00, $11, $11, $00
008660r 1               
008660r 1  00 11 11 00  .byte $00, $11, $11, $00   ; A
008664r 1  01 00 00 10  .byte $01, $00, $00, $10
008668r 1  01 00 00 10  .byte $01, $00, $00, $10
00866Cr 1  00 11 11 00  .byte $00, $11, $11, $00
008670r 1  01 00 00 10  .byte $01, $00, $00, $10
008674r 1  01 00 00 10  .byte $01, $00, $00, $10
008678r 1  01 00 00 10  .byte $01, $00, $00, $10
00867Cr 1  00 00 00 00  .byte $00, $00, $00, $00
008680r 1               
008680r 1               
008680r 1  00 00 00 00  .byte $00, $00, $00, $00   ; B
008684r 1  01 00 00 00  .byte $01, $00, $00, $00
008688r 1  01 00 00 00  .byte $01, $00, $00, $00
00868Cr 1  00 11 11 00  .byte $00, $11, $11, $00
008690r 1  01 00 00 10  .byte $01, $00, $00, $10
008694r 1  01 00 00 10  .byte $01, $00, $00, $10
008698r 1  01 00 00 10  .byte $01, $00, $00, $10
00869Cr 1  00 11 11 00  .byte $00, $11, $11, $00
0086A0r 1               
0086A0r 1  00 11 11 00  .byte $00, $11, $11, $00   ; C
0086A4r 1  01 00 00 00  .byte $01, $00, $00, $00
0086A8r 1  01 00 00 00  .byte $01, $00, $00, $00
0086ACr 1  00 00 00 00  .byte $00, $00, $00, $00
0086B0r 1  01 00 00 00  .byte $01, $00, $00, $00
0086B4r 1  01 00 00 00  .byte $01, $00, $00, $00
0086B8r 1  01 00 00 00  .byte $01, $00, $00, $00
0086BCr 1  00 11 11 00  .byte $00, $11, $11, $00
0086C0r 1               
0086C0r 1  00 00 00 00  .byte $00, $00, $00, $00   ; D
0086C4r 1  00 00 00 10  .byte $00, $00, $00, $10
0086C8r 1  00 00 00 10  .byte $00, $00, $00, $10
0086CCr 1  00 11 11 00  .byte $00, $11, $11, $00
0086D0r 1  01 00 00 10  .byte $01, $00, $00, $10
0086D4r 1  01 00 00 10  .byte $01, $00, $00, $10
0086D8r 1  01 00 00 10  .byte $01, $00, $00, $10
0086DCr 1  00 11 11 00  .byte $00, $11, $11, $00
0086E0r 1               
0086E0r 1  00 11 11 00  .byte $00, $11, $11, $00   ; E
0086E4r 1  01 00 00 00  .byte $01, $00, $00, $00
0086E8r 1  01 00 00 00  .byte $01, $00, $00, $00
0086ECr 1  00 11 11 00  .byte $00, $11, $11, $00
0086F0r 1  01 00 00 00  .byte $01, $00, $00, $00
0086F4r 1  01 00 00 00  .byte $01, $00, $00, $00
0086F8r 1  01 00 00 00  .byte $01, $00, $00, $00
0086FCr 1  00 11 11 00  .byte $00, $11, $11, $00
008700r 1               
008700r 1  00 11 11 00  .byte $00, $11, $11, $00   ; F   sprite addr 48
008704r 1  01 00 00 00  .byte $01, $00, $00, $00
008708r 1  01 00 00 00  .byte $01, $00, $00, $00
00870Cr 1  00 11 11 00  .byte $00, $11, $11, $00
008710r 1  01 00 00 00  .byte $01, $00, $00, $00
008714r 1  01 00 00 00  .byte $01, $00, $00, $00
008718r 1  01 00 00 00  .byte $01, $00, $00, $00
00871Cr 1  00 00 00 00  .byte $00, $00, $00, $00
008720r 1               
008720r 1               ; test circle thing ... 70.. 16x16
008720r 1  00 00 00 AA  .byte $00, $00, $00, $AA, $AA, $00, $00, $00
008724r 1  AA 00 00 00  
008728r 1  00 00 AA AA  .byte $00, $00, $AA, $AA, $AA, $AA, $00, $00
00872Cr 1  AA AA 00 00  
008730r 1  00 0A AA AA  .byte $00, $0A, $AA, $AA, $AA, $AA, $A0, $00
008734r 1  AA AA A0 00  
008738r 1  00 AA AA AA  .byte $00, $AA, $AA, $AA, $AA, $AA, $AA, $00
00873Cr 1  AA AA AA 00  
008740r 1  0A AA AA AA  .byte $0A, $AA, $AA, $AA, $AA, $AA, $AA, $A0
008744r 1  AA AA AA A0  
008748r 1  0A AA AA AA  .byte $0A, $AA, $AA, $AA, $AA, $AA, $AA, $A0
00874Cr 1  AA AA AA A0  
008750r 1  AA AA AA AA  .byte $AA, $AA, $AA, $AA, $AA, $AA, $AA, $AA
008754r 1  AA AA AA AA  
008758r 1  AA AA AA AA  .byte $AA, $AA, $AA, $AA, $AA, $AA, $AA, $AA
00875Cr 1  AA AA AA AA  
008760r 1  AA AA AA AA  .byte $AA, $AA, $AA, $AA, $AA, $AA, $AA, $AA
008764r 1  AA AA AA AA  
008768r 1  AA AA AA AA  .byte $AA, $AA, $AA, $AA, $AA, $AA, $AA, $AA
00876Cr 1  AA AA AA AA  
008770r 1  0A AA AA AA  .byte $0A, $AA, $AA, $AA, $AA, $AA, $AA, $A0
008774r 1  AA AA AA A0  
008778r 1  0A AA AA AA  .byte $0A, $AA, $AA, $AA, $AA, $AA, $AA, $A0
00877Cr 1  AA AA AA A0  
008780r 1  00 AA AA AA  .byte $00, $AA, $AA, $AA, $AA, $AA, $AA, $00
008784r 1  AA AA AA 00  
008788r 1  00 0A AA AA  .byte $00, $0A, $AA, $AA, $AA, $AA, $A0, $00
00878Cr 1  AA AA A0 00  
008790r 1  00 00 AA AA  .byte $00, $00, $AA, $AA, $AA, $AA, $00, $00
008794r 1  AA AA 00 00  
008798r 1  00 00 00 AA  .byte $00, $00, $00, $AA, $AA, $00, $00, $00
00879Cr 1  AA 00 00 00  
0087A0r 1               
0087A0r 1  00 00 00 00  .res 384,0
0087A4r 1  00 00 00 00  
0087A8r 1  00 00 00 00  
0087A0r 1               
